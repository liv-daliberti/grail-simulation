<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="GPT-4o Tools API" href="gpt4o.html"><link rel="prev" title="Prompt Builder API" href="prompt_builder.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>KNN Baseline API - GRAIL Simulation documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #1f4b8e;
  --color-brand-content: #1f4b8e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">GRAIL Simulation  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">GRAIL Simulation  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Utilities API</a></li>
<li class="toctree-l1"><a class="reference internal" href="clean_data.html">Clean Data Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="prompt_builder.html">Prompt Builder API</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">KNN Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpt4o.html">GPT-4o Tools API</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_r1.html">Open-R1 Training API</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlhf.html">Shared RLHF Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="grail.html">GRAIL Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="xgb.html">XGBoost Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reports/index.html">Reports</a><input aria-label="Toggle navigation of Reports" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_stats.html">Prompt feature report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/grpo.html">GRPO Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/grail.html">GRAIL Reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_builder.html">Prompt Builder Sample Prompts</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/knn.html">KNN Report Catalog</a><input aria-label="Toggle navigation of KNN Report Catalog" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_next_video.html">KNN Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion.html">KNN Opinion Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion.html#knn-opinion-shift-study">KNN Opinion Shift Study</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_hyperparameter_tuning.html">KNN Hyperparameter Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_hyperparameter_tuning.html#hyper-parameter-sweep-results">Hyper-Parameter Sweep Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reports/research_article_political_sciences.html">RESEARCH ARTICLE POLITICAL SCIENCES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/visualized_recommendation_trees.html">Visualized Recommendation Trees</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/knn.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="knn-baseline-api">
<h1>KNN Baseline API<a class="headerlink" href="#knn-baseline-api" title="Link to this heading">¶</a></h1>
<section id="feature-spaces">
<h2>Feature Spaces<a class="headerlink" href="#feature-spaces" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">knn</span></code> command-line entry point exposes a <code class="docutils literal notranslate"><span class="pre">--feature-space</span></code> switch to
toggle between sparse TF-IDF queries (default), dense Word2Vec embeddings, and
Sentence-Transformer embeddings. Word2Vec support depends on <code class="docutils literal notranslate"><span class="pre">gensim</span></code> being
available; Sentence-Transformer support depends on the
<code class="docutils literal notranslate"><span class="pre">sentence-transformers</span></code> package (and a compatible PyTorch backend). Install
the extras with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">gensim</span> <span class="pre">sentence-transformers</span></code> or include the
project’s <code class="docutils literal notranslate"><span class="pre">dev</span></code> extra.</p>
<p>Example invocations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>tfidf<span class="w"> </span>--out-dir<span class="w"> </span>models/knn/run-tfidf

python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>word2vec<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--word2vec-size<span class="w"> </span><span class="m">256</span><span class="w"> </span>--out-dir<span class="w"> </span>models/knn/run-w2v

python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>sentence_transformer<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--sentence-transformer-model<span class="w"> </span>sentence-transformers/all-MiniLM-L6-v2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--out-dir<span class="w"> </span>models/knn/run-st
</pre></div>
</div>
<p>Diagnostics (elbow plots, accuracy-by-k curves, and per-k predictions) are
saved under the configured <cite>–out-dir</cite>; use <cite>–train-curve-max</cite> to control how
many training examples contribute to the curve metrics.</p>
</section>
<section id="elbow-curve-metrics">
<h2>Elbow &amp; Curve Metrics<a class="headerlink" href="#elbow-curve-metrics" title="Link to this heading">¶</a></h2>
<p>Each evaluation issue produces:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reports/knn/next_video/&lt;feature-space&gt;/elbow_&lt;issue&gt;.png</span></code> – accuracy vs. <code class="docutils literal notranslate"><span class="pre">k</span></code> with the
elbow-selected point highlighted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models/knn/next_video/&lt;feature-space&gt;/&lt;study&gt;/&lt;issue&gt;/knn_curves_&lt;issue&gt;.json</span></code> – serialised
curves for the evaluation split (and optionally the training split) containing accuracy-by-<code class="docutils literal notranslate"><span class="pre">k</span></code>,
eligible/correct counts, AUC (both absolute and normalised), and the selected <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models/knn/next_video/&lt;feature-space&gt;/&lt;study&gt;/&lt;issue&gt;/</span></code> – per-<code class="docutils literal notranslate"><span class="pre">k</span></code> predictions and aggregate
metrics for downstream analysis.</p></li>
</ul>
<p>Set <code class="docutils literal notranslate"><span class="pre">--train-curve-max</span></code> when invoking the CLI to limit how many training
examples feed into the training curve diagnostics.</p>
</section>
<section id="module-knn">
<span id="package-overview"></span><h2>Package Overview<a class="headerlink" href="#module-knn" title="Link to this heading">¶</a></h2>
<p>Grail Simulation KNN baseline package.</p>
<p>Exposes CLI utilities, pipeline coordination, and reporting helpers for
the slate-ranking and opinion-regression experiments.</p>
<p id="module-knn.core">Core feature extraction, indexing, and evaluation utilities for the KNN baseline.</p>
<p id="module-knn.data">Dataset loading and filtering utilities for the KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_dataset_for_issue">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_dataset_for_issue" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset down to a specific issue label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">issue</span></code> column.</p></li>
<li><p><strong>issue</strong> (<em>str</em>) – Issue label to retain (<code class="docutils literal notranslate"><span class="pre">all</span></code> preserves every row).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary restricted to rows matching <code class="docutils literal notranslate"><span class="pre">issue</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_dataset_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_dataset_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter the dataset to rows whose <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> matches <code class="docutils literal notranslate"><span class="pre">studies</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> column.</p></li>
<li><p><strong>studies</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary filtered to the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_split_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_split_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_split_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_split_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset split to the requested <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_ds</strong> (<em>datasets.Dataset</em>) – Dataset split supporting <code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code>.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered dataset split covering only the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.issues_in_dataset">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">issues_in_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#issues_in_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.issues_in_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Return the list of issue labels present in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing at least one split.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of issue identifiers or <code class="docutils literal notranslate"><span class="pre">['all']</span></code> when absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.load_dataset_source">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">load_dataset_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#load_dataset_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.load_dataset_source" title="Link to this definition">¶</a></dt>
<dd><p>Load a cleaned dataset from disk or from the Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>str</em>) – Local directory path or Hugging Face dataset identifier.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – Cache directory passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">datasets.load_dataset()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary containing train and validation splits.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">datasets</span></code> is unavailable.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">source</span></code> does not yield a <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.DatasetDict</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-knn.features">Prompt feature construction utilities shared by the KNN baselines.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecFeatureBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create Word2Vec embeddings from viewer prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a>) – Configuration bundle controlling Word2Vec training/inference.</p></li>
<li><p><strong>_model</strong> (<em>gensim.models.Word2Vec</em><em> | </em><em>None</em>) – Loaded gensim <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2Vec</span></code> instance.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em>]</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the builder with optional configuration overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional configuration bundle to override defaults.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.encode" title="Link to this definition">¶</a></dt>
<dd><p>Return the averaged embedding vector for <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Document to encode using the fitted embeddings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Averaged embedding vector representing <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a previously trained Word2Vec model from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Directory containing the saved Word2Vec model.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.save" title="Link to this definition">¶</a></dt>
<dd><p>Persist the trained model to <code class="docutils literal notranslate"><span class="pre">directory</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Destination directory receiving the model artefact.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.train" title="Link to this definition">¶</a></dt>
<dd><p>Train a Word2Vec model using the provided corpus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Iterable of documents used to fit the embeddings.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.transform" title="Link to this definition">¶</a></dt>
<dd><p>Return stacked embeddings for <code class="docutils literal notranslate"><span class="pre">corpus</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Sequence of documents to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of shape <code class="docutils literal notranslate"><span class="pre">(len(corpus),</span> <span class="pre">vector_size)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.assemble_document">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">assemble_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#assemble_document"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.assemble_document" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate prompt components and selection tokens for feature extraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing base fields and slate metadata.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields injected into the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Document string suitable for downstream vectorisation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.candidate_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">candidate_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">option_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#candidate_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.candidate_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Delegate to <a class="reference internal" href="#knn.features.candidate_feature_tokens" title="knn.features.candidate_feature_tokens"><code class="xref py py-func docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a> for convenience.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate</strong> (<a class="reference internal" href="#knn.core.features.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a>) – Slate candidate to transform into feature tokens.</p></li>
<li><p><strong>option_count</strong> (<em>int</em><em> | </em><em>None</em>) – Optional total number of options available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens describing the candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.collect_candidate_metadata">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">collect_candidate_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#collect_candidate_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.collect_candidate_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Return slate candidate metadata enriched with slot indices and channel info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example providing slate items and metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of <code class="xref py py-class docutils literal notranslate"><span class="pre">CandidateMetadata</span></code> entries for the slate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<a class="reference internal" href="#knn.core.features.CandidateMetadata" title="common.prompts.selection.CandidateMetadata">common.prompts.selection.CandidateMetadata</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.extract_now_watching">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">extract_now_watching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_now_watching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.extract_now_watching" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the currently watched item for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of title and video ID, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str, str] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.extract_slate_items">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">extract_slate_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_slate_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.extract_slate_items" title="Link to this definition">¶</a></dt>
<dd><p>Extract the slate of candidate items from <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate candidates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of <code class="docutils literal notranslate"><span class="pre">(title,</span> <span class="pre">video_id)</span></code> pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[str, str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prepare_prompt_documents">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prepare_prompt_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_prompt_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prepare_prompt_documents" title="Link to this definition">¶</a></dt>
<dd><p>Convenience wrapper mirroring <a class="reference internal" href="#knn.features.prepare_training_documents" title="knn.features.prepare_training_documents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prepare_training_documents">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prepare_training_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_training_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prepare_training_documents" title="Link to this definition">¶</a></dt>
<dd><p>Prepare prompt documents, labels, and metadata for TF-IDF style training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If no eligible documents are generated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prompt_from_builder">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prompt_from_builder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prompt_from_builder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prompt_from_builder" title="Link to this definition">¶</a></dt>
<dd><p>Assemble the full prompt text for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example to convert into prompt text.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full prompt string including contextual tokens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.selection_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">selection_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#selection_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.selection_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Construct additive tokens that highlight the selected candidate within a prompt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing the gold candidate.</p></li>
<li><p><strong>candidates</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.core.features.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a><em>] </em><em>| </em><em>None</em>) – Precomputed candidate metadata, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to derive it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens emphasising the gold candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.title_for">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">title_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#title_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.title_for" title="Link to this definition">¶</a></dt>
<dd><p>Look up a human-readable title for <code class="docutils literal notranslate"><span class="pre">video_id</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>video_id</strong> (<em>str</em>) – Candidate video identifier.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-friendly title or <code class="docutils literal notranslate"><span class="pre">None</span></code> when unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.viewer_profile_sentence">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">viewer_profile_sentence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#viewer_profile_sentence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.viewer_profile_sentence" title="Link to this definition">¶</a></dt>
<dd><p>Compose the viewer profile sentence associated with <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing viewer metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Viewer profile sentence assembled by the builder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.index">Index construction and scoring logic for the KNN slate baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a sentence-transformer index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>) – Optional <a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SentenceTransformerConfig</span></code></a> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the encoder, dense matrix, and label metadata.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If <code class="docutils literal notranslate"><span class="pre">sentence_transformers</span></code> is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a TF-IDF index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split (Hugging Face dataset or list-like).</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>max_features</strong> (<em>int</em><em> | </em><em>None</em>) – Optional vocabulary cap for the vectoriser.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the fitted vectoriser, sparse matrix, and
label metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a Word2Vec index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2VecConfig</span></code> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the trained Word2Vec model and embeddings.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If gensim is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.knn_predict_among_slate_multi">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">knn_predict_among_slate_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#knn_predict_among_slate_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.knn_predict_among_slate_multi" title="Link to this definition">¶</a></dt>
<dd><p>Score each slate option using candidate-aware TF-IDF kNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knn_index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary describing the fitted index artifacts.</p></li>
<li><p><strong>example</strong> (<em>dict</em>) – Dataset row containing the slate to score.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sequence of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate.</p></li>
<li><p><strong>config</strong> (<em>knn.core.index.SlateQueryConfig</em><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">SlateQueryConfig</span></code> overriding defaults.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping from <code class="docutils literal notranslate"><span class="pre">k</span></code> to the predicted 1-based option index. <code class="docutils literal notranslate"><span class="pre">None</span></code>
indicates that a prediction could not be produced for that <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[int, int | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a sentence-transformer index saved via <a class="reference internal" href="#knn.index.save_sentence_transformer_index" title="knn.index.save_sentence_transformer_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing previously persisted artefacts to load from disk.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the loaded sentence-transformer index and associated metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a TF-IDF index previously saved via <a class="reference internal" href="#knn.index.save_tfidf_index" title="knn.index.save_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted TF-IDF artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the loaded vectoriser, matrix, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a Word2Vec index previously saved via <a class="reference internal" href="#knn.index.save_word2vec_index" title="knn.index.save_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted Word2Vec artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the restored Word2Vec model, embeddings, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the sentence-transformer index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – KNN index object or registry being manipulated.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Output directory receiving generated metrics and reports.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the TF-IDF index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.index.build_tfidf_index" title="knn.index.build_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where artifacts will be written.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the Word2Vec index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.index.build_word2vec_index" title="knn.index.build_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where embeddings and metadata are stored.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.evaluate">Top-level exports for the KNN evaluation helpers.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.bin_nopts">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">bin_nopts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bin_nopts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.bin_nopts" title="Link to this definition">¶</a></dt>
<dd><p>Bucket the number of slate options into reporting-friendly categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option_count</strong> (<em>int</em>) – Number of options contained in a recommendation slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="docutils literal notranslate"><span class="pre">{&quot;1&quot;,</span> <span class="pre">&quot;2&quot;,</span> <span class="pre">&quot;3&quot;,</span> <span class="pre">&quot;4&quot;,</span> <span class="pre">&quot;5+&quot;}</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.bucket_from_pos">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">bucket_from_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bucket_from_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.bucket_from_pos" title="Link to this definition">¶</a></dt>
<dd><p>Bucket a 0-based position index into the standard reporting bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pos_idx</strong> (<em>int</em>) – Zero-based position of the correct item within the retrieved slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="xref py py-data docutils literal notranslate"><span class="pre">BUCKET_LABELS</span></code> describing the position bucket.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.canon">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">canon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#canon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.canon" title="Link to this definition">¶</a></dt>
<dd><p>Canonicalise a text fragment by lowercasing and removing punctuation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Raw text fragment to normalise.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Canonical representation suitable for equality comparisons.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.compute_auc_from_curve">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">compute_auc_from_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#compute_auc_from_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.compute_auc_from_curve" title="Link to this definition">¶</a></dt>
<dd><p>Compute the area under the accuracy curve across <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy observed for each <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (area, normalised_area).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.evaluate_issue">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">evaluate_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#evaluate_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.evaluate_issue" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate a single issue slice and persist metrics, curves, and predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>knn.core.evaluate.pipeline.IssueEvaluationRequest</em>) – Evaluation bundle describing the issue to score.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Results are persisted via <code class="xref py py-func docutils literal notranslate"><span class="pre">write_issue_outputs()</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.parse_k_values">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">parse_k_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#parse_k_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.parse_k_values" title="Link to this definition">¶</a></dt>
<dd><p>Derive the sorted set of <code class="docutils literal notranslate"><span class="pre">k</span></code> values requested for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_default</strong> (<em>int</em>) – Baseline <code class="docutils literal notranslate"><span class="pre">k</span></code> value used when the sweep is empty.</p></li>
<li><p><strong>sweep</strong> (<em>str</em>) – Comma-delimited string of additional <code class="docutils literal notranslate"><span class="pre">k</span></code> candidates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Strictly positive <code class="docutils literal notranslate"><span class="pre">k</span></code> values in ascending order. Falls back to
<code class="docutils literal notranslate"><span class="pre">k_default</span></code> (or <code class="docutils literal notranslate"><span class="pre">25</span></code> when unset) if no valid integers are supplied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.plot_elbow">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">plot_elbow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'validation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#plot_elbow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.plot_elbow" title="Link to this definition">¶</a></dt>
<dd><p>Plot the accuracy curve (acc&#64;k) for the evaluation stage and mark <code class="docutils literal notranslate"><span class="pre">best_k</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values that were evaluated.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Mapping</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy keyed by <code class="docutils literal notranslate"><span class="pre">k</span></code> for the evaluation split.</p></li>
<li><p><strong>best_k</strong> (<em>int</em>) – Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> to highlight in the plot.</p></li>
<li><p><strong>output_path</strong> (<em>pathlib.Path</em>) – Destination path for the generated PNG artefact.</p></li>
<li><p><strong>data_split</strong> (<em>str</em>) – Split label used for the legend title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.resolve_reports_dir">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">resolve_reports_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/outputs.html#resolve_reports_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.resolve_reports_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the canonical reports directory corresponding to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out_dir</strong> (<em>pathlib.Path</em>) – Directory containing pipeline artefacts (typically under <code class="docutils literal notranslate"><span class="pre">models/knn</span></code>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path pointing at the repository-level <code class="docutils literal notranslate"><span class="pre">reports</span></code> directory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.run_eval">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.run_eval" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the KNN baseline across the issues specified on the CLI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – Namespace returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">knn.cli.build_parser()</span></code>, including dataset,
feature-space, and sweep configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Evaluation artefacts are persisted via downstream helpers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.select_best_k">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">select_best_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'elbow'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#select_best_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.select_best_k" title="Link to this definition">¶</a></dt>
<dd><p>Select <code class="docutils literal notranslate"><span class="pre">k</span></code> using either max-accuracy or an elbow heuristic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sorted sequence of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Observed eligible-only accuracy for each <code class="docutils literal notranslate"><span class="pre">k</span></code> on the
validation split.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Selection strategy (default: <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code>). <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> picks
the accuracy-maximising <code class="docutils literal notranslate"><span class="pre">k</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code> picks the first <code class="docutils literal notranslate"><span class="pre">k</span></code> where
marginal gains fall below half the initial slope, falling back to
max-accuracy when the heuristic is not applicable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> per the requested method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Opinion-regression utilities supporting the KNN baselines.</p>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionEmbeddingConfigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word2vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEmbeddingConfigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optional embedding builders available during evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word2vec</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>sentence_transformer</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sentence_transformer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><span class="pre">common.text.embeddings.SentenceTransformerConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">word2vec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><span class="pre">knn.core.features.Word2VecConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionEvaluationContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs_root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEvaluationContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared configuration for evaluating a single opinion study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>)</p></li>
<li><p><strong>dataset</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Sequence</em><em>[</em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>embedding_configs</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><em>knn.core.opinion_models.OpinionEmbeddingConfigs</em></a>)</p></li>
<li><p><strong>outputs_root</strong> (<em>pathlib.Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">embedding_configs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><span class="pre">knn.core.opinion_models.OpinionEmbeddingConfigs</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">extra_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">k_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">outputs_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionExample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">participant_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionExample"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.models.OpinionExample</span></code></p>
<p>Collapsed participant-level prompt and opinion values with session context.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_index</strong> (<em>int</em>) – Interaction step index retained from the raw dataset.</p></li>
<li><p><strong>session_id</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Session identifier associated with the participant example.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>participant_id</strong> (<em>str</em>)</p></li>
<li><p><strong>participant_study</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>document</strong> (<em>str</em>)</p></li>
<li><p><strong>before</strong> (<em>float</em>)</p></li>
<li><p><strong>after</strong> (<em>float</em>)</p></li>
<li><p><strong>step_index</strong> (<em>int</em>)</p></li>
<li><p><strong>session_id</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">session_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">step_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_after</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionIndex"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Vectorised training corpus, cached targets, and fitted neighbour index.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (tfidf, word2vec, sentence_transformer).</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Distance metric used by the KNN index.</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>) – Document-term matrix or embedding matrix backing the index.</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>) – Trained vectoriser or embedding builder.</p></li>
<li><p><strong>embeds</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – Optional Word2Vec feature builder used for inference.</p></li>
<li><p><strong>targets_after</strong> (<em>numpy.ndarray</em>) – Post-study opinion targets aligned with the corpus.</p></li>
<li><p><strong>targets_before</strong> (<em>numpy.ndarray</em>) – Pre-study opinion targets aligned with the corpus.</p></li>
<li><p><strong>participant_keys</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Participant/study identifiers aligned with targets.</p></li>
<li><p><strong>neighbors</strong> (<em>NearestNeighbors</em>) – Fitted <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.neighbors.NearestNeighbors</span></code> index.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>metric</strong> (<em>str</em>)</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>)</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>)</p></li>
<li><p><strong>embeds</strong> (<em>Any</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>targets_after</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><strong>targets_before</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><strong>participant_keys</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>neighbors</strong> (<em>sklearn.neighbors.NearestNeighbors</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">embeds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">neighbors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">sklearn.neighbors.NearestNeighbors</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">participant_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">targets_after</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">targets_before</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">vectorizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/opinion/models.html#OpinionSpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration describing one opinion-study index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>label</strong> (<em>str</em>)</p></li>
<li><p><strong>before_column</strong> (<em>str</em>)</p></li>
<li><p><strong>after_column</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">after_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">before_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">build_example_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/opinion/models.html#OpinionSpec.build_example_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the standard keyword arguments for an <code class="docutils literal notranslate"><span class="pre">OpinionExample</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>participant_id</strong> (<em>str</em>) – Participant identifier associated with the example.</p></li>
<li><p><strong>document</strong> (<em>str</em>) – Prompt document presented to the participant.</p></li>
<li><p><strong>before</strong> (<em>float</em>) – Pre-study opinion value.</p></li>
<li><p><strong>after</strong> (<em>float</em>) – Post-study opinion value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of keyword arguments suitable for <code class="xref py py-func docutils literal notranslate"><span class="pre">opinion_example_kwargs()</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, object]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">run_opinion_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion.html#run_opinion_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Execute the post-study opinion index evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Any</em>) – Namespace object containing parsed command-line arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.cli">CLI subpackage exposing the public KNN entrypoints.</p>
</section>
<section id="module-knn.core.data">
<span id="core-canonical-paths"></span><h2>Core (Canonical Paths)<a class="headerlink" href="#module-knn.core.data" title="Link to this heading">¶</a></h2>
<p>Dataset loading and filtering utilities for the KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.filter_dataset_for_issue">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.filter_dataset_for_issue" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset down to a specific issue label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">issue</span></code> column.</p></li>
<li><p><strong>issue</strong> (<em>str</em>) – Issue label to retain (<code class="docutils literal notranslate"><span class="pre">all</span></code> preserves every row).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary restricted to rows matching <code class="docutils literal notranslate"><span class="pre">issue</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.filter_dataset_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.filter_dataset_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter the dataset to rows whose <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> matches <code class="docutils literal notranslate"><span class="pre">studies</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> column.</p></li>
<li><p><strong>studies</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary filtered to the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.filter_split_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">filter_split_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_split_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.filter_split_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset split to the requested <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_ds</strong> (<em>datasets.Dataset</em>) – Dataset split supporting <code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code>.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered dataset split covering only the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.issues_in_dataset">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">issues_in_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#issues_in_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.issues_in_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Return the list of issue labels present in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing at least one split.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of issue identifiers or <code class="docutils literal notranslate"><span class="pre">['all']</span></code> when absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.load_dataset_source">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">load_dataset_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#load_dataset_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.load_dataset_source" title="Link to this definition">¶</a></dt>
<dd><p>Load a cleaned dataset from disk or from the Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>str</em>) – Local directory path or Hugging Face dataset identifier.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – Cache directory passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">datasets.load_dataset()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary containing train and validation splits.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">datasets</span></code> is unavailable.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">source</span></code> does not yield a <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.DatasetDict</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.features">Prompt feature construction utilities shared by the KNN baselines.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">CandidateMetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#CandidateMetadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.CandidateMetadata" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Lightweight view of slate candidate attributes used for token augmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slot</strong> (<em>int</em>)</p></li>
<li><p><strong>title</strong> (<em>str</em>)</p></li>
<li><p><strong>video_id</strong> (<em>str</em>)</p></li>
<li><p><strong>channel_title</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>channel_id</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.channel_id">
<span class="sig-name descname"><span class="pre">channel_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.channel_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.channel_title">
<span class="sig-name descname"><span class="pre">channel_title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.channel_title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.slot">
<span class="sig-name descname"><span class="pre">slot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.slot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.video_id">
<span class="sig-name descname"><span class="pre">video_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.video_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('models/knn/next_video/word2vec_models')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration options for Word2Vec embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vector_size</strong> (<em>int</em>) – Dimensionality of the learned embedding vectors.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Context window size used during training.</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – Minimum token frequency retained in the vocabulary.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of Word2Vec training epochs.</p></li>
<li><p><strong>model_dir</strong> (<em>Path</em>) – Directory where trained embeddings are persisted.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed for Word2Vec initialisation.</p></li>
<li><p><strong>workers</strong> (<em>int</em>) – Number of worker threads allocated to training.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>vector_size</strong> (<em>int</em>)</p></li>
<li><p><strong>window</strong> (<em>int</em>)</p></li>
<li><p><strong>min_count</strong> (<em>int</em>)</p></li>
<li><p><strong>epochs</strong> (<em>int</em>)</p></li>
<li><p><strong>model_dir</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>seed</strong> (<em>int</em>)</p></li>
<li><p><strong>workers</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.epochs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.min_count">
<span class="sig-name descname"><span class="pre">min_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.min_count" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.model_dir">
<span class="sig-name descname"><span class="pre">model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PosixPath('models/knn/next_video/word2vec_models')</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.model_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">42</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.vector_size">
<span class="sig-name descname"><span class="pre">vector_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.vector_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.window">
<span class="sig-name descname"><span class="pre">window</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.window" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.workers">
<span class="sig-name descname"><span class="pre">workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecFeatureBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create Word2Vec embeddings from viewer prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a>) – Configuration bundle controlling Word2Vec training/inference.</p></li>
<li><p><strong>_model</strong> (<em>gensim.models.Word2Vec</em><em> | </em><em>None</em>) – Loaded gensim <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2Vec</span></code> instance.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em>]</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the builder with optional configuration overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional configuration bundle to override defaults.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.encode" title="Link to this definition">¶</a></dt>
<dd><p>Return the averaged embedding vector for <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Document to encode using the fitted embeddings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Averaged embedding vector representing <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a previously trained Word2Vec model from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Directory containing the saved Word2Vec model.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.save" title="Link to this definition">¶</a></dt>
<dd><p>Persist the trained model to <code class="docutils literal notranslate"><span class="pre">directory</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Destination directory receiving the model artefact.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.train" title="Link to this definition">¶</a></dt>
<dd><p>Train a Word2Vec model using the provided corpus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Iterable of documents used to fit the embeddings.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.transform" title="Link to this definition">¶</a></dt>
<dd><p>Return stacked embeddings for <code class="docutils literal notranslate"><span class="pre">corpus</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Sequence of documents to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of shape <code class="docutils literal notranslate"><span class="pre">(len(corpus),</span> <span class="pre">vector_size)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.assemble_document">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">assemble_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#assemble_document"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.assemble_document" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate prompt components and selection tokens for feature extraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing base fields and slate metadata.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields injected into the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Document string suitable for downstream vectorisation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.candidate_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">candidate_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">option_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#candidate_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.candidate_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Delegate to <a class="reference internal" href="#knn.core.features.candidate_feature_tokens" title="knn.core.features.candidate_feature_tokens"><code class="xref py py-func docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a> for convenience.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate</strong> (<a class="reference internal" href="#knn.core.features.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a>) – Slate candidate to transform into feature tokens.</p></li>
<li><p><strong>option_count</strong> (<em>int</em><em> | </em><em>None</em>) – Optional total number of options available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens describing the candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.collect_candidate_metadata">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">collect_candidate_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#collect_candidate_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.collect_candidate_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Return slate candidate metadata enriched with slot indices and channel info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example providing slate items and metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of <a class="reference internal" href="#knn.core.features.CandidateMetadata" title="knn.core.features.CandidateMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">CandidateMetadata</span></code></a> entries for the slate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<a class="reference internal" href="#knn.core.features.CandidateMetadata" title="common.prompts.selection.CandidateMetadata">common.prompts.selection.CandidateMetadata</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.extract_now_watching">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">extract_now_watching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_now_watching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.extract_now_watching" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the currently watched item for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of title and video ID, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str, str] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.extract_slate_items">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">extract_slate_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_slate_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.extract_slate_items" title="Link to this definition">¶</a></dt>
<dd><p>Extract the slate of candidate items from <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate candidates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of <code class="docutils literal notranslate"><span class="pre">(title,</span> <span class="pre">video_id)</span></code> pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[str, str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.prepare_prompt_documents">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">prepare_prompt_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_prompt_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.prepare_prompt_documents" title="Link to this definition">¶</a></dt>
<dd><p>Convenience wrapper mirroring <a class="reference internal" href="#knn.core.features.prepare_training_documents" title="knn.core.features.prepare_training_documents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.prepare_training_documents">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">prepare_training_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_training_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.prepare_training_documents" title="Link to this definition">¶</a></dt>
<dd><p>Prepare prompt documents, labels, and metadata for TF-IDF style training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If no eligible documents are generated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.prompt_from_builder">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">prompt_from_builder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prompt_from_builder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.prompt_from_builder" title="Link to this definition">¶</a></dt>
<dd><p>Assemble the full prompt text for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example to convert into prompt text.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full prompt string including contextual tokens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.selection_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">selection_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#selection_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.selection_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Construct additive tokens that highlight the selected candidate within a prompt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing the gold candidate.</p></li>
<li><p><strong>candidates</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.core.features.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a><em>] </em><em>| </em><em>None</em>) – Precomputed candidate metadata, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to derive it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens emphasising the gold candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.title_for">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">title_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#title_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.title_for" title="Link to this definition">¶</a></dt>
<dd><p>Look up a human-readable title for <code class="docutils literal notranslate"><span class="pre">video_id</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>video_id</strong> (<em>str</em>) – Candidate video identifier.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-friendly title or <code class="docutils literal notranslate"><span class="pre">None</span></code> when unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.viewer_profile_sentence">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">viewer_profile_sentence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#viewer_profile_sentence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.viewer_profile_sentence" title="Link to this definition">¶</a></dt>
<dd><p>Compose the viewer profile sentence associated with <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing viewer metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Viewer profile sentence assembled by the builder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.index">Index construction and scoring logic for the KNN slate baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.build_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">build_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.build_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a sentence-transformer index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>) – Optional <a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SentenceTransformerConfig</span></code></a> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the encoder, dense matrix, and label metadata.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If <code class="docutils literal notranslate"><span class="pre">sentence_transformers</span></code> is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.build_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">build_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.build_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a TF-IDF index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split (Hugging Face dataset or list-like).</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>max_features</strong> (<em>int</em><em> | </em><em>None</em>) – Optional vocabulary cap for the vectoriser.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the fitted vectoriser, sparse matrix, and
label metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.build_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">build_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.build_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a Word2Vec index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2VecConfig</span></code> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the trained Word2Vec model and embeddings.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If gensim is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.knn_predict_among_slate_multi">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">knn_predict_among_slate_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#knn_predict_among_slate_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.knn_predict_among_slate_multi" title="Link to this definition">¶</a></dt>
<dd><p>Score each slate option using candidate-aware TF-IDF kNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knn_index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary describing the fitted index artifacts.</p></li>
<li><p><strong>example</strong> (<em>dict</em>) – Dataset row containing the slate to score.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sequence of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate.</p></li>
<li><p><strong>config</strong> (<em>knn.core.index.SlateQueryConfig</em><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">SlateQueryConfig</span></code> overriding defaults.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping from <code class="docutils literal notranslate"><span class="pre">k</span></code> to the predicted 1-based option index. <code class="docutils literal notranslate"><span class="pre">None</span></code>
indicates that a prediction could not be produced for that <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[int, int | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.load_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">load_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.load_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a sentence-transformer index saved via <a class="reference internal" href="#knn.core.index.save_sentence_transformer_index" title="knn.core.index.save_sentence_transformer_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing previously persisted artefacts to load from disk.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the loaded sentence-transformer index and associated metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.load_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">load_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.load_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a TF-IDF index previously saved via <a class="reference internal" href="#knn.core.index.save_tfidf_index" title="knn.core.index.save_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted TF-IDF artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the loaded vectoriser, matrix, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.load_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">load_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.load_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a Word2Vec index previously saved via <a class="reference internal" href="#knn.core.index.save_word2vec_index" title="knn.core.index.save_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted Word2Vec artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the restored Word2Vec model, embeddings, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.save_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">save_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.save_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the sentence-transformer index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – KNN index object or registry being manipulated.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Output directory receiving generated metrics and reports.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.save_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">save_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.save_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the TF-IDF index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.core.index.build_tfidf_index" title="knn.core.index.build_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where artifacts will be written.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.save_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">save_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.save_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the Word2Vec index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.core.index.build_word2vec_index" title="knn.core.index.build_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where embeddings and metadata are stored.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.evaluate">Top-level exports for the KNN evaluation helpers.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.bin_nopts">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">bin_nopts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bin_nopts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.bin_nopts" title="Link to this definition">¶</a></dt>
<dd><p>Bucket the number of slate options into reporting-friendly categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option_count</strong> (<em>int</em>) – Number of options contained in a recommendation slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="docutils literal notranslate"><span class="pre">{&quot;1&quot;,</span> <span class="pre">&quot;2&quot;,</span> <span class="pre">&quot;3&quot;,</span> <span class="pre">&quot;4&quot;,</span> <span class="pre">&quot;5+&quot;}</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.bucket_from_pos">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">bucket_from_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bucket_from_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.bucket_from_pos" title="Link to this definition">¶</a></dt>
<dd><p>Bucket a 0-based position index into the standard reporting bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pos_idx</strong> (<em>int</em>) – Zero-based position of the correct item within the retrieved slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="xref py py-data docutils literal notranslate"><span class="pre">BUCKET_LABELS</span></code> describing the position bucket.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.canon">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">canon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#canon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.canon" title="Link to this definition">¶</a></dt>
<dd><p>Canonicalise a text fragment by lowercasing and removing punctuation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Raw text fragment to normalise.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Canonical representation suitable for equality comparisons.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.compute_auc_from_curve">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">compute_auc_from_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#compute_auc_from_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.compute_auc_from_curve" title="Link to this definition">¶</a></dt>
<dd><p>Compute the area under the accuracy curve across <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy observed for each <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (area, normalised_area).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.evaluate_issue">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">evaluate_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#evaluate_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.evaluate_issue" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate a single issue slice and persist metrics, curves, and predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>knn.core.evaluate.pipeline.IssueEvaluationRequest</em>) – Evaluation bundle describing the issue to score.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Results are persisted via <code class="xref py py-func docutils literal notranslate"><span class="pre">write_issue_outputs()</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.parse_k_values">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">parse_k_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#parse_k_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.parse_k_values" title="Link to this definition">¶</a></dt>
<dd><p>Derive the sorted set of <code class="docutils literal notranslate"><span class="pre">k</span></code> values requested for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_default</strong> (<em>int</em>) – Baseline <code class="docutils literal notranslate"><span class="pre">k</span></code> value used when the sweep is empty.</p></li>
<li><p><strong>sweep</strong> (<em>str</em>) – Comma-delimited string of additional <code class="docutils literal notranslate"><span class="pre">k</span></code> candidates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Strictly positive <code class="docutils literal notranslate"><span class="pre">k</span></code> values in ascending order. Falls back to
<code class="docutils literal notranslate"><span class="pre">k_default</span></code> (or <code class="docutils literal notranslate"><span class="pre">25</span></code> when unset) if no valid integers are supplied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.plot_elbow">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">plot_elbow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'validation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#plot_elbow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.plot_elbow" title="Link to this definition">¶</a></dt>
<dd><p>Plot the accuracy curve (acc&#64;k) for the evaluation stage and mark <code class="docutils literal notranslate"><span class="pre">best_k</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values that were evaluated.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Mapping</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy keyed by <code class="docutils literal notranslate"><span class="pre">k</span></code> for the evaluation split.</p></li>
<li><p><strong>best_k</strong> (<em>int</em>) – Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> to highlight in the plot.</p></li>
<li><p><strong>output_path</strong> (<em>pathlib.Path</em>) – Destination path for the generated PNG artefact.</p></li>
<li><p><strong>data_split</strong> (<em>str</em>) – Split label used for the legend title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.resolve_reports_dir">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">resolve_reports_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/outputs.html#resolve_reports_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.resolve_reports_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the canonical reports directory corresponding to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out_dir</strong> (<em>pathlib.Path</em>) – Directory containing pipeline artefacts (typically under <code class="docutils literal notranslate"><span class="pre">models/knn</span></code>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path pointing at the repository-level <code class="docutils literal notranslate"><span class="pre">reports</span></code> directory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.run_eval">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.run_eval" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the KNN baseline across the issues specified on the CLI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – Namespace returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">knn.cli.build_parser()</span></code>, including dataset,
feature-space, and sweep configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Evaluation artefacts are persisted via downstream helpers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.select_best_k">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">select_best_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'elbow'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#select_best_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.select_best_k" title="Link to this definition">¶</a></dt>
<dd><p>Select <code class="docutils literal notranslate"><span class="pre">k</span></code> using either max-accuracy or an elbow heuristic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sorted sequence of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Observed eligible-only accuracy for each <code class="docutils literal notranslate"><span class="pre">k</span></code> on the
validation split.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Selection strategy (default: <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code>). <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> picks
the accuracy-maximising <code class="docutils literal notranslate"><span class="pre">k</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code> picks the first <code class="docutils literal notranslate"><span class="pre">k</span></code> where
marginal gains fall below half the initial slope, falling back to
max-accuracy when the heuristic is not applicable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> per the requested method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion">Opinion-regression utilities supporting the KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion.run_opinion_eval">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion.</span></span><span class="sig-name descname"><span class="pre">run_opinion_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion.html#run_opinion_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion.run_opinion_eval" title="Link to this definition">¶</a></dt>
<dd><p>Execute the post-study opinion index evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Any</em>) – Namespace object containing parsed command-line arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_models">Shared data structures used by the KNN opinion baseline.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEmbeddingConfigs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionEmbeddingConfigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word2vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEmbeddingConfigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optional embedding builders available during evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word2vec</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>sentence_transformer</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEmbeddingConfigs.sentence_transformer">
<span class="sig-name descname"><span class="pre">sentence_transformer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><span class="pre">common.text.embeddings.SentenceTransformerConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.sentence_transformer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEmbeddingConfigs.word2vec">
<span class="sig-name descname"><span class="pre">word2vec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><span class="pre">knn.core.features.Word2VecConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.word2vec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionEvaluationContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs_root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEvaluationContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared configuration for evaluating a single opinion study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>)</p></li>
<li><p><strong>dataset</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Sequence</em><em>[</em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>embedding_configs</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><em>knn.core.opinion_models.OpinionEmbeddingConfigs</em></a>)</p></li>
<li><p><strong>outputs_root</strong> (<em>pathlib.Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.args">
<span class="sig-name descname"><span class="pre">args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.args" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.embedding_configs">
<span class="sig-name descname"><span class="pre">embedding_configs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><span class="pre">knn.core.opinion_models.OpinionEmbeddingConfigs</span></a></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.embedding_configs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.extra_fields">
<span class="sig-name descname"><span class="pre">extra_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.extra_fields" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.k_values">
<span class="sig-name descname"><span class="pre">k_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.k_values" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.outputs_root">
<span class="sig-name descname"><span class="pre">outputs_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.outputs_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionExample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">participant_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionExample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionExample" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.models.OpinionExample</span></code></p>
<p>Collapsed participant-level prompt and opinion values with session context.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_index</strong> (<em>int</em>) – Interaction step index retained from the raw dataset.</p></li>
<li><p><strong>session_id</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Session identifier associated with the participant example.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>participant_id</strong> (<em>str</em>)</p></li>
<li><p><strong>participant_study</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>document</strong> (<em>str</em>)</p></li>
<li><p><strong>before</strong> (<em>float</em>)</p></li>
<li><p><strong>after</strong> (<em>float</em>)</p></li>
<li><p><strong>step_index</strong> (<em>int</em>)</p></li>
<li><p><strong>session_id</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.after">
<span class="sig-name descname"><span class="pre">after</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.after" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.before">
<span class="sig-name descname"><span class="pre">before</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.before" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.document">
<span class="sig-name descname"><span class="pre">document</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.document" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.issue">
<span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.issue" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.participant_id">
<span class="sig-name descname"><span class="pre">participant_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.participant_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.participant_study">
<span class="sig-name descname"><span class="pre">participant_study</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.participant_study" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.session_id">
<span class="sig-name descname"><span class="pre">session_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.session_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.step_index">
<span class="sig-name descname"><span class="pre">step_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.step_index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_after</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets_before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionIndex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Vectorised training corpus, cached targets, and fitted neighbour index.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (tfidf, word2vec, sentence_transformer).</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Distance metric used by the KNN index.</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>) – Document-term matrix or embedding matrix backing the index.</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>) – Trained vectoriser or embedding builder.</p></li>
<li><p><strong>embeds</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – Optional Word2Vec feature builder used for inference.</p></li>
<li><p><strong>targets_after</strong> (<em>numpy.ndarray</em>) – Post-study opinion targets aligned with the corpus.</p></li>
<li><p><strong>targets_before</strong> (<em>numpy.ndarray</em>) – Pre-study opinion targets aligned with the corpus.</p></li>
<li><p><strong>participant_keys</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – Participant/study identifiers aligned with targets.</p></li>
<li><p><strong>neighbors</strong> (<em>NearestNeighbors</em>) – Fitted <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.neighbors.NearestNeighbors</span></code> index.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>metric</strong> (<em>str</em>)</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>)</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>)</p></li>
<li><p><strong>embeds</strong> (<em>Any</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>targets_after</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><strong>targets_before</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><strong>participant_keys</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>neighbors</strong> (<em>sklearn.neighbors.NearestNeighbors</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.embeds">
<span class="sig-name descname"><span class="pre">embeds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.embeds" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.matrix" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.metric" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.neighbors">
<span class="sig-name descname"><span class="pre">neighbors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">sklearn.neighbors.NearestNeighbors</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.neighbors" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.participant_keys">
<span class="sig-name descname"><span class="pre">participant_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.participant_keys" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.targets_after">
<span class="sig-name descname"><span class="pre">targets_after</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.targets_after" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.targets_before">
<span class="sig-name descname"><span class="pre">targets_before</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.targets_before" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.vectorizer">
<span class="sig-name descname"><span class="pre">vectorizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.vectorizer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.core.opinion_data">Dataset helpers for opinion-regression studies.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_data.collect_examples">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_data.</span></span><span class="sig-name descname"><span class="pre">collect_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_examples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_data.html#collect_examples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_data.collect_examples" title="Link to this definition">¶</a></dt>
<dd><p>Collapse the dataset split into participant-level opinion rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.Dataset</em><em> | </em><em>Sequence</em><em>[</em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Dataset split providing raw participant interactions.</p></li>
<li><p><strong>spec</strong> (<em>OpinionSpec</em>) – Opinion study specification describing the target columns.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Additional prompt columns appended to each document.</p></li>
<li><p><strong>max_examples</strong> (<em>int</em><em> | </em><em>None</em>) – Optional cap on participants retained from the split.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed applied when subsampling participants.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Participant-level examples combining prompts and opinion values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.core.opinion_models.OpinionExample" title="knn.core.opinion_models.OpinionExample">OpinionExample</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_data.find_spec">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_data.</span></span><span class="sig-name descname"><span class="pre">find_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_data.html#find_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_data.find_spec" title="Link to this definition">¶</a></dt>
<dd><p>Return the <code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionSpec</span></code> matching <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – Dictionary key identifying the current record.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matching opinion specification.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OpinionSpec</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If <code class="docutils literal notranslate"><span class="pre">key</span></code> does not correspond to a known spec.</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_index">Feature-space transformations and neighbour indices for opinion regression.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_index.build_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_index.</span></span><span class="sig-name descname"><span class="pre">build_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">examples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_index.html#build_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_index.build_index" title="Link to this definition">¶</a></dt>
<dd><p>Vectorise <code class="docutils literal notranslate"><span class="pre">examples</span></code> and construct a neighbour index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>examples</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.core.opinion_models.OpinionExample" title="knn.core.opinion_models.OpinionExample"><em>OpinionExample</em></a><em>]</em>) – Collection of dataset rows used in the evaluation.</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier such as <code class="docutils literal notranslate"><span class="pre">tfidf</span></code> or <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>.</p></li>
<li><p><strong>spec</strong> (<em>OpinionSpec</em>) – Opinion study specification containing issue metadata.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed used to initialise pseudo-random operations.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Name of the evaluation metric being inspected.</p></li>
<li><p><strong>word2vec_config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em>]</em>) – Configuration object carrying Word2Vec hyper-parameters.</p></li>
<li><p><strong>sentence_config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>SentenceTransformerConfig</em></a><em>]</em>) – Sentence-transformer configuration describing encoding details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured KNN index ready for inference.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex" title="knn.core.opinion_models.OpinionIndex">OpinionIndex</a></p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_predictions">Prediction and metric utilities for the KNN opinion pipeline.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_predictions.predict_post_indices">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_predictions.</span></span><span class="sig-name descname"><span class="pre">predict_post_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_examples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_predictions.html#predict_post_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_predictions.predict_post_indices" title="Link to this definition">¶</a></dt>
<dd><p>Return predictions and aggregate metrics for <code class="docutils literal notranslate"><span class="pre">eval_examples</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionIndex" title="knn.core.opinion_models.OpinionIndex"><em>OpinionIndex</em></a>) – KNN index object or registry being manipulated.</p></li>
<li><p><strong>eval_examples</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.core.opinion_models.OpinionExample" title="knn.core.opinion_models.OpinionExample"><em>OpinionExample</em></a><em>]</em>) – Iterable of evaluation examples to score with the index.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate or report.</p></li>
<li><p><strong>exclude_self</strong> (<em>bool</em>) – Whether to drop the query point when collecting nearest neighbours.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predictions and aggregate metrics keyed by <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_plots">Plotting utilities for KNN opinion evaluations.</p>
<p id="module-knn.core.opinion_outputs">Output helpers for persisting opinion evaluation artefacts.</p>
<p id="module-knn.core.utils">Shim exposing common logging and filesystem helpers to KNN modules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.utils.ensure_directory">
<span class="sig-prename descclassname"><span class="pre">knn.core.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#ensure_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.utils.ensure_directory" title="Link to this definition">¶</a></dt>
<dd><p>Create <code class="docutils literal notranslate"><span class="pre">path</span></code> (including parents) when it does not already exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>pathlib.Path</em><em> | </em><em>str</em>) – Target directory to ensure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.utils.get_logger">
<span class="sig-prename descclassname"><span class="pre">knn.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.utils.get_logger" title="Link to this definition">¶</a></dt>
<dd><p>Return a memoised logger configured with a simple stream handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name registered on the logger.</p></li>
<li><p><strong>level</strong> (<em>int</em>) – Log level applied when initialising the logger.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured logger instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.utils">
<span id="core-utilities"></span><h2>Core Utilities<a class="headerlink" href="#module-knn.utils" title="Link to this heading">¶</a></h2>
<p>Shim exposing common logging and filesystem helpers to KNN modules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.utils.ensure_directory">
<span class="sig-prename descclassname"><span class="pre">knn.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#ensure_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.utils.ensure_directory" title="Link to this definition">¶</a></dt>
<dd><p>Create <code class="docutils literal notranslate"><span class="pre">path</span></code> (including parents) when it does not already exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>pathlib.Path</em><em> | </em><em>str</em>) – Target directory to ensure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.utils.get_logger">
<span class="sig-prename descclassname"><span class="pre">knn.utils.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.utils.get_logger" title="Link to this definition">¶</a></dt>
<dd><p>Return a memoised logger configured with a simple stream handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name registered on the logger.</p></li>
<li><p><strong>level</strong> (<em>int</em>) – Log level applied when initialising the logger.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured logger instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.pipeline">
<span id="pipeline-modules"></span><h2>Pipeline Modules<a class="headerlink" href="#module-knn.pipeline" title="Link to this heading">¶</a></h2>
<p>Pipeline orchestration for the Grail Simulation KNN baselines.</p>
<p>The module coordinates hyper-parameter sweeps, final evaluations, and
Markdown report generation for the slate-ranking and opinion-regression
KNN workflows used throughout the project.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.main">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.main" title="Link to this definition">¶</a></dt>
<dd><p>Coordinate sweeps, evaluations, and report generation for the KNN pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional argument vector override used when invoking the CLI programmatically.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.__main__">Entry point for <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">knn.pipeline</span></code>.</p>
<p id="module-knn.pipeline.cli">Command-line helpers for the Grail Simulation KNN pipeline.</p>
<p>The functions here construct the CLI parser, resolve default directories,
and translate parsed arguments into sweep configurations consumed by
<code class="docutils literal notranslate"><span class="pre">knn.pipeline</span></code> and its orchestration helpers.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.build_base_cli">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">build_base_cli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#build_base_cli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.build_base_cli" title="Link to this definition">¶</a></dt>
<dd><p>Construct the CLI argument prefix reused across KNN pipeline invocations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a>) – Pipeline configuration describing dataset paths and sweep options.</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Argument list containing dataset/cache flags plus other shared options.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.build_pipeline_context">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">build_pipeline_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#build_pipeline_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.build_pipeline_context" title="Link to this definition">¶</a></dt>
<dd><p>Normalise CLI flags and environment overrides into a <code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineContext</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>argparse.Namespace</em>) – Parsed pipeline arguments that may omit optional values.</p></li>
<li><p><strong>root</strong> (<em>Path</em>) – Repository root, used to derive sensible defaults for directories.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fully-populated context capturing dataset paths, sweep configuration,
Word2Vec parameters, SentenceTransformer settings, and task toggles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.default_cache_dir">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">default_cache_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#default_cache_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.default_cache_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the datasets cache directory used by the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root</strong> (<em>Path</em>) – Repository root from which cache directories are derived.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to <code class="docutils literal notranslate"><span class="pre">.cache/huggingface/knn</span></code> rooted under <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.default_dataset">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">default_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#default_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.default_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the default dataset location under the repository.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root</strong> (<em>Path</em>) – Repository root from which data directories are derived.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filesystem path pointing to <code class="docutils literal notranslate"><span class="pre">data/cleaned_grail</span></code> beneath <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.default_out_dir">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">default_out_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#default_out_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.default_out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the default directory for all pipeline outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root</strong> (<em>Path</em>) – Repository root from which output directories are derived.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to <code class="docutils literal notranslate"><span class="pre">models/knn</span></code> rooted under <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.log_dry_run">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">log_dry_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#log_dry_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.log_dry_run" title="Link to this definition">¶</a></dt>
<dd><p>Log the number of sweep configurations that would have executed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Planned sweep configuration objects assembled during a dry run.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. The function reports the count via <code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.log_run_configuration">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">log_run_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#log_run_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.log_run_configuration" title="Link to this definition">¶</a></dt>
<dd><p>Emit a concise summary of the resolved pipeline configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Collection of study specifications that will be evaluated.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a>) – Pipeline context describing dataset paths, jobs, and task toggles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. The function writes human-readable configuration details to the logger.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.parse_args">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">parse_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#parse_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.parse_args" title="Link to this definition">¶</a></dt>
<dd><p>Parse high-level pipeline arguments and capture any extra CLI tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Explicit argument vector used for parsing. When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
the function consumes <code class="xref py py-data docutils literal notranslate"><span class="pre">sys.argv</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pair containing the parsed namespace and a list of passthrough arguments that should
be forwarded to downstream CLI invocations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[argparse.Namespace, List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.repo_root">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">repo_root</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#repo_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.repo_root" title="Link to this definition">¶</a></dt>
<dd><p>Compute the repository root by traversing upwards from this module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Absolute path to the project root (three directories above <code class="docutils literal notranslate"><span class="pre">pipeline.cli</span></code>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.context">Data structures describing the Grail Simulation KNN pipeline state.</p>
<p>This module defines the sweep configurations, task descriptors, execution
contexts, and report bundles shared by the pipeline orchestration code.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">EvaluationContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_models</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#EvaluationContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.EvaluationContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared CLI/runtime parameters for final evaluation stages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Baseline CLI arguments reused for every invocation.</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Additional CLI arguments appended to each invocation.</p></li>
<li><p><strong>next_video_out_dir</strong> (<em>Path</em>) – Output directory where next-video artefacts are written.</p></li>
<li><p><strong>opinion_out_dir</strong> (<em>Path</em>) – Output directory where opinion artefacts are written.</p></li>
<li><p><strong>next_video_word2vec_dir</strong> (<em>Path</em>) – Location of cached Word2Vec models for next-video runs.</p></li>
<li><p><strong>opinion_word2vec_dir</strong> (<em>Path</em>) – Location of cached Word2Vec models for opinion runs.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Flag controlling whether cached artefacts may be reused.</p></li>
<li><p><strong>out_dir</strong> (<em>Path</em><em> | </em><em>None</em>) – Legacy base directory used for both tasks (fallback when task-specific
directories are omitted).</p></li>
<li><p><strong>word2vec_model_dir</strong> (<em>Path</em><em> | </em><em>None</em>) – Legacy Word2Vec cache directory shared across tasks.</p></li>
<li><p><strong>outputs</strong> (<em>knn.pipeline.context.EvaluationOutputs</em>)</p></li>
<li><p><strong>word2vec_models</strong> (<em>knn.pipeline.context.EvaluationWord2VecPaths</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.base_cli">
<span class="sig-name descname"><span class="pre">base_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.base_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.extra_cli">
<span class="sig-name descname"><span class="pre">extra_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.extra_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.from_args">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overrides</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#EvaluationContext.from_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.from_args" title="Link to this definition">¶</a></dt>
<dd><p>Build an <a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluationContext</span></code></a> from legacy or task-specific directory overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Result produced by <code class="docutils literal notranslate"><span class="pre">EvaluationContext</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext">EvaluationContext</a></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>)</p></li>
<li><p><strong>overrides</strong> (<em>object</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.next_video_out_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">next_video_out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.next_video_out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Directory where next-video evaluation artefacts are written.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.next_video_word2vec_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">next_video_word2vec_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.next_video_word2vec_dir" title="Link to this definition">¶</a></dt>
<dd><p>Directory containing Word2Vec caches for next-video runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.opinion_out_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.opinion_out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Directory where opinion evaluation artefacts are written.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.opinion_word2vec_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_word2vec_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.opinion_word2vec_dir" title="Link to this definition">¶</a></dt>
<dd><p>Directory containing Word2Vec caches for opinion runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.out_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Legacy evaluation output directory preserved for backwards compatibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.outputs">
<span class="sig-name descname"><span class="pre">outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">knn.pipeline.context.EvaluationOutputs</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.outputs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.reuse_existing">
<span class="sig-name descname"><span class="pre">reuse_existing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.reuse_existing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.word2vec_model_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd><p>Legacy shared Word2Vec cache directory preserved for backwards compatibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.word2vec_models">
<span class="sig-name descname"><span class="pre">word2vec_models</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">knn.pipeline.context.EvaluationWord2VecPaths</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.word2vec_models" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">MetricSummary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_eligible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_all_rows</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#MetricSummary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.MetricSummary" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalised slice of slate evaluation metrics used across reports.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accuracy</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Validation accuracy for the selected configuration.</p></li>
<li><p><strong>accuracy_ci</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – 95% confidence interval for <a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy" title="knn.pipeline.context.MetricSummary.accuracy"><code class="xref py py-attr docutils literal notranslate"><span class="pre">accuracy</span></code></a>.</p></li>
<li><p><strong>baseline</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Baseline accuracy from the most-frequent-gold comparator.</p></li>
<li><p><strong>baseline_ci</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – 95% confidence interval for <a class="reference internal" href="#knn.pipeline.context.MetricSummary.baseline" title="knn.pipeline.context.MetricSummary.baseline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">baseline</span></code></a>.</p></li>
<li><p><strong>random_baseline</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Expected accuracy for a random slate selection baseline.</p></li>
<li><p><strong>best_k</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – <code class="docutils literal notranslate"><span class="pre">k</span></code> value delivering the best validation accuracy.</p></li>
<li><p><strong>n_total</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Total number of evaluation rows considered.</p></li>
<li><p><strong>n_eligible</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Number of rows eligible for the final metric.</p></li>
<li><p><strong>accuracy_all_rows</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Accuracy over all rows (eligible and ineligible).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.accuracy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.accuracy_all_rows">
<span class="sig-name descname"><span class="pre">accuracy_all_rows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.accuracy_all_rows" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.accuracy_ci">
<span class="sig-name descname"><span class="pre">accuracy_ci</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.accuracy_ci" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.baseline">
<span class="sig-name descname"><span class="pre">baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.baseline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.baseline_ci">
<span class="sig-name descname"><span class="pre">baseline_ci</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.baseline_ci" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.best_k">
<span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.best_k" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.n_eligible">
<span class="sig-name descname"><span class="pre">n_eligible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.n_eligible" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.n_total">
<span class="sig-name descname"><span class="pre">n_total</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.n_total" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.random_baseline">
<span class="sig-name descname"><span class="pre">random_baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.random_baseline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionStudySelection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionStudySelection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#OpinionStudySelection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionStudySelection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="xgb.html#xgb.pipeline_context.OpinionStudySelection" title="common.pipeline.types.OpinionStudySelection"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.pipeline.types.OpinionStudySelection</span></code></a></p>
<p>Selected configuration for the final opinion evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>) – Opinion study metadata chosen for final evaluation.</p></li>
<li><p><strong>outcome</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>) – Winning opinion sweep outcome promoted for the study.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionStudySelection.best_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionStudySelection.best_k" title="Link to this definition">¶</a></dt>
<dd><p>Return the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> for the study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a>) – Opinion selection exposing the chosen sweep outcome.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> for the study</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionSummary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baseline_accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_slope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_calibration_slope</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_calibration_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_ece</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_calibration_ece</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kl_divergence_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_kl_divergence_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participants</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eligible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mae</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mae_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmse_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_mae</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_rmse_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mae_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#OpinionSummary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSummary" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.models.OpinionCalibrationMetrics</span></code></p>
<p>Normalised view of opinion-regression metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mae</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Mean absolute error for the selected configuration.</p></li>
<li><p><strong>rmse</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Root-mean-square error for the selected configuration.</p></li>
<li><p><strong>r2_score</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Coefficient of determination capturing explained variance.</p></li>
<li><p><strong>mae_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Normalised change in MAE relative to the baseline.</p></li>
<li><p><strong>rmse_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Root-mean-square error on the opinion-change signal.</p></li>
<li><p><strong>baseline_mae</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Baseline MAE measured using pre-study opinions.</p></li>
<li><p><strong>baseline_rmse_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Baseline RMSE on the opinion-change signal.</p></li>
<li><p><strong>mae_delta</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Absolute delta between <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae" title="knn.pipeline.context.OpinionSummary.mae"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mae</span></code></a> and <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.baseline_mae" title="knn.pipeline.context.OpinionSummary.baseline_mae"><code class="xref py py-attr docutils literal notranslate"><span class="pre">baseline_mae</span></code></a>.</p></li>
<li><p><strong>accuracy</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Directional accuracy comparing predicted opinion shifts.</p></li>
<li><p><strong>calibration_slope</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Calibration slope between predicted and actual opinion deltas.</p></li>
<li><p><strong>calibration_intercept</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Calibration intercept between predicted and actual opinion deltas.</p></li>
<li><p><strong>calibration_ece</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Expected calibration error computed over opinion-change bins.</p></li>
<li><p><strong>kl_divergence_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – KL divergence between predicted and actual change distributions.</p></li>
<li><p><strong>calibration_bins</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>, </em><em>...</em><em>]</em><em>]</em>) – Optional tuple of bin summaries backing <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.calibration_ece" title="knn.pipeline.context.OpinionSummary.calibration_ece"><code class="xref py py-attr docutils literal notranslate"><span class="pre">calibration_ece</span></code></a>.</p></li>
<li><p><strong>best_k</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Neighbourhood size delivering the final metrics.</p></li>
<li><p><strong>participants</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Number of participants included in the evaluation split.</p></li>
<li><p><strong>eligible</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Count of evaluation examples used to compute accuracy metrics.</p></li>
<li><p><strong>dataset</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Name of the dataset used to compute the metrics.</p></li>
<li><p><strong>split</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Dataset split powering the evaluation (e.g. <code class="docutils literal notranslate"><span class="pre">train</span></code>, <code class="docutils literal notranslate"><span class="pre">validation</span></code>).</p></li>
<li><p><strong>baseline_accuracy</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>accuracy_delta</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>baseline_calibration_slope</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>baseline_calibration_intercept</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>baseline_calibration_ece</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>baseline_kl_divergence_change</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Note<span class="colon">:</span></dt>
<dd class="field-even"><p>Baseline and calibration deltas are documented in <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.OpinionCalibrationMetrics</span></code>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.accuracy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.baseline_mae">
<span class="sig-name descname"><span class="pre">baseline_mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.baseline_mae" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.baseline_rmse_change">
<span class="sig-name descname"><span class="pre">baseline_rmse_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.baseline_rmse_change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.best_k">
<span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.best_k" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.calibration_bins">
<span class="sig-name descname"><span class="pre">calibration_bins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.calibration_bins" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.calibration_ece">
<span class="sig-name descname"><span class="pre">calibration_ece</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.calibration_ece" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.calibration_intercept">
<span class="sig-name descname"><span class="pre">calibration_intercept</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.calibration_intercept" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.calibration_slope">
<span class="sig-name descname"><span class="pre">calibration_slope</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.calibration_slope" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.kl_divergence_change">
<span class="sig-name descname"><span class="pre">kl_divergence_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.kl_divergence_change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.mae">
<span class="sig-name descname"><span class="pre">mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.mae" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.mae_change">
<span class="sig-name descname"><span class="pre">mae_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.mae_change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.mae_delta">
<span class="sig-name descname"><span class="pre">mae_delta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.mae_delta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.r2_score">
<span class="sig-name descname"><span class="pre">r2_score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.r2_score" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.rmse">
<span class="sig-name descname"><span class="pre">rmse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.rmse" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.rmse_change">
<span class="sig-name descname"><span class="pre">rmse_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.rmse_change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionSweepOutcome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mae</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">artifact</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_summary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_mae</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mae_delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participants</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#OpinionSweepOutcome"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseOpinionSweepOutcome</span></code>[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context.SweepConfig</span></code></a>]</p>
<p>Extend <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseOpinionSweepOutcome</span></code> with
KNN-specific opinion regression metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space evaluated by the opinion sweep.</p></li>
<li><p><strong>r2_score</strong> (<em>float</em>) – Coefficient of determination for the opinion regression.</p></li>
<li><p><strong>baseline_mae</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Baseline MAE measured using before-study opinions (if any).</p></li>
<li><p><strong>mae_delta</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Absolute delta between <code class="docutils literal notranslate"><span class="pre">mae</span></code> and <code class="docutils literal notranslate"><span class="pre">baseline_mae</span></code>.</p></li>
<li><p><strong>best_k</strong> (<em>int</em>) – Optimal neighbour count determined for the study.</p></li>
<li><p><strong>participants</strong> (<em>int</em>) – Number of participants contributing to the metrics.</p></li>
<li><p><strong>order_index</strong> (<em>int</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a>)</p></li>
<li><p><strong>config</strong> (<em>common.opinion.sweep_types.ConfigT</em>)</p></li>
<li><p><strong>mae</strong> (<em>float</em>)</p></li>
<li><p><strong>rmse</strong> (<em>float</em>)</p></li>
<li><p><strong>artifact</strong> (<em>common.opinion.sweep_types.MetricsArtifact</em>)</p></li>
<li><p><strong>accuracy_summary</strong> (<em>common.opinion.sweep_types.AccuracySummary</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.baseline_mae">
<span class="sig-name descname"><span class="pre">baseline_mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.baseline_mae" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.best_k">
<span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.best_k" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.mae_delta">
<span class="sig-name descname"><span class="pre">mae_delta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.mae_delta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.participants">
<span class="sig-name descname"><span class="pre">participants</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.participants" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.r2_score">
<span class="sig-name descname"><span class="pre">r2_score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.r2_score" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionSweepTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#OpinionSweepTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseOpinionSweepTask</span></code>[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context.SweepConfig</span></code></a>]</p>
<p>Extend <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseOpinionSweepTask</span></code> with the
CLI context required by the KNN implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Baseline CLI arguments reused across tasks.</p></li>
<li><p><strong>extra_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Additional passthrough CLI arguments for the job.</p></li>
<li><p><strong>run_root</strong> (<em>Path</em>) – Directory where opinion sweep outputs are written.</p></li>
<li><p><strong>word2vec_model_dir</strong> (<em>Path</em><em> | </em><em>None</em>) – Optional directory providing cached Word2Vec models.</p></li>
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a>)</p></li>
<li><p><strong>config</strong> (<em>common.opinion.sweep_types.ConfigT</em>)</p></li>
<li><p><strong>metrics_path</strong> (<em>pathlib.Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.base_cli">
<span class="sig-name descname"><span class="pre">base_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.base_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.extra_cli">
<span class="sig-name descname"><span class="pre">extra_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.extra_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.run_root">
<span class="sig-name descname"><span class="pre">run_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.run_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.word2vec_model_dir">
<span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">PipelineContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_video_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_sweep_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_word2vec_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_sweep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_workers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_normalize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_sweeps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_final</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_next_video</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_opinion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#PipelineContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.PipelineContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalised configuration for a pipeline run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>str</em>) – Dataset path or HuggingFace identifier used for all workloads.</p></li>
<li><p><strong>out_dir</strong> (<em>Path</em>) – Output directory where sweeps, reports, and metrics are written.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – Hugging Face datasets cache directory.</p></li>
<li><p><strong>sweep_dir</strong> (<em>Path</em>) – Directory that stores next-video hyper-parameter sweep outputs.</p></li>
<li><p><strong>word2vec_model_dir</strong> (<em>Path</em>) – Location used to persist or read Word2Vec models.</p></li>
<li><p><strong>next_video_dir</strong> (<em>Path</em>) – Root directory for next-video evaluation artefacts.</p></li>
<li><p><strong>opinion_dir</strong> (<em>Path</em>) – Root directory for opinion evaluation artefacts.</p></li>
<li><p><strong>opinion_sweep_dir</strong> (<em>Path</em>) – Directory storing opinion hyper-parameter sweep outputs.</p></li>
<li><p><strong>opinion_word2vec_dir</strong> (<em>Path</em>) – Location used to persist or read opinion Word2Vec models.</p></li>
<li><p><strong>k_sweep</strong> (<em>str</em>) – Comma-separated list of <code class="docutils literal notranslate"><span class="pre">k</span></code> values evaluated during sweeps.</p></li>
<li><p><strong>study_tokens</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Study identifiers supplied via CLI or environment overrides.</p></li>
<li><p><strong>word2vec_epochs</strong> (<em>int</em>) – Number of epochs to use when training Word2Vec embeddings.</p></li>
<li><p><strong>word2vec_workers</strong> (<em>int</em>) – Number of parallel workers for Word2Vec processing.</p></li>
<li><p><strong>sentence_model</strong> (<em>str</em>) – SentenceTransformer model identifier to encode viewer prompts.</p></li>
<li><p><strong>sentence_device</strong> (<em>str</em><em> | </em><em>None</em>) – Device hint (<code class="docutils literal notranslate"><span class="pre">cpu</span></code>/<code class="docutils literal notranslate"><span class="pre">cuda</span></code>) for SentenceTransformer, if provided.</p></li>
<li><p><strong>sentence_batch_size</strong> (<em>int</em>) – Batch size used during SentenceTransformer encoding.</p></li>
<li><p><strong>sentence_normalize</strong> (<em>bool</em>) – Flag indicating whether embeddings are L2-normalised.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Feature spaces that should be evaluated during the run.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Level of parallelism when scheduling sweep or evaluation tasks.</p></li>
<li><p><strong>reuse_sweeps</strong> (<em>bool</em>) – Whether cached sweep artefacts can be reused instead of re-running.</p></li>
<li><p><strong>reuse_final</strong> (<em>bool</em>) – Whether cached final evaluation artefacts can be reused.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Permit finalize/report stages to run with partial sweep coverage.</p></li>
<li><p><strong>run_next_video</strong> (<em>bool</em>) – Toggle controlling whether slate evaluation is executed.</p></li>
<li><p><strong>run_opinion</strong> (<em>bool</em>) – Toggle controlling whether opinion evaluation is executed.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.cache_dir">
<span class="sig-name descname"><span class="pre">cache_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.cache_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.feature_spaces">
<span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.feature_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.jobs">
<span class="sig-name descname"><span class="pre">jobs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.jobs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.k_sweep">
<span class="sig-name descname"><span class="pre">k_sweep</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.k_sweep" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.next_video_dir">
<span class="sig-name descname"><span class="pre">next_video_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.next_video_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.opinion_dir">
<span class="sig-name descname"><span class="pre">opinion_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.opinion_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.opinion_sweep_dir">
<span class="sig-name descname"><span class="pre">opinion_sweep_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.opinion_sweep_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.opinion_word2vec_dir">
<span class="sig-name descname"><span class="pre">opinion_word2vec_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.opinion_word2vec_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.out_dir">
<span class="sig-name descname"><span class="pre">out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.out_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.reuse_final">
<span class="sig-name descname"><span class="pre">reuse_final</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.reuse_final" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.reuse_sweeps">
<span class="sig-name descname"><span class="pre">reuse_sweeps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.reuse_sweeps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.run_next_video">
<span class="sig-name descname"><span class="pre">run_next_video</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.run_next_video" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.run_opinion">
<span class="sig-name descname"><span class="pre">run_opinion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.run_opinion" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sentence_batch_size">
<span class="sig-name descname"><span class="pre">sentence_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sentence_batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sentence_device">
<span class="sig-name descname"><span class="pre">sentence_device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sentence_device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sentence_model">
<span class="sig-name descname"><span class="pre">sentence_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sentence_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sentence_normalize">
<span class="sig-name descname"><span class="pre">sentence_normalize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sentence_normalize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.study_tokens">
<span class="sig-name descname"><span class="pre">study_tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.study_tokens" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sweep_dir">
<span class="sig-name descname"><span class="pre">sweep_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sweep_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.word2vec_epochs">
<span class="sig-name descname"><span class="pre">word2vec_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.word2vec_epochs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.word2vec_model_dir">
<span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.word2vec_workers">
<span class="sig-name descname"><span class="pre">word2vec_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.word2vec_workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">ReportBundle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep_outcomes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_selections=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_sweep_outcomes=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_metrics=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_from_next_metrics=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_sweep=''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loso_metrics=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces=('tfidf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'word2vec'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'sentence_transformer')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_model=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_next_video=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_opinion=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_opinion_from_next=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_predictions_root=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_from_next_predictions_root=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#ReportBundle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.ReportBundle" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Aggregated artefacts required to render Markdown reports for the pipeline run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a><em>]</em><em>]</em>) – Winning slate selections keyed by feature space and study slug.</p></li>
<li><p><strong>sweep_outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a><em>]</em>) – Chronological list of all slate sweep outcomes.</p></li>
<li><p><strong>opinion_selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a><em>]</em><em>]</em>) – Winning opinion selections keyed by feature space and study slug.</p></li>
<li><p><strong>opinion_sweep_outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Chronological list of all opinion sweep outcomes.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study descriptors used when rendering friendly labels.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Cached final slate metrics grouped by feature space and study.</p></li>
<li><p><strong>opinion_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Cached final opinion metrics grouped by feature space and study.</p></li>
<li><p><strong>opinion_from_next_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Opinion metrics computed using the next-video configuration.</p></li>
<li><p><strong>opinion_predictions_root</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – Root directory containing opinion prediction artefacts.</p></li>
<li><p><strong>opinion_from_next_predictions_root</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – Root directory for opinion-from-next artefacts.</p></li>
<li><p><strong>k_sweep</strong> (<em>str</em>) – Textual representation of the <code class="docutils literal notranslate"><span class="pre">k</span></code> sweep grid.</p></li>
<li><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Optional leave-one-study-out metrics aggregated by feature/study.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Ordered set of feature spaces included in the bundle.</p></li>
<li><p><strong>sentence_model</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – SentenceTransformer model name when reports include that feature space.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Whether missing sweeps are tolerated when rendering summaries.</p></li>
<li><p><strong>include_next_video</strong> (<em>bool</em>) – Flag indicating whether slate sections should be generated.</p></li>
<li><p><strong>include_opinion</strong> (<em>bool</em>) – Flag indicating whether opinion sections should be generated.</p></li>
<li><p><strong>include_opinion_from_next</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.feature_spaces">
<span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('tfidf',</span> <span class="pre">'word2vec',</span> <span class="pre">'sentence_transformer')</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.feature_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.include_next_video">
<span class="sig-name descname"><span class="pre">include_next_video</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.include_next_video" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.include_opinion">
<span class="sig-name descname"><span class="pre">include_opinion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.include_opinion" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.include_opinion_from_next">
<span class="sig-name descname"><span class="pre">include_opinion_from_next</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.include_opinion_from_next" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.k_sweep">
<span class="sig-name descname"><span class="pre">k_sweep</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.k_sweep" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.loso_metrics">
<span class="sig-name descname"><span class="pre">loso_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.loso_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.metrics_by_feature">
<span class="sig-name descname"><span class="pre">metrics_by_feature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.metrics_by_feature" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_from_next_metrics">
<span class="sig-name descname"><span class="pre">opinion_from_next_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_from_next_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_from_next_predictions_root">
<span class="sig-name descname"><span class="pre">opinion_from_next_predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_from_next_predictions_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_metrics">
<span class="sig-name descname"><span class="pre">opinion_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_predictions_root">
<span class="sig-name descname"><span class="pre">opinion_predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_predictions_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_selections">
<span class="sig-name descname"><span class="pre">opinion_selections</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><span class="pre">knn.pipeline.context.OpinionStudySelection</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_selections" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_sweep_outcomes">
<span class="sig-name descname"><span class="pre">opinion_sweep_outcomes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><span class="pre">knn.pipeline.context.OpinionSweepOutcome</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.selections">
<span class="sig-name descname"><span class="pre">selections</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><span class="pre">knn.pipeline.context.StudySelection</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.selections" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.sentence_model">
<span class="sig-name descname"><span class="pre">sentence_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.sentence_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.studies">
<span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><span class="pre">common.pipeline.models.StudySpec</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.sweep_outcomes">
<span class="sig-name descname"><span class="pre">sweep_outcomes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><span class="pre">knn.pipeline.context.SweepOutcome</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySelection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">StudySelection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#StudySelection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.StudySelection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.pipeline.types.StudySelection</span></code>[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context.SweepOutcome</span></code></a>]</p>
<p>Selected configuration for a specific study within a feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>) – Study metadata chosen for final evaluation.</p></li>
<li><p><strong>outcome</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>) – Winning sweep outcome promoted for the study.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySelection.accuracy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.StudySelection.accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Return the held-out accuracy achieved by the selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a>) – Selection exposing the chosen sweep outcome.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the held-out accuracy achieved by the selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySelection.best_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.StudySelection.best_k" title="Link to this definition">¶</a></dt>
<dd><p>Return the optimal <code class="docutils literal notranslate"><span class="pre">k</span></code> discovered during sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a>) – Selection exposing the chosen sweep outcome.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the optimal <code class="docutils literal notranslate"><span class="pre">k</span></code> discovered during sweeps</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySpec">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">StudySpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/pipeline/models.html#StudySpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.StudySpec" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Participant study metadata shared across pipeline packages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>label</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySpec.evaluation_slug">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluation_slug</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.StudySpec.evaluation_slug" title="Link to this definition">¶</a></dt>
<dd><p>Return the slug used when saving evaluation artefacts.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySpec.issue">
<span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.StudySpec.issue" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySpec.issue_slug">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">issue_slug</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.StudySpec.issue_slug" title="Link to this definition">¶</a></dt>
<dd><p>Return a filesystem-safe slug for the associated issue.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySpec.key">
<span class="sig-name descname"><span class="pre">key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.StudySpec.key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySpec.label">
<span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.StudySpec.label" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySpec.study_slug">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">study_slug</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.StudySpec.study_slug" title="Link to this definition">¶</a></dt>
<dd><p>Return a filesystem-safe slug for the study key.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_min_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#SweepConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Describe a single hyper-parameter configuration scheduled for execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (<code class="docutils literal notranslate"><span class="pre">tfidf</span></code>, <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>,
or <code class="docutils literal notranslate"><span class="pre">sentence_transformer</span></code>).</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Distance metric passed to the KNN scorer (<code class="docutils literal notranslate"><span class="pre">l2</span></code> or <code class="docutils literal notranslate"><span class="pre">cosine</span></code>).</p></li>
<li><p><strong>text_fields</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Additional text columns merged into the viewer prompt.</p></li>
<li><p><strong>word2vec_size</strong> (<em>int</em><em> | </em><em>None</em>) – Word2Vec embedding dimensionality when the feature space is <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>.</p></li>
<li><p><strong>word2vec_window</strong> (<em>int</em><em> | </em><em>None</em>) – Word2Vec context window size for training.</p></li>
<li><p><strong>word2vec_min_count</strong> (<em>int</em><em> | </em><em>None</em>) – Minimum token frequency retained in the Word2Vec vocabulary.</p></li>
<li><p><strong>word2vec_epochs</strong> (<em>int</em><em> | </em><em>None</em>) – Number of epochs used when (re)training the Word2Vec model.</p></li>
<li><p><strong>word2vec_workers</strong> (<em>int</em><em> | </em><em>None</em>) – Worker count for Word2Vec training/encoding.</p></li>
<li><p><strong>sentence_transformer_model</strong> (<em>str</em><em> | </em><em>None</em>) – SentenceTransformer model identifier evaluated for this sweep.</p></li>
<li><p><strong>sentence_transformer_device</strong> (<em>str</em><em> | </em><em>None</em>) – Device override applied when encoding sentence embeddings.</p></li>
<li><p><strong>sentence_transformer_batch_size</strong> (<em>int</em><em> | </em><em>None</em>) – Batch size used when generating sentence embeddings.</p></li>
<li><p><strong>sentence_transformer_normalize</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether embeddings are L2-normalised prior to similarity scoring.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.cli_args">
<span class="sig-name descname"><span class="pre">cli_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#SweepConfig.cli_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepConfig.cli_args" title="Link to this definition">¶</a></dt>
<dd><p>Translate the configuration into CLI arguments understood by <a class="reference internal" href="#module-knn.cli" title="knn.cli"><code class="xref py py-mod docutils literal notranslate"><span class="pre">knn.cli</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>word2vec_model_dir</strong> (<em>Path</em><em> | </em><em>None</em>) – Directory housing cached Word2Vec models to reuse during sweeps.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Argument vector providing the minimal overrides required to reproduce the configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If mandatory Word2Vec parameters are omitted for a Word2Vec sweep.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.label">
<span class="sig-name descname"><span class="pre">label</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#SweepConfig.label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepConfig.label" title="Link to this definition">¶</a></dt>
<dd><p>Create a filesystem-friendly identifier summarising the configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a>) – Configuration instance being labelled.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Underscore-delimited label that highlights metric, text fields, and model specifics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.metric" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_batch_size">
<span class="sig-name descname"><span class="pre">sentence_transformer_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_device">
<span class="sig-name descname"><span class="pre">sentence_transformer_device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_model">
<span class="sig-name descname"><span class="pre">sentence_transformer_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_normalize">
<span class="sig-name descname"><span class="pre">sentence_transformer_normalize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_normalize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.text_fields">
<span class="sig-name descname"><span class="pre">text_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.text_fields" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_epochs">
<span class="sig-name descname"><span class="pre">word2vec_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_epochs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_min_count">
<span class="sig-name descname"><span class="pre">word2vec_min_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_min_count" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_size">
<span class="sig-name descname"><span class="pre">word2vec_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_window">
<span class="sig-name descname"><span class="pre">word2vec_window</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_window" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_workers">
<span class="sig-name descname"><span class="pre">word2vec_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepOutcome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eligible</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#SweepOutcome"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepOutcome" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.pipeline.types.BasePipelineSweepOutcome</span></code>[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context.SweepConfig</span></code></a>]</p>
<p>Persisted metrics for evaluating a configuration against a single study.</p>
<p>Extends <code class="xref py py-class docutils literal notranslate"><span class="pre">common.pipeline.types.BasePipelineSweepOutcome</span></code> with
feature-space metadata and KNN-specific evaluation statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space evaluated by the sweep run.</p></li>
<li><p><strong>accuracy</strong> (<em>float</em>) – Held-out accuracy achieved on the validation split.</p></li>
<li><p><strong>best_k</strong> (<em>int</em>) – Optimal neighbour count determined for the study.</p></li>
<li><p><strong>eligible</strong> (<em>int</em>) – Number of evaluation rows contributing to the metrics.</p></li>
<li><p><strong>order_index</strong> (<em>int</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a>)</p></li>
<li><p><strong>config</strong> (<em>common.pipeline.types.ConfigT</em>)</p></li>
<li><p><strong>metrics_path</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.accuracy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.best_k">
<span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.best_k" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.eligible">
<span class="sig-name descname"><span class="pre">eligible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.eligible" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue_slug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_participant_studies=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#SweepTask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepTask" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseSweepTask</span></code>[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SweepConfig</span></code></a>]</p>
<p>Extend <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseSweepTask</span></code> with KNN metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word2vec_model_dir</strong> (<em>Path</em><em> | </em><em>None</em>) – Optional directory providing cached Word2Vec models.</p></li>
<li><p><strong>issue</strong> (<em>str</em>) – Human-readable issue label aligned with the study.</p></li>
<li><p><strong>issue_slug</strong> (<em>str</em>) – Normalised slug used for filesystem naming.</p></li>
<li><p><strong>train_participant_studies</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Participant study keys used for training.</p></li>
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a>)</p></li>
<li><p><strong>config</strong> (<em>common.opinion.sweep_types.ConfigT</em>)</p></li>
<li><p><strong>base_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>extra_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>run_root</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>metrics_path</strong> (<em>pathlib.Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask.issue">
<span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTask.issue" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask.issue_slug">
<span class="sig-name descname"><span class="pre">issue_slug</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTask.issue_slug" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask.train_participant_studies">
<span class="sig-name descname"><span class="pre">train_participant_studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepTask.train_participant_studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask.word2vec_model_dir">
<span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTask.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepTaskContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_base</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context.html#SweepTaskContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared CLI/runtime parameters required to materialise sweep tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Baseline CLI arguments applied to each sweep invocation.</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Additional CLI arguments appended to the baseline invocation.</p></li>
<li><p><strong>sweep_dir</strong> (<em>Path</em>) – Root directory where sweep artefacts are written.</p></li>
<li><p><strong>word2vec_model_base</strong> (<em>Path</em>) – Directory storing cached Word2Vec artefacts.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.base_cli">
<span class="sig-name descname"><span class="pre">base_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.base_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.extra_cli">
<span class="sig-name descname"><span class="pre">extra_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.extra_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.sweep_dir">
<span class="sig-name descname"><span class="pre">sweep_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.sweep_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.word2vec_model_base">
<span class="sig-name descname"><span class="pre">word2vec_model_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.word2vec_model_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline.data">Study metadata helpers used by the Grail Simulation KNN pipeline.</p>
<p>Provides canonical participant-study specifications plus helper functions
for interpreting CLI tokens and mapping them onto pipeline studies.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.issue_slug_for_study">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">issue_slug_for_study</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#issue_slug_for_study"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.issue_slug_for_study" title="Link to this definition">¶</a></dt>
<dd><p>Derive the filesystem slug used for artefacts associated with <code class="docutils literal notranslate"><span class="pre">study</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>) – Study specification providing issue/study slugs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated issue and study slug (e.g. <code class="docutils literal notranslate"><span class="pre">issue_study</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.resolve_studies">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">resolve_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#resolve_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.resolve_studies" title="Link to this definition">¶</a></dt>
<dd><p>Return participant studies matching <code class="docutils literal notranslate"><span class="pre">tokens</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tokens</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Iterable of study keys or issue names received from the CLI.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list of study specifications corresponding to the provided tokens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.study_specs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">study_specs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#study_specs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.study_specs" title="Link to this definition">¶</a></dt>
<dd><p>Return the canonical participant-study specifications bundled with the project.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of opinion-study descriptors used for sweeps and reporting.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.warn_if_issue_tokens_used">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">warn_if_issue_tokens_used</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#warn_if_issue_tokens_used"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.warn_if_issue_tokens_used" title="Link to this definition">¶</a></dt>
<dd><p>Log a gentle reminder that <code class="docutils literal notranslate"><span class="pre">--issues</span></code> is deprecated for the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>argparse.Namespace</em>) – Parsed CLI namespace to inspect for deprecated <code class="docutils literal notranslate"><span class="pre">--issues</span></code> usage.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.evaluate">Evaluation runners for the Grail Simulation KNN pipeline.</p>
<p>Wraps the KNN CLI so orchestration code can execute final evaluations,
leave-one-study-out checks, and opinion regressions while respecting the
pipeline’s caching semantics.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.run_cross_study_evaluations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_cross_study_evaluations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/evaluate.html#run_cross_study_evaluations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.run_cross_study_evaluations" title="Link to this definition">¶</a></dt>
<dd><p>Run per-study evaluation sweeps grouped by feature space.</p>
<p>Historically this stage performed leave-one-study-out (LOSO) checks, but the
training split is now restricted to the holdout study to avoid cross-study mixtures.
This implementation supports reuse of cached metrics only (sufficient for tests).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>knn.pipeline.context.StudySelection</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>)</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><em>knn.pipeline.context.EvaluationContext</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Dict</em>[str, <em>Dict</em>[str, <em>Mapping</em>[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.run_final_evaluations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_final_evaluations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/evaluate.html#run_final_evaluations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.run_final_evaluations" title="Link to this definition">¶</a></dt>
<dd><p>Run final slate evaluations and return metrics grouped by feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a><em>]</em><em>]</em>) – Winning sweep selections keyed by feature space and study key.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Ordered list of studies to evaluate.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><em>EvaluationContext</em></a>) – Shared CLI/runtime parameters used for all evaluations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study_key</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for the final evaluations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.run_opinion_evaluations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_opinion_evaluations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/evaluate.html#run_opinion_evaluations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.run_opinion_evaluations" title="Link to this definition">¶</a></dt>
<dd><p>Run opinion regression for each feature space and return metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a><em>]</em><em>]</em>) – Winning opinion selections keyed by feature space and study key.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Ordered list of opinion studies to evaluate.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><em>EvaluationContext</em></a>) – Shared CLI/runtime parameters used for all evaluations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study_key</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for the opinion evaluations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.io">Filesystem helpers for the Grail Simulation KNN pipeline.</p>
<p>Encapsulates loading of sweep and evaluation metrics so orchestration code
can rebuild report bundles without re-executing the pipeline stages.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_final_metrics_from_disk">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_final_metrics_from_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_final_metrics_from_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_final_metrics_from_disk" title="Link to this definition">¶</a></dt>
<dd><p>Load slate metrics written by prior runs instead of recomputing them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>Path</em>) – Directory where per-feature-space results are persisted.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Iterable of feature space names to inspect.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Studies to look up within each feature directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for all cached
results found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_loso_metrics_from_disk">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_loso_metrics_from_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_loso_metrics_from_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_loso_metrics_from_disk" title="Link to this definition">¶</a></dt>
<dd><p>Load leave-one-study-out metrics produced by previous pipeline runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>Path</em>) – Directory containing persisted evaluation artefacts.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Feature space configurations to inspect for cached
LOSO runs.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Studies that were treated as hold-outs in the LOSO evaluation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for every cached
LOSO evaluation located.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue_slug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Load the evaluation metrics JSON for a specific study/issue from <code class="docutils literal notranslate"><span class="pre">run_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_dir</strong> (<em>Path</em>) – Directory containing per-issue subdirectories with metrics artefacts.</p></li>
<li><p><strong>issue_slug</strong> (<em>str</em>) – Issue slug used to locate the metrics file on disk.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the parsed metrics payload and the filesystem path used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Mapping[str, object], Path]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If the expected metrics file does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_opinion_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_opinion_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_opinion_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_opinion_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Collect opinion-task metrics for every study under <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>Path</em>) – Root directory containing opinion evaluation artefacts.</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (e.g. <code class="docutils literal notranslate"><span class="pre">tfidf</span></code> or <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>)
used to scope the search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping keyed by study slug with the deserialised metrics dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Mapping[str, object]]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.opinion_sweeps">Opinion sweep orchestration helpers extracted from <code class="docutils literal notranslate"><span class="pre">pipeline_sweeps</span></code>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.build_opinion_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">build_opinion_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#build_opinion_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.build_opinion_task" title="Link to this definition">¶</a></dt>
<dd><p>Expose the opinion sweep task builder for use in tests and external callers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A configured opinion sweep task matching the supplied arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>knn.pipeline.context.SweepConfig</em></a>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a>)</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>knn.pipeline.context.SweepTaskContext</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.execute_opinion_sweep_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">cli_runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#execute_opinion_sweep_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_task" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single opinion sweep task and return the captured metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Individual sweep task describing an execution unit.</p></li>
<li><p><strong>cli_runner</strong> (<em>CliRunner</em>) – Callable used to invoke the CLI for the opinion sweep.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcome produced by executing the given task.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – Raised when a Word2Vec task omits the model directory.</p></li>
<li><p><strong>FileNotFoundError</strong> – Raised if the metrics artefact is missing post-run.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.execute_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cli_runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#execute_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Run the supplied opinion sweep tasks, optionally in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a><em>]</em>) – Collection of sweep tasks scheduled for execution.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers allowed.</p></li>
<li><p><strong>cli_runner</strong> (<em>CliRunner</em>) – Callable used to invoke the CLI for each task.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcomes generated from the provided tasks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.format_opinion_sweep_task_descriptor">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">format_opinion_sweep_task_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#format_opinion_sweep_task_descriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.format_opinion_sweep_task_descriptor" title="Link to this definition">¶</a></dt>
<dd><p>Return a short descriptor for an opinion sweep task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-readable descriptor combining feature space, study, and label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.merge_opinion_sweep_outcomes">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">merge_opinion_sweep_outcomes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#merge_opinion_sweep_outcomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.merge_opinion_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Combine cached and freshly executed opinion outcomes while preserving order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cached</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Previously computed artefacts available for reuse.</p></li>
<li><p><strong>executed</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Outcomes produced during the current run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list comprising cached results first and overwriting duplicates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.opinion_sweep_outcome_from_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">opinion_sweep_outcome_from_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#opinion_sweep_outcome_from_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.opinion_sweep_outcome_from_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Translate cached opinion metrics into an <code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionSweepOutcome</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Sweep task describing the execution unit that produced the metrics.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
<li><p><strong>metrics_path</strong> (<em>pathlib.Path</em>) – Filesystem path where the metrics JSON artefact resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcome reconstructed from cached metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.prepare_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">prepare_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#prepare_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.prepare_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Return tasks that require execution alongside cached sweep outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Hyper-parameter sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, reuse cached results instead of recomputing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tasks pending execution and outcomes reconstructed from cache.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>],
List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.select_best_opinion_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">select_best_opinion_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#select_best_opinion_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.select_best_opinion_configs" title="Link to this definition">¶</a></dt>
<dd><p>Select the best configuration per feature space and study for opinion sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Sweep outcomes available for aggregation.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Continue when some sweep data is missing if <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to their selected opinion configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, <a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a>]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when mandatory selections are missing and <code class="docutils literal notranslate"><span class="pre">allow_incomplete</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.sweeps">Sweep orchestration helpers for the Grail Simulation KNN pipeline.</p>
<p>Builds hyper-parameter grids, prepares CLI invocations, executes sweep
tasks for next-video and opinion runs, and merges cached metrics so later
stages can select the best configurations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.build_opinion_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">build_opinion_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#build_opinion_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.build_opinion_task" title="Link to this definition">¶</a></dt>
<dd><p>Expose the opinion sweep task builder for use in tests and external callers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A configured opinion sweep task matching the supplied arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>knn.pipeline.context.SweepConfig</em></a>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a>)</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>knn.pipeline.context.SweepTaskContext</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.build_sweep_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">build_sweep_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#build_sweep_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.build_sweep_configs" title="Link to this definition">¶</a></dt>
<dd><p>Return the grid of configurations evaluated during sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a>) – Pipeline context encapsulating dataset paths and configuration flags.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the grid of configurations evaluated during sweeps</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.emit_combined_sweep_plan">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">emit_combined_sweep_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">slate_tasks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_tasks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#emit_combined_sweep_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.emit_combined_sweep_plan" title="Link to this definition">¶</a></dt>
<dd><p>Print a combined sweep plan covering next-video and opinion tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slate_tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a><em>]</em>) – Slate sweep tasks prepared for execution.</p></li>
<li><p><strong>opinion_tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a><em>]</em>) – Opinion sweep tasks queued for execution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.emit_sweep_plan">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">emit_sweep_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#emit_sweep_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.emit_sweep_plan" title="Link to this definition">¶</a></dt>
<dd><p>Print a human-readable sweep plan for next-video tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a><em>]</em>) – Collection of sweep tasks scheduled for execution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_opinion_sweep_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_opinion_sweep_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_opinion_sweep_task" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single opinion sweep task using the shared CLI runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>knn.pipeline.context.OpinionSweepTask</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome">knn.pipeline.context.OpinionSweepOutcome</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Run the supplied opinion sweep tasks via the shared CLI runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a><em>]</em>) – Opinion sweep tasks scheduled for execution.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list of opinion sweep outcomes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_sweep_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_sweep_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_sweep_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_sweep_task" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single sweep task and return the captured metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Slate sweep outcome produced by executing the given task.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Run the supplied sweep tasks (possibly in parallel).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a><em>]</em>) – Collection of sweep tasks scheduled for execution.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers to schedule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of slate sweep outcomes generated from the provided tasks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.format_opinion_sweep_task_descriptor">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">format_opinion_sweep_task_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#format_opinion_sweep_task_descriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.format_opinion_sweep_task_descriptor" title="Link to this definition">¶</a></dt>
<dd><p>Return a short descriptor for an opinion sweep task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-readable descriptor combining feature space, study, and label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.format_sweep_task_descriptor">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">format_sweep_task_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#format_sweep_task_descriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.format_sweep_task_descriptor" title="Link to this definition">¶</a></dt>
<dd><p>Return a short descriptor for a sweep task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a short descriptor for a sweep task</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.merge_opinion_sweep_outcomes">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">merge_opinion_sweep_outcomes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#merge_opinion_sweep_outcomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.merge_opinion_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Combine cached and freshly executed opinion outcomes while preserving order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cached</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Previously computed artefacts available for reuse.</p></li>
<li><p><strong>executed</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Outcomes produced during the current run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list comprising cached results first and overwriting duplicates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.merge_sweep_outcomes">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">merge_sweep_outcomes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#merge_sweep_outcomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.merge_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Combine cached and freshly executed sweep outcomes preserving order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cached</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a><em>]</em>) – Previously computed artefacts available for reuse.</p></li>
<li><p><strong>executed</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a><em>]</em>) – Iterable of tasks that were actually executed during the run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to merged slate sweep outcomes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.opinion_sweep_outcome_from_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">opinion_sweep_outcome_from_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#opinion_sweep_outcome_from_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.opinion_sweep_outcome_from_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Translate cached opinion metrics into an <code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionSweepOutcome</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Sweep task describing the execution unit that produced the metrics.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
<li><p><strong>metrics_path</strong> (<em>pathlib.Path</em>) – Filesystem path where the metrics JSON artefact resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcome reconstructed from cached metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.prepare_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">prepare_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#prepare_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.prepare_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Return tasks that require execution alongside cached sweep outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Hyper-parameter sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, reuse cached results instead of recomputing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tasks pending execution and outcomes reconstructed from cache.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>],
List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.prepare_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">prepare_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#prepare_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.prepare_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Return next-video sweep tasks requiring execution and cached outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Iterable of sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Whether to reuse cached results instead of recomputing them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>next-video sweep tasks requiring execution and cached outcomes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>], List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.run_knn_cli">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">run_knn_cli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#run_knn_cli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.run_knn_cli" title="Link to this definition">¶</a></dt>
<dd><p>Execute the KNN CLI entry point with <code class="docutils literal notranslate"><span class="pre">argv</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Optional argument vector override used when invoking the CLI programmatically.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.run_sweeps">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">run_sweeps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#run_sweeps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.run_sweeps" title="Link to this definition">¶</a></dt>
<dd><p>Execute hyper-parameter sweeps and collect per-run metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Iterable of sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Whether to reuse cached results instead of recomputing them.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers to schedule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing slate tasks, opinion tasks, and any cached sweep outcomes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.select_best_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">select_best_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#select_best_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.select_best_configs" title="Link to this definition">¶</a></dt>
<dd><p>Select the best configuration per feature space and study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a><em>]</em>) – Iterable of sweep outcomes available for aggregation.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Whether processing may continue when some sweep data is missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to their selected slate configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, <a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.select_best_opinion_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">select_best_opinion_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#select_best_opinion_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.select_best_opinion_configs" title="Link to this definition">¶</a></dt>
<dd><p>Select the best configuration per feature space and study for opinion sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Sweep outcomes available for aggregation.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Continue when some sweep data is missing if <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to their selected opinion configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, <a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a>]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when mandatory selections are missing and <code class="docutils literal notranslate"><span class="pre">allow_incomplete</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.sweep_outcome_from_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">sweep_outcome_from_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#sweep_outcome_from_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.sweep_outcome_from_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Translate cached metrics into a <code class="xref py py-class docutils literal notranslate"><span class="pre">SweepOutcome</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>) – Individual sweep task describing an execution unit.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
<li><p><strong>metrics_path</strong> (<em>Path</em>) – Filesystem path where the metrics JSON artefact resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Slate sweep outcome reconstructed from cached metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.utils">Utility helpers shared by the Grail Simulation KNN pipeline stages.</p>
<p>Collects small formatting utilities, filesystem helpers, and conversions
from raw metric payloads into structured summaries used by the reports.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">SelectionValidationOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_descriptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_descriptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_selected</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#SelectionValidationOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reusable configuration for selection validation helpers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allow_incomplete</strong> (<em>bool</em>)</p></li>
<li><p><strong>logger</strong> (<em>Any</em>)</p></li>
<li><p><strong>missing_descriptor</strong> (<em>str</em>)</p></li>
<li><p><strong>empty_descriptor</strong> (<em>str</em>)</p></li>
<li><p><strong>require_selected</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.empty_descriptor">
<span class="sig-name descname"><span class="pre">empty_descriptor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.empty_descriptor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.logger" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.missing_descriptor">
<span class="sig-name descname"><span class="pre">missing_descriptor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.missing_descriptor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.require_selected">
<span class="sig-name descname"><span class="pre">require_selected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.require_selected" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.utils.TaskCacheStrategy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">TaskCacheStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#TaskCacheStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.TaskCacheStrategy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">knn.pipeline.utils.TaskT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">knn.pipeline.utils.OutcomeT</span></code>]</p>
<p>Bundle describing how cached tasks are discovered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_cached</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em> | </em><em>None</em><em>]</em>)</p></li>
<li><p><strong>cache_path</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>pathlib.Path</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.TaskCacheStrategy.cache_path">
<span class="sig-name descname"><span class="pre">cache_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">knn.pipeline.utils.TaskT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.utils.TaskCacheStrategy.cache_path" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.TaskCacheStrategy.load_cached">
<span class="sig-name descname"><span class="pre">load_cached</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">knn.pipeline.utils.TaskT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">knn.pipeline.utils.OutcomeT</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.utils.TaskCacheStrategy.load_cached" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_dir">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_dir" title="Link to this definition">¶</a></dt>
<dd><p>Ensure the given directory exists and return it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>Path</em>) – Directory path that should be created if missing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The original <code class="docutils literal notranslate"><span class="pre">Path</span></code> instance for convenient chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_feature_selections">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_feature_selections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_keys</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_feature_selections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_feature_selections" title="Link to this definition">¶</a></dt>
<dd><p>Validate that <code class="docutils literal notranslate"><span class="pre">selections</span></code> covers all <code class="docutils literal notranslate"><span class="pre">expected_keys</span></code> for each feature space.</p>
<p>Emits a warning when <code class="docutils literal notranslate"><span class="pre">allow_incomplete</span></code> is set and some studies are missing.
Raises <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> when data is missing and incomplete results are not allowed.
If <code class="docutils literal notranslate"><span class="pre">require_selected</span></code> is true and no selections were recorded, a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>
is raised to signal the failure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>expected_keys</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions" title="knn.pipeline.utils.SelectionValidationOptions"><em>knn.pipeline.utils.SelectionValidationOptions</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_opinion_selection_coverage">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_opinion_selection_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_selected</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_opinion_selection_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_opinion_selection_coverage" title="Link to this definition">¶</a></dt>
<dd><p>Validate coverage for opinion sweep selections with custom descriptors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>)</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>)</p></li>
<li><p><strong>logger</strong> (<em>Any</em>)</p></li>
<li><p><strong>require_selected</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_selection_coverage">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_selection_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_selection_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_selection_coverage" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper that reuses <a class="reference internal" href="#knn.pipeline.utils.ensure_feature_selections" title="knn.pipeline.utils.ensure_feature_selections"><code class="xref py py-func docutils literal notranslate"><span class="pre">ensure_feature_selections()</span></code></a> for common call sites.</p>
<p>Derives the expected study keys from <code class="docutils literal notranslate"><span class="pre">studies</span></code> to avoid repeating the same
boilerplate whenever we validate sweep selections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>)</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions" title="knn.pipeline.utils.SelectionValidationOptions"><em>knn.pipeline.utils.SelectionValidationOptions</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_sweep_selection_coverage">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_sweep_selection_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_selected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_sweep_selection_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_sweep_selection_coverage" title="Link to this definition">¶</a></dt>
<dd><p>Validate coverage for the core sweep selections produced by the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>)</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>)</p></li>
<li><p><strong>logger</strong> (<em>Any</em>)</p></li>
<li><p><strong>require_selected</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.extract_metric_summary">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">extract_metric_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#extract_metric_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.extract_metric_summary" title="Link to this definition">¶</a></dt>
<dd><p>Collect reusable next-video metric fields from <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Raw metrics dictionary emitted by the evaluation stage.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalised metric summary for downstream reports.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.MetricSummary" title="knn.pipeline.context.MetricSummary">MetricSummary</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.extract_opinion_summary">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">extract_opinion_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#extract_opinion_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.extract_opinion_summary" title="Link to this definition">¶</a></dt>
<dd><p>Collect opinion regression metrics into a normalised structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Raw metrics dictionary emitted by the opinion pipeline.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalised opinion summary for reporting.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSummary" title="knn.pipeline.context.OpinionSummary"><em>OpinionSummary</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_count">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_count" title="Link to this definition">¶</a></dt>
<dd><p>Format integer counts with thousands separators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Count to render.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted count or an em dash when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_delta">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_delta" title="Link to this definition">¶</a></dt>
<dd><p>Format a signed improvement metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>delta</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Change relative to a baseline.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Signed string (<code class="docutils literal notranslate"><span class="pre">+0.000</span></code> style) or an em dash when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_float">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_float" title="Link to this definition">¶</a></dt>
<dd><p>Format a floating-point metric with three decimal places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>float</em>) – Numeric metric to render.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted string (<code class="docutils literal notranslate"><span class="pre">{value:.3f}</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_k">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_k" title="Link to this definition">¶</a></dt>
<dd><p>Format the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> hyper-parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Neighbourhood size under consideration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>String representation of <code class="docutils literal notranslate"><span class="pre">k</span></code> or an em dash when unset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_optional_float">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_optional_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_optional_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_optional_float" title="Link to this definition">¶</a></dt>
<dd><p>Format an optional floating-point metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Metric value or <code class="docutils literal notranslate"><span class="pre">None</span></code> when unavailable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted float or an em dash when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_uncertainty_details">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_uncertainty_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_uncertainty_details"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_uncertainty_details" title="Link to this definition">¶</a></dt>
<dd><p>Format auxiliary uncertainty metadata for reporting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>uncertainty</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Mapping containing extra uncertainty fields.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parenthesised detail string or an empty string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.handle_cached_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">handle_cached_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#handle_cached_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.handle_cached_task" title="Link to this definition">¶</a></dt>
<dd><p>Append <code class="docutils literal notranslate"><span class="pre">task</span></code> to the <code class="docutils literal notranslate"><span class="pre">partition</span></code> unless a cached outcome can be reused.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> when a cached outcome was appended and the caller should skip execution.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>task</strong> (<em>knn.pipeline.utils.TaskT</em>)</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>)</p></li>
<li><p><strong>cache_path</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>load_cached</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em> | </em><em>None</em><em>]</em>)</p></li>
<li><p><strong>partition</strong> (<em>knn.pipeline.utils.TaskCachePartition</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.parse_ci">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">parse_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#parse_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.parse_ci" title="Link to this definition">¶</a></dt>
<dd><p>Convert confidence-interval payloads into numeric tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ci_value</strong> (<em>object</em>) – Mapping or sequence describing a confidence interval.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing <code class="docutils literal notranslate"><span class="pre">(low,</span> <span class="pre">high)</span></code> bounds when available.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[float, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.partition_cached_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">partition_cached_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_cached</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#partition_cached_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.partition_cached_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Split <code class="docutils literal notranslate"><span class="pre">tasks</span></code> into pending work and cached results.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing pending task list and cached outcomes respectively.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Iterable</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em>)</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>)</p></li>
<li><p><strong>cache_path</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>pathlib.Path</em><em>]</em>)</p></li>
<li><p><strong>load_cached</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em> | </em><em>None</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[knn.pipeline.utils.TaskT], <em>List</em>[knn.pipeline.utils.OutcomeT]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.prepare_task_grid">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">prepare_task_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#prepare_task_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.prepare_task_grid" title="Link to this definition">¶</a></dt>
<dd><p>Construct sweep task grid and partition cached outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><em>Any</em><em>]</em>) – Hyper-parameter configurations included in the sweep.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>Any</em><em>]</em>) – Study specifications evaluated by the sweep.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Whether cached metrics should be reused.</p></li>
<li><p><strong>build_task</strong> (<em>Callable</em><em>[</em><em>[</em><em>int</em><em>, </em><em>Any</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>TaskT</em><em>]</em>) – Callable that constructs a task for the given index, config, and study.</p></li>
<li><p><strong>cache</strong> (<a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy" title="knn.pipeline.utils.TaskCacheStrategy"><em>TaskCacheStrategy</em></a><em>[</em><em>TaskT</em><em>, </em><em>OutcomeT</em><em>]</em>) – Strategy describing how cached outcomes are located and loaded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pending tasks and cached outcomes separated according to <code class="docutils literal notranslate"><span class="pre">reuse_existing</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[TaskT], List[OutcomeT]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.safe_float">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">safe_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/pipeline/formatters.html#safe_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.safe_float" title="Link to this definition">¶</a></dt>
<dd><p>Attempt to convert <code class="docutils literal notranslate"><span class="pre">value</span></code> to <code class="docutils literal notranslate"><span class="pre">float</span></code> returning <code class="docutils literal notranslate"><span class="pre">None</span></code> on failure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>object</em>) – Candidate value to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float representation or <code class="docutils literal notranslate"><span class="pre">None</span></code> when conversion fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.safe_int">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">safe_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/pipeline/formatters.html#safe_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.safe_int" title="Link to this definition">¶</a></dt>
<dd><p>Best-effort conversion to int.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>object</em>) – Value provided for <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result produced by <code class="docutils literal notranslate"><span class="pre">safe_int</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.snake_to_title">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">snake_to_title</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#snake_to_title"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.snake_to_title" title="Link to this definition">¶</a></dt>
<dd><p>Convert a <code class="docutils literal notranslate"><span class="pre">snake_case</span></code> string into Title Case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – String containing underscore-separated tokens.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Title-cased string with spaces instead of underscores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.pipeline.reports">
<span id="report-builders"></span><h2>Report Builders<a class="headerlink" href="#module-knn.pipeline.reports" title="Link to this heading">¶</a></h2>
<p>Public entry points for the KNN pipeline report builders.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.generate_reports">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.</span></span><span class="sig-name descname"><span class="pre">generate_reports</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bundle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports.html#generate_reports"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.generate_reports" title="Link to this definition">¶</a></dt>
<dd><p>Write refreshed Markdown reports under <code class="docutils literal notranslate"><span class="pre">reports/knn</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_root</strong> (<em>Path</em>) – Repository root directory used for path resolution.</p></li>
<li><p><strong>report_bundle</strong> (<a class="reference internal" href="#knn.pipeline.context.ReportBundle" title="knn.pipeline.context.ReportBundle"><em>ReportBundle</em></a>) – Aggregated data structure containing everything needed to emit reports.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.catalog">Catalog README builder for the KNN pipeline reports.</p>
<p id="module-knn.pipeline.reports.features">Report builders summarising the extra text fields used by KNN pipelines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.features.build_feature_report">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.features.</span></span><span class="sig-name descname"><span class="pre">build_feature_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/features.html#build_feature_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.features.build_feature_report" title="Link to this definition">¶</a></dt>
<dd><p>Write the KNN additional-feature markdown report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_root</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>bundle</strong> (<a class="reference internal" href="#knn.pipeline.context.ReportBundle" title="knn.pipeline.context.ReportBundle"><em>knn.pipeline.context.ReportBundle</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.hyperparameter">Builders for the KNN hyper-parameter Markdown reports.</p>
<p id="module-knn.pipeline.reports.next_video">Modular next-video report builders used by the KNN reporting pipeline.</p>
<p id="module-knn.pipeline.reports.opinion">Opinion report builders for the modular KNN pipeline.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionReportOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regenerate_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asset_subdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'opinion'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/opinion.html#OpinionReportOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bundle of optional parameters for building the opinion report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, allow placeholder output when metrics are missing.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Markdown title inserted at the top of the report.</p></li>
<li><p><strong>description_lines</strong> (<em>Optional</em><em>[</em><em>Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Optional Markdown description beneath the title.</p></li>
<li><p><strong>metrics_line</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Optional override for the metrics summary bullet.</p></li>
<li><p><strong>predictions_root</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – Root directory containing cached opinion predictions.</p></li>
<li><p><strong>regenerate_plots</strong> (<em>bool</em>) – Rebuild matplotlib artefacts before emitting the report.</p></li>
<li><p><strong>asset_subdir</strong> (<em>str</em>) – Subdirectory name used when storing plot artefacts.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.asset_subdir">
<span class="sig-name descname"><span class="pre">asset_subdir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'opinion'</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.asset_subdir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.description_lines">
<span class="sig-name descname"><span class="pre">description_lines</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.description_lines" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.metrics_line">
<span class="sig-name descname"><span class="pre">metrics_line</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.metrics_line" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.predictions_root">
<span class="sig-name descname"><span class="pre">predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.predictions_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.regenerate_plots">
<span class="sig-name descname"><span class="pre">regenerate_plots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.regenerate_plots" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline.reports.shared">Shared helpers for the modular KNN report generation pipeline.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.shared.parse_k_sweep">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.shared.</span></span><span class="sig-name descname"><span class="pre">parse_k_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/shared.html#parse_k_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.shared.parse_k_sweep" title="Link to this definition">¶</a></dt>
<dd><p>Convert the stored <code class="docutils literal notranslate"><span class="pre">k</span></code> sweep representation into integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k_sweep</strong> (<em>str</em><em> | </em><em>Iterable</em><em>[</em><em>int</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[int, …]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.pipeline.reports.next_video.inputs">
<span id="next-video-report-internals"></span><h2>Next-Video Report Internals<a class="headerlink" href="#module-knn.pipeline.reports.next_video.inputs" title="Link to this heading">¶</a></h2>
<p>Structured inputs and helper accumulators for the next-video report.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.inputs.</span></span><span class="sig-name descname"><span class="pre">NextVideoReportInputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loso_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgb_next_video_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#NextVideoReportInputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Input bundle required to render the next-video report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>pathlib.Path</em>) – Destination directory where report artifacts are written.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of per-study metrics keyed by feature space.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications covered by the report.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Feature spaces in the order they should appear in the report.</p></li>
<li><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Optional leave-one-study-out metrics grouped by feature space.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Whether the report may emit placeholders when data is missing.</p></li>
<li><p><strong>xgb_next_video_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Root directory containing XGB comparison metrics, if any.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.feature_spaces">
<span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.feature_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.loso_metrics">
<span class="sig-name descname"><span class="pre">loso_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.loso_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.metrics_by_feature">
<span class="sig-name descname"><span class="pre">metrics_by_feature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.metrics_by_feature" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.output_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.studies">
<span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><span class="pre">common.pipeline.models.StudySpec</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.xgb_next_video_dir">
<span class="sig-name descname"><span class="pre">xgb_next_video_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.xgb_next_video_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.inputs.</span></span><span class="sig-name descname"><span class="pre">PortfolioAggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accuracy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eligible</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#PortfolioAggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Weighted portfolio metrics for a feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accuracy</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>baseline</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>random</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>eligible</strong> (<em>int</em>)</p></li>
<li><p><strong>studies</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.accuracy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.baseline">
<span class="sig-name descname"><span class="pre">baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.baseline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.eligible">
<span class="sig-name descname"><span class="pre">eligible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.eligible" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.random">
<span class="sig-name descname"><span class="pre">random</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.random" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.studies">
<span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._ObservationAccumulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.inputs.</span></span><span class="sig-name descname"><span class="pre">_ObservationAccumulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_sum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#_ObservationAccumulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Running statistics for qualitative observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta_sum</strong> (<em>float</em>)</p></li>
<li><p><strong>delta_count</strong> (<em>int</em>)</p></li>
<li><p><strong>random_sum</strong> (<em>float</em>)</p></li>
<li><p><strong>random_count</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._ObservationAccumulator.averages">
<span class="sig-name descname"><span class="pre">averages</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#_ObservationAccumulator.averages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.averages" title="Link to this definition">¶</a></dt>
<dd><p>Return formatted average statistics when available.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of formatted mean statistics (may be empty).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._ObservationAccumulator.delta_count">
<span class="sig-name descname"><span class="pre">delta_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.delta_count" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._ObservationAccumulator.delta_sum">
<span class="sig-name descname"><span class="pre">delta_sum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.delta_sum" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._ObservationAccumulator.random_count">
<span class="sig-name descname"><span class="pre">random_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.random_count" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._ObservationAccumulator.random_sum">
<span class="sig-name descname"><span class="pre">random_sum</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.random_sum" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._ObservationAccumulator.record">
<span class="sig-name descname"><span class="pre">record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#_ObservationAccumulator.record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.record" title="Link to this definition">¶</a></dt>
<dd><p>Update accumulated statistics with <code class="docutils literal notranslate"><span class="pre">summary</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>summary</strong> (<em>Any</em>) – Structured metric summary extracted from a study payload.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.inputs.</span></span><span class="sig-name descname"><span class="pre">_PortfolioAccumulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accuracy_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_total</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies_with_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#_PortfolioAccumulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mutable helper used to compute weighted aggregates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accuracy_total</strong> (<em>float</em>)</p></li>
<li><p><strong>accuracy_weight</strong> (<em>int</em>)</p></li>
<li><p><strong>baseline_total</strong> (<em>float</em>)</p></li>
<li><p><strong>baseline_weight</strong> (<em>int</em>)</p></li>
<li><p><strong>random_total</strong> (<em>float</em>)</p></li>
<li><p><strong>random_weight</strong> (<em>int</em>)</p></li>
<li><p><strong>studies_with_metrics</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.accuracy_total">
<span class="sig-name descname"><span class="pre">accuracy_total</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.accuracy_total" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.accuracy_weight">
<span class="sig-name descname"><span class="pre">accuracy_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.accuracy_weight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#_PortfolioAccumulator.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.add" title="Link to this definition">¶</a></dt>
<dd><p>Record weighted contributions from <code class="docutils literal notranslate"><span class="pre">summary</span></code> when eligible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>summary</strong> (<em>Any</em>) – Structured metric summary extracted from a study payload.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.baseline_total">
<span class="sig-name descname"><span class="pre">baseline_total</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.baseline_total" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.baseline_weight">
<span class="sig-name descname"><span class="pre">baseline_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.baseline_weight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.random_total">
<span class="sig-name descname"><span class="pre">random_total</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.random_total" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.random_weight">
<span class="sig-name descname"><span class="pre">random_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.random_weight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.result">
<span class="sig-name descname"><span class="pre">result</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#_PortfolioAccumulator.result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.result" title="Link to this definition">¶</a></dt>
<dd><p>Return the weighted aggregates accumulated so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Aggregated portfolio metrics, or <code class="docutils literal notranslate"><span class="pre">None</span></code> when nothing was recorded.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate" title="knn.pipeline.reports.next_video.inputs.PortfolioAggregate">knn.pipeline.reports.next_video.inputs.PortfolioAggregate</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.studies_with_metrics">
<span class="sig-name descname"><span class="pre">studies_with_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.studies_with_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline.reports.next_video.sections">Markdown section builders for the next-video report.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._aggregate_portfolio_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_aggregate_portfolio_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_aggregate_portfolio_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._aggregate_portfolio_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Compute weighted aggregate metrics across studies for a feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em>) – Study-level metrics for the feature space.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Weighted aggregates or None if no eligible studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate" title="knn.pipeline.reports.next_video.inputs.PortfolioAggregate">knn.pipeline.reports.next_video.inputs.PortfolioAggregate</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._format_ci">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_format_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_format_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._format_ci" title="Link to this definition">¶</a></dt>
<dd><p>Format a 95% confidence interval if present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ci_value</strong> (<em>object</em>) – Confidence-interval payload extracted from a metrics dictionary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-readable confidence-interval string formatted for Markdown tables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._next_video_dataset_info">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_next_video_dataset_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_next_video_dataset_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._next_video_dataset_info" title="Link to this definition">¶</a></dt>
<dd><p>Extract a representative dataset name and split from metrics payloads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of metrics grouped by feature space and study.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset name and split identifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str, str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._next_video_feature_section">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_next_video_feature_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_next_video_feature_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._next_video_feature_section" title="Link to this definition">¶</a></dt>
<dd><p>Render the next-video metrics table for <code class="docutils literal notranslate"><span class="pre">feature_space</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier such as <code class="docutils literal notranslate"><span class="pre">tfidf</span></code> or <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown section summarising next-video metrics for the feature space.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._next_video_intro">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_next_video_intro</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_next_video_intro"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._next_video_intro" title="Link to this definition">¶</a></dt>
<dd><p>Return the introductory Markdown section for the next-video report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<em>str</em>) – Human-readable label for the dataset being summarised.</p></li>
<li><p><strong>split</strong> (<em>str</em>) – Dataset split identifier such as <code class="docutils literal notranslate"><span class="pre">train</span></code> or <code class="docutils literal notranslate"><span class="pre">validation</span></code>.</p></li>
<li><p><strong>uncertainty</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>] </em><em>| </em><em>None</em>) – Auxiliary uncertainty information accompanying a metric.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown intro lines.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._next_video_observations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_next_video_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_next_video_observations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._next_video_observations" title="Link to this definition">¶</a></dt>
<dd><p>Summarise per-feature observations for next-video metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of metrics grouped by feature space and study.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown bullet list capturing qualitative next-video observations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._next_video_portfolio_summary">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_next_video_portfolio_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_next_video_portfolio_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._next_video_portfolio_summary" title="Link to this definition">¶</a></dt>
<dd><p>Render weighted portfolio statistics across feature spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of metrics grouped by feature space.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Ordered feature spaces considered by the pipeline.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown lines summarising portfolio-level performance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._next_video_uncertainty_info">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_next_video_uncertainty_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_next_video_uncertainty_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._next_video_uncertainty_info" title="Link to this definition">¶</a></dt>
<dd><p>Return the first uncertainty payload available for reporting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of metrics grouped by feature space and study.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Uncertainty payload if present.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Mapping</em>[str, object] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.sections._summarise_feature_observations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.sections.</span></span><span class="sig-name descname"><span class="pre">_summarise_feature_observations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/sections.html#_summarise_feature_observations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.sections._summarise_feature_observations" title="Link to this definition">¶</a></dt>
<dd><p>Summarise qualitative observations for a feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier such as <code class="docutils literal notranslate"><span class="pre">tfidf</span></code>.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em>) – Study-level metrics for the feature space.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown bullet or None when there is nothing to report.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.next_video.curves">Plot generation helpers for next-video learning-curve sections.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.curves._extract_curve_series">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.curves.</span></span><span class="sig-name descname"><span class="pre">_extract_curve_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">curve_block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/curves.html#_extract_curve_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.curves._extract_curve_series" title="Link to this definition">¶</a></dt>
<dd><p>Return sorted k/accuracy pairs extracted from <code class="docutils literal notranslate"><span class="pre">curve_block</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>curve_block</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Markdown block describing a single KNN performance curve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted k/accuracy pairs extracted from <code class="docutils literal notranslate"><span class="pre">curve_block</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[int], <em>List</em>[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.curves._next_video_curve_sections">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.curves.</span></span><span class="sig-name descname"><span class="pre">_next_video_curve_sections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/curves.html#_next_video_curve_sections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.curves._next_video_curve_sections" title="Link to this definition">¶</a></dt>
<dd><p>Render Markdown sections embedding train/validation accuracy curves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>pathlib.Path</em>) – Directory where the rendered report should be written.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of metrics grouped by feature space and study.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown sections that document next-video learning curves.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.curves._plot_knn_curve_bundle">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.curves.</span></span><span class="sig-name descname"><span class="pre">_plot_knn_curve_bundle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/curves.html#_plot_knn_curve_bundle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.curves._plot_knn_curve_bundle" title="Link to this definition">¶</a></dt>
<dd><p>Save a train/validation accuracy curve plot for <code class="docutils literal notranslate"><span class="pre">study</span></code> when possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>pathlib.Path</em>) – Base directory that contains task-specific output subdirectories.</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier such as <code class="docutils literal notranslate"><span class="pre">tfidf</span></code> or <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>.</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a>) – Study specification for the item currently being processed.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Relative path to the generated curve plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.next_video.comparison">Helpers for comparing next-video KNN metrics against XGB baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.comparison._best_knn_summary_for_study">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.comparison.</span></span><span class="sig-name descname"><span class="pre">_best_knn_summary_for_study</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/comparison.html#_best_knn_summary_for_study"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.comparison._best_knn_summary_for_study" title="Link to this definition">¶</a></dt>
<dd><p>Select the best KNN feature-space summary for <code class="docutils literal notranslate"><span class="pre">study_key</span></code> by eligible-only accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of metrics keyed by feature space and study.</p></li>
<li><p><strong>study_key</strong> (<em>str</em>) – Study identifier used to extract metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of <code class="docutils literal notranslate"><span class="pre">(feature_space,</span> <span class="pre">summary)</span></code> when available, otherwise <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str, object] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.comparison._knn_vs_xgb_section">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.comparison.</span></span><span class="sig-name descname"><span class="pre">_knn_vs_xgb_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgb_next_video_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/comparison.html#_knn_vs_xgb_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.comparison._knn_vs_xgb_section" title="Link to this definition">¶</a></dt>
<dd><p>Build a comparison section for matched KNN/XGB studies when XGB metrics are present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xgb_next_video_dir</strong> (<em>pathlib.Path</em>) – Directory containing XGB metrics grouped by evaluation slug.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of KNN metrics keyed by feature space and study.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications to evaluate for matching metrics.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown lines describing the comparison table, or an empty list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.comparison._load_xgb_metrics_for_study">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.comparison.</span></span><span class="sig-name descname"><span class="pre">_load_xgb_metrics_for_study</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_slug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/comparison.html#_load_xgb_metrics_for_study"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.comparison._load_xgb_metrics_for_study" title="Link to this definition">¶</a></dt>
<dd><p>Load XGB metrics for a single study when available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_dir</strong> (<em>pathlib.Path</em>) – Directory containing XGB evaluation exports.</p></li>
<li><p><strong>evaluation_slug</strong> (<em>str</em>) – Identifier for the study evaluation run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parsed metrics mapping, or <code class="docutils literal notranslate"><span class="pre">None</span></code> when missing or invalid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Mapping</em>[str, object] | None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.next_video.loso">Leave-one-study-out reporting helpers for the next-video report.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.loso._collect_loso_summaries">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.loso.</span></span><span class="sig-name descname"><span class="pre">_collect_loso_summaries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/loso.html#_collect_loso_summaries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.loso._collect_loso_summaries" title="Link to this definition">¶</a></dt>
<dd><p>Return holdout summaries paired with their accuracy deltas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em>) – LOSO metrics keyed by study key.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications used to align extracted summaries.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tuples <code class="docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">summary,</span> <span class="pre">delta_vs_baseline)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[str, object, float | None]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.loso._loso_highlight_lines">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.loso.</span></span><span class="sig-name descname"><span class="pre">_loso_highlight_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summaries</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/loso.html#_loso_highlight_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.loso._loso_highlight_lines" title="Link to this definition">¶</a></dt>
<dd><p>Return highlight bullets for key holdout statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>summaries</strong> (<em>Sequence</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>object</em><em>, </em><em>float</em><em> | </em><em>None</em><em>]</em><em>]</em>) – Sequence of tuples produced by <a class="reference internal" href="#knn.pipeline.reports.next_video.loso._collect_loso_summaries" title="knn.pipeline.reports.next_video.loso._collect_loso_summaries"><code class="xref py py-func docutils literal notranslate"><span class="pre">_collect_loso_summaries()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Bullet lines highlighting key holdout insights.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.loso._loso_table_rows">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.loso.</span></span><span class="sig-name descname"><span class="pre">_loso_table_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/loso.html#_loso_table_rows"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.loso._loso_table_rows" title="Link to this definition">¶</a></dt>
<dd><p>Return Markdown table rows for leave-one-study-out metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em>) – LOSO metrics keyed by study key.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications used to derive row order.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown table rows describing per-holdout results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.loso._next_video_loso_section">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.loso.</span></span><span class="sig-name descname"><span class="pre">_next_video_loso_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loso_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/loso.html#_next_video_loso_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.loso._next_video_loso_section" title="Link to this definition">¶</a></dt>
<dd><p>Return a section summarising leave-one-study-out accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Leave-one-study-out metrics grouped by feature space and holdout.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Markdown section summarising leave-one-study-out accuracy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.loso._ordered_loso_feature_spaces">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.loso.</span></span><span class="sig-name descname"><span class="pre">_ordered_loso_feature_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loso_metrics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/loso.html#_ordered_loso_feature_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.loso._ordered_loso_feature_spaces" title="Link to this definition">¶</a></dt>
<dd><p>Return feature spaces ordered by canonical preference then presence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of leave-one-study-out metrics by feature space.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list of feature-space identifiers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.next_video.csv_exports">CSV export helpers for next-video report metrics.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.csv_exports._write_next_video_loso_csv">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.csv_exports.</span></span><span class="sig-name descname"><span class="pre">_write_next_video_loso_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loso_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/csv_exports.html#_write_next_video_loso_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.csv_exports._write_next_video_loso_csv" title="Link to this definition">¶</a></dt>
<dd><p>Write LOSO next-video metrics to loso_metrics.csv for all feature spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>pathlib.Path</em>) – Directory where <code class="docutils literal notranslate"><span class="pre">loso_metrics.csv</span></code> should be written.</p></li>
<li><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of LOSO metrics keyed by feature space and study.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications used for label resolution.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.csv_exports._write_next_video_metrics_csv">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.csv_exports.</span></span><span class="sig-name descname"><span class="pre">_write_next_video_metrics_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/csv_exports.html#_write_next_video_metrics_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.csv_exports._write_next_video_metrics_csv" title="Link to this definition">¶</a></dt>
<dd><p>Write per-study next-video metrics to metrics.csv for all feature spaces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>pathlib.Path</em>) – Directory where <code class="docutils literal notranslate"><span class="pre">metrics.csv</span></code> should be written.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of metrics keyed by feature space and study.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications used for label resolution.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.next_video.helpers">Shared helper utilities for next-video report submodules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.helpers._ordered_feature_spaces">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.helpers.</span></span><span class="sig-name descname"><span class="pre">_ordered_feature_spaces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preferred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">available</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/helpers.html#_ordered_feature_spaces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.helpers._ordered_feature_spaces" title="Link to this definition">¶</a></dt>
<dd><p>Return feature spaces prioritised by canonical order then user preference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preferred</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Ordered feature spaces requested by the caller.</p></li>
<li><p><strong>available</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Feature spaces present in the metrics mapping.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined ordered list of feature spaces.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.helpers.accuracy_delta">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.helpers.</span></span><span class="sig-name descname"><span class="pre">accuracy_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/helpers.html#accuracy_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.helpers.accuracy_delta" title="Link to this definition">¶</a></dt>
<dd><p>Return the accuracy delta vs. baseline for <code class="docutils literal notranslate"><span class="pre">summary</span></code> when available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>summary</strong> (<a class="reference internal" href="#knn.pipeline.context.MetricSummary" title="knn.pipeline.context.MetricSummary"><em>knn.pipeline.context.MetricSummary</em></a>) – Metric summary with <code class="docutils literal notranslate"><span class="pre">accuracy</span></code> and <code class="docutils literal notranslate"><span class="pre">baseline</span></code> attributes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float delta or <code class="docutils literal notranslate"><span class="pre">None</span></code> if either component is missing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.helpers.iter_metric_payloads">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.helpers.</span></span><span class="sig-name descname"><span class="pre">iter_metric_payloads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/helpers.html#iter_metric_payloads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.helpers.iter_metric_payloads" title="Link to this definition">¶</a></dt>
<dd><p>Yield per-study metric summaries alongside their raw payloads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em>) – Mapping of study key to raw metric payloads.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Ordered sequence of study specifications.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Iterator yielding <code class="docutils literal notranslate"><span class="pre">(study,</span> <span class="pre">summary,</span> <span class="pre">payload)</span></code> tuples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterator[Tuple[<a class="reference internal" href="#knn.pipeline.context.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>, <a class="reference internal" href="#knn.pipeline.context.MetricSummary" title="knn.pipeline.context.MetricSummary">MetricSummary</a>, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.next_video.report">Orchestration for building next-video KNN reports.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.report._build_next_video_report">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.report.</span></span><span class="sig-name descname"><span class="pre">_build_next_video_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/report.html#_build_next_video_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.report._build_next_video_report" title="Link to this definition">¶</a></dt>
<dd><p>Compose the next-video evaluation report under <code class="docutils literal notranslate"><span class="pre">inputs.output_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs" title="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs"><em>knn.pipeline.reports.next_video.inputs.NextVideoReportInputs</em></a>) – Structured bundle of report inputs.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.pipeline_reports">
<span id="legacy-report-shims"></span><h2>Legacy Report Shims<a class="headerlink" href="#module-knn.pipeline_reports" title="Link to this heading">¶</a></h2>
<p>Public entry points for the KNN pipeline report builders.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline_reports.generate_reports">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.</span></span><span class="sig-name descname"><span class="pre">generate_reports</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bundle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports.html#generate_reports"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.generate_reports" title="Link to this definition">¶</a></dt>
<dd><p>Write refreshed Markdown reports under <code class="docutils literal notranslate"><span class="pre">reports/knn</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_root</strong> (<em>Path</em>) – Repository root directory used for path resolution.</p></li>
<li><p><strong>report_bundle</strong> (<a class="reference internal" href="#knn.pipeline.context.ReportBundle" title="knn.pipeline.context.ReportBundle"><em>ReportBundle</em></a>) – Aggregated data structure containing everything needed to emit reports.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline_reports.catalog">Catalog README builder for the KNN pipeline reports.</p>
<p id="module-knn.pipeline_reports.next_video">Modular next-video report builders used by the KNN reporting pipeline.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.next_video.</span></span><span class="sig-name descname"><span class="pre">NextVideoReportInputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loso_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgb_next_video_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#NextVideoReportInputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Input bundle required to render the next-video report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>pathlib.Path</em>) – Destination directory where report artifacts are written.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of per-study metrics keyed by feature space.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><em>common.pipeline.models.StudySpec</em></a><em>]</em>) – Ordered study specifications covered by the report.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Feature spaces in the order they should appear in the report.</p></li>
<li><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Optional leave-one-study-out metrics grouped by feature space.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Whether the report may emit placeholders when data is missing.</p></li>
<li><p><strong>xgb_next_video_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Root directory containing XGB comparison metrics, if any.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.feature_spaces">
<span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.feature_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.loso_metrics">
<span class="sig-name descname"><span class="pre">loso_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.loso_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.metrics_by_feature">
<span class="sig-name descname"><span class="pre">metrics_by_feature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.metrics_by_feature" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.output_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.studies">
<span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#knn.pipeline.context.StudySpec" title="common.pipeline.models.StudySpec"><span class="pre">common.pipeline.models.StudySpec</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.xgb_next_video_dir">
<span class="sig-name descname"><span class="pre">xgb_next_video_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.xgb_next_video_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline_reports.shared">Shared helpers for the modular KNN report generation pipeline.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline_reports.shared.parse_k_sweep">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.shared.</span></span><span class="sig-name descname"><span class="pre">parse_k_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline_reports/shared.html#parse_k_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.shared.parse_k_sweep" title="Link to this definition">¶</a></dt>
<dd><p>Convert the stored <code class="docutils literal notranslate"><span class="pre">k</span></code> sweep representation into integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k_sweep</strong> (<em>str</em><em> | </em><em>Iterable</em><em>[</em><em>int</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[int, …]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline_reports.features">Report builders summarising the extra text fields used by KNN pipelines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline_reports.features.build_feature_report">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.features.</span></span><span class="sig-name descname"><span class="pre">build_feature_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/features.html#build_feature_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.features.build_feature_report" title="Link to this definition">¶</a></dt>
<dd><p>Write the KNN additional-feature markdown report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_root</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>bundle</strong> (<a class="reference internal" href="#knn.pipeline.context.ReportBundle" title="knn.pipeline.context.ReportBundle"><em>knn.pipeline.context.ReportBundle</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline_reports.hyperparameter">Builders for the KNN hyper-parameter Markdown reports.</p>
<p id="module-knn.pipeline_reports.opinion">Opinion report builders for the modular KNN pipeline.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionReportOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regenerate_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asset_subdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'opinion'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/opinion.html#OpinionReportOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bundle of optional parameters for building the opinion report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, allow placeholder output when metrics are missing.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Markdown title inserted at the top of the report.</p></li>
<li><p><strong>description_lines</strong> (<em>Optional</em><em>[</em><em>Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Optional Markdown description beneath the title.</p></li>
<li><p><strong>metrics_line</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Optional override for the metrics summary bullet.</p></li>
<li><p><strong>predictions_root</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – Root directory containing cached opinion predictions.</p></li>
<li><p><strong>regenerate_plots</strong> (<em>bool</em>) – Rebuild matplotlib artefacts before emitting the report.</p></li>
<li><p><strong>asset_subdir</strong> (<em>str</em>) – Subdirectory name used when storing plot artefacts.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.asset_subdir">
<span class="sig-name descname"><span class="pre">asset_subdir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'opinion'</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.asset_subdir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.description_lines">
<span class="sig-name descname"><span class="pre">description_lines</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.description_lines" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.metrics_line">
<span class="sig-name descname"><span class="pre">metrics_line</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.metrics_line" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.predictions_root">
<span class="sig-name descname"><span class="pre">predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.predictions_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.regenerate_plots">
<span class="sig-name descname"><span class="pre">regenerate_plots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.regenerate_plots" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-knn.scripts">
<span id="scripts"></span><h2>Scripts<a class="headerlink" href="#module-knn.scripts" title="Link to this heading">¶</a></h2>
<p>Executable helpers shipped with the KNN package.</p>
<p id="module-knn.scripts.baseline">Legacy CLI shim maintained for backwards compatibility.</p>
<p>Backward-compatible entry point for the refactored KNN baseline.</p>
</section>
<section id="module-knn.cli.__main__">
<span id="cli-internals"></span><h2>CLI Internals<a class="headerlink" href="#module-knn.cli.__main__" title="Link to this heading">¶</a></h2>
<p>Entry point for <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">knn.cli</span></code>.</p>
<p id="module-knn.cli.main">Command-line interface for the Grail Simulation KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.main.build_parser">
<span class="sig-prename descclassname"><span class="pre">knn.cli.main.</span></span><span class="sig-name descname"><span class="pre">build_parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli/main.html#build_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.main.build_parser" title="Link to this definition">¶</a></dt>
<dd><p>Build the command-line parser that drives the refactored KNN workflows.</p>
<p>The parser exposes switches for both slate (next-video) and opinion
prediction flows, including feature-space selection, pre-computed index
reuse, bootstrap configuration, and Word2Vec/SentenceTransformer tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parser pre-populated with all supported CLI arguments for the KNN baseline.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>argparse.ArgumentParser</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.main.main">
<span class="sig-prename descclassname"><span class="pre">knn.cli.main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli/main.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.main.main" title="Link to this definition">¶</a></dt>
<dd><p>Dispatch execution for the CLI by parsing arguments and invoking the correct runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional argument vector supplied for testing. When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="xref py py-data docutils literal notranslate"><span class="pre">sys.argv</span></code> is used verbatim.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. The function delegates work to the slate or opinion pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">--task</span></code> is neither <code class="docutils literal notranslate"><span class="pre">slate</span></code> nor <code class="docutils literal notranslate"><span class="pre">opinion</span></code>.</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.cli.utils">CLI utility helpers shared by the KNN baseline entry points.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.utils.add_sentence_transformer_normalize_flags">
<span class="sig-prename descclassname"><span class="pre">knn.cli.utils.</span></span><span class="sig-name descname"><span class="pre">add_sentence_transformer_normalize_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli/utils.html#add_sentence_transformer_normalize_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.utils.add_sentence_transformer_normalize_flags" title="Link to this definition">¶</a></dt>
<dd><p>Attach normalisation toggle flags for sentence-transformer embeddings to a parser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parser</strong> (<em>argparse.ArgumentParser</em>) – Argument parser receiving the flags that control embedding normalisation.</p></li>
<li><p><strong>legacy_aliases</strong> (<em>bool</em>) – Register underscore-separated aliases to maintain compatibility with
pre-refactor invocations.</p></li>
<li><p><strong>help_prefix</strong> (<em>str</em>) – Optional text prepended to the generated help strings to provide context.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Flags are added to <code class="docutils literal notranslate"><span class="pre">parser</span></code> in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gpt4o.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">GPT-4o Tools API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="prompt_builder.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Prompt Builder API</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, GRAIL Simulation Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">KNN Baseline API</a><ul>
<li><a class="reference internal" href="#feature-spaces">Feature Spaces</a></li>
<li><a class="reference internal" href="#elbow-curve-metrics">Elbow &amp; Curve Metrics</a></li>
<li><a class="reference internal" href="#module-knn">Package Overview</a><ul>
<li><a class="reference internal" href="#knn.data.filter_dataset_for_issue"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.filter_dataset_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.filter_split_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_split_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.issues_in_dataset"><code class="docutils literal notranslate"><span class="pre">issues_in_dataset()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.load_dataset_source"><code class="docutils literal notranslate"><span class="pre">load_dataset_source()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder</span></code></a><ul>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.encode"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.encode()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.load"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.load()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.save"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.save()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.train"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.train()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.transform"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.transform()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.features.assemble_document"><code class="docutils literal notranslate"><span class="pre">assemble_document()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.candidate_feature_tokens"><code class="docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.collect_candidate_metadata"><code class="docutils literal notranslate"><span class="pre">collect_candidate_metadata()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.extract_now_watching"><code class="docutils literal notranslate"><span class="pre">extract_now_watching()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.extract_slate_items"><code class="docutils literal notranslate"><span class="pre">extract_slate_items()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prepare_prompt_documents"><code class="docutils literal notranslate"><span class="pre">prepare_prompt_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prepare_training_documents"><code class="docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prompt_from_builder"><code class="docutils literal notranslate"><span class="pre">prompt_from_builder()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.selection_feature_tokens"><code class="docutils literal notranslate"><span class="pre">selection_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.title_for"><code class="docutils literal notranslate"><span class="pre">title_for()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.viewer_profile_sentence"><code class="docutils literal notranslate"><span class="pre">viewer_profile_sentence()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">build_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_tfidf_index"><code class="docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_word2vec_index"><code class="docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.knn_predict_among_slate_multi"><code class="docutils literal notranslate"><span class="pre">knn_predict_among_slate_multi()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">load_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_tfidf_index"><code class="docutils literal notranslate"><span class="pre">load_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_word2vec_index"><code class="docutils literal notranslate"><span class="pre">load_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_tfidf_index"><code class="docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_word2vec_index"><code class="docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.bin_nopts"><code class="docutils literal notranslate"><span class="pre">bin_nopts()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.bucket_from_pos"><code class="docutils literal notranslate"><span class="pre">bucket_from_pos()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.canon"><code class="docutils literal notranslate"><span class="pre">canon()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.compute_auc_from_curve"><code class="docutils literal notranslate"><span class="pre">compute_auc_from_curve()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.evaluate_issue"><code class="docutils literal notranslate"><span class="pre">evaluate_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.parse_k_values"><code class="docutils literal notranslate"><span class="pre">parse_k_values()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.plot_elbow"><code class="docutils literal notranslate"><span class="pre">plot_elbow()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.resolve_reports_dir"><code class="docutils literal notranslate"><span class="pre">resolve_reports_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.run_eval"><code class="docutils literal notranslate"><span class="pre">run_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.select_best_k"><code class="docutils literal notranslate"><span class="pre">select_best_k()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.core.data">Core (Canonical Paths)</a><ul>
<li><a class="reference internal" href="#knn.core.data.filter_dataset_for_issue"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.filter_dataset_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.filter_split_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_split_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.issues_in_dataset"><code class="docutils literal notranslate"><span class="pre">issues_in_dataset()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.load_dataset_source"><code class="docutils literal notranslate"><span class="pre">load_dataset_source()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.channel_id"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.channel_id</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.channel_title"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.channel_title</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.slot"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.slot</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.title"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.title</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.video_id"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.video_id</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.epochs"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.epochs</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.min_count"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.min_count</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.model_dir"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.model_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.seed"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.seed</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.vector_size"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.vector_size</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.window"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.window</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.workers"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.workers</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.encode"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.encode()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.load"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.load()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.save"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.save()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.train"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.train()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.transform"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.transform()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.features.assemble_document"><code class="docutils literal notranslate"><span class="pre">assemble_document()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.candidate_feature_tokens"><code class="docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.collect_candidate_metadata"><code class="docutils literal notranslate"><span class="pre">collect_candidate_metadata()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.extract_now_watching"><code class="docutils literal notranslate"><span class="pre">extract_now_watching()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.extract_slate_items"><code class="docutils literal notranslate"><span class="pre">extract_slate_items()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.prepare_prompt_documents"><code class="docutils literal notranslate"><span class="pre">prepare_prompt_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.prepare_training_documents"><code class="docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.prompt_from_builder"><code class="docutils literal notranslate"><span class="pre">prompt_from_builder()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.selection_feature_tokens"><code class="docutils literal notranslate"><span class="pre">selection_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.title_for"><code class="docutils literal notranslate"><span class="pre">title_for()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.viewer_profile_sentence"><code class="docutils literal notranslate"><span class="pre">viewer_profile_sentence()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.build_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">build_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.build_tfidf_index"><code class="docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.build_word2vec_index"><code class="docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.knn_predict_among_slate_multi"><code class="docutils literal notranslate"><span class="pre">knn_predict_among_slate_multi()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.load_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">load_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.load_tfidf_index"><code class="docutils literal notranslate"><span class="pre">load_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.load_word2vec_index"><code class="docutils literal notranslate"><span class="pre">load_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.save_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.save_tfidf_index"><code class="docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.save_word2vec_index"><code class="docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.bin_nopts"><code class="docutils literal notranslate"><span class="pre">bin_nopts()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.bucket_from_pos"><code class="docutils literal notranslate"><span class="pre">bucket_from_pos()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.canon"><code class="docutils literal notranslate"><span class="pre">canon()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.compute_auc_from_curve"><code class="docutils literal notranslate"><span class="pre">compute_auc_from_curve()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.evaluate_issue"><code class="docutils literal notranslate"><span class="pre">evaluate_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.parse_k_values"><code class="docutils literal notranslate"><span class="pre">parse_k_values()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.plot_elbow"><code class="docutils literal notranslate"><span class="pre">plot_elbow()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.resolve_reports_dir"><code class="docutils literal notranslate"><span class="pre">resolve_reports_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.run_eval"><code class="docutils literal notranslate"><span class="pre">run_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.select_best_k"><code class="docutils literal notranslate"><span class="pre">select_best_k()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion.run_opinion_eval"><code class="docutils literal notranslate"><span class="pre">run_opinion_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs"><code class="docutils literal notranslate"><span class="pre">OpinionEmbeddingConfigs</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.sentence_transformer"><code class="docutils literal notranslate"><span class="pre">OpinionEmbeddingConfigs.sentence_transformer</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.word2vec"><code class="docutils literal notranslate"><span class="pre">OpinionEmbeddingConfigs.word2vec</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.args"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.args</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.dataset"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.dataset</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.embedding_configs"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.embedding_configs</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.extra_fields"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.extra_fields</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.feature_space"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.k_values"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.k_values</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.outputs_root"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.outputs_root</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample"><code class="docutils literal notranslate"><span class="pre">OpinionExample</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.after"><code class="docutils literal notranslate"><span class="pre">OpinionExample.after</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.before"><code class="docutils literal notranslate"><span class="pre">OpinionExample.before</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.document"><code class="docutils literal notranslate"><span class="pre">OpinionExample.document</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.issue"><code class="docutils literal notranslate"><span class="pre">OpinionExample.issue</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.participant_id"><code class="docutils literal notranslate"><span class="pre">OpinionExample.participant_id</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.participant_study"><code class="docutils literal notranslate"><span class="pre">OpinionExample.participant_study</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.session_id"><code class="docutils literal notranslate"><span class="pre">OpinionExample.session_id</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.step_index"><code class="docutils literal notranslate"><span class="pre">OpinionExample.step_index</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex"><code class="docutils literal notranslate"><span class="pre">OpinionIndex</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.embeds"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.embeds</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.feature_space"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.matrix"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.matrix</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.metric"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.metric</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.neighbors"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.neighbors</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.participant_keys"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.participant_keys</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.targets_after"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.targets_after</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.targets_before"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.targets_before</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.vectorizer"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.vectorizer</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_data.collect_examples"><code class="docutils literal notranslate"><span class="pre">collect_examples()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_data.find_spec"><code class="docutils literal notranslate"><span class="pre">find_spec()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.build_index"><code class="docutils literal notranslate"><span class="pre">build_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_predictions.predict_post_indices"><code class="docutils literal notranslate"><span class="pre">predict_post_indices()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.utils.ensure_directory"><code class="docutils literal notranslate"><span class="pre">ensure_directory()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.utils.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.utils">Core Utilities</a><ul>
<li><a class="reference internal" href="#knn.utils.ensure_directory"><code class="docutils literal notranslate"><span class="pre">ensure_directory()</span></code></a></li>
<li><a class="reference internal" href="#knn.utils.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline">Pipeline Modules</a><ul>
<li><a class="reference internal" href="#knn.pipeline.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.build_base_cli"><code class="docutils literal notranslate"><span class="pre">build_base_cli()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.build_pipeline_context"><code class="docutils literal notranslate"><span class="pre">build_pipeline_context()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.default_cache_dir"><code class="docutils literal notranslate"><span class="pre">default_cache_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.default_dataset"><code class="docutils literal notranslate"><span class="pre">default_dataset()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.default_out_dir"><code class="docutils literal notranslate"><span class="pre">default_out_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.log_dry_run"><code class="docutils literal notranslate"><span class="pre">log_dry_run()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.log_run_configuration"><code class="docutils literal notranslate"><span class="pre">log_run_configuration()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.parse_args"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.repo_root"><code class="docutils literal notranslate"><span class="pre">repo_root()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext"><code class="docutils literal notranslate"><span class="pre">EvaluationContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.base_cli"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.base_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.extra_cli"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.extra_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.from_args"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.from_args()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.next_video_out_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.next_video_out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.next_video_word2vec_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.next_video_word2vec_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.opinion_out_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.opinion_out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.opinion_word2vec_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.opinion_word2vec_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.out_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.outputs"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.outputs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.reuse_existing"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.reuse_existing</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.word2vec_model_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.word2vec_models"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.word2vec_models</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary"><code class="docutils literal notranslate"><span class="pre">MetricSummary</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy"><code class="docutils literal notranslate"><span class="pre">MetricSummary.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy_all_rows"><code class="docutils literal notranslate"><span class="pre">MetricSummary.accuracy_all_rows</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy_ci"><code class="docutils literal notranslate"><span class="pre">MetricSummary.accuracy_ci</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.baseline"><code class="docutils literal notranslate"><span class="pre">MetricSummary.baseline</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.baseline_ci"><code class="docutils literal notranslate"><span class="pre">MetricSummary.baseline_ci</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.best_k"><code class="docutils literal notranslate"><span class="pre">MetricSummary.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.n_eligible"><code class="docutils literal notranslate"><span class="pre">MetricSummary.n_eligible</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.n_total"><code class="docutils literal notranslate"><span class="pre">MetricSummary.n_total</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.random_baseline"><code class="docutils literal notranslate"><span class="pre">MetricSummary.random_baseline</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection"><code class="docutils literal notranslate"><span class="pre">OpinionStudySelection</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection.best_k"><code class="docutils literal notranslate"><span class="pre">OpinionStudySelection.best_k</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary"><code class="docutils literal notranslate"><span class="pre">OpinionSummary</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.accuracy"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.baseline_mae"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.baseline_mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.baseline_rmse_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.baseline_rmse_change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.best_k"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.calibration_bins"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.calibration_bins</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.calibration_ece"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.calibration_ece</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.calibration_intercept"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.calibration_intercept</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.calibration_slope"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.calibration_slope</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.kl_divergence_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.kl_divergence_change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.mae_change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae_delta"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.mae_delta</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.r2_score"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.r2_score</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.rmse"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.rmse</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.rmse_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.rmse_change</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.baseline_mae"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.baseline_mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.best_k"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.feature_space"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.mae_delta"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.mae_delta</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.participants"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.participants</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.r2_score"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.r2_score</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.base_cli"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.base_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.extra_cli"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.extra_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.run_root"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.run_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.word2vec_model_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext"><code class="docutils literal notranslate"><span class="pre">PipelineContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">PipelineContext.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.cache_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.cache_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.dataset"><code class="docutils literal notranslate"><span class="pre">PipelineContext.dataset</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.feature_spaces"><code class="docutils literal notranslate"><span class="pre">PipelineContext.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.jobs"><code class="docutils literal notranslate"><span class="pre">PipelineContext.jobs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.k_sweep"><code class="docutils literal notranslate"><span class="pre">PipelineContext.k_sweep</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.next_video_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.next_video_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.opinion_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.opinion_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.opinion_sweep_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.opinion_sweep_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.opinion_word2vec_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.opinion_word2vec_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.out_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.reuse_final"><code class="docutils literal notranslate"><span class="pre">PipelineContext.reuse_final</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.reuse_sweeps"><code class="docutils literal notranslate"><span class="pre">PipelineContext.reuse_sweeps</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.run_next_video"><code class="docutils literal notranslate"><span class="pre">PipelineContext.run_next_video</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.run_opinion"><code class="docutils literal notranslate"><span class="pre">PipelineContext.run_opinion</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sentence_batch_size"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sentence_batch_size</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sentence_device"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sentence_device</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sentence_model"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sentence_model</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sentence_normalize"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sentence_normalize</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.study_tokens"><code class="docutils literal notranslate"><span class="pre">PipelineContext.study_tokens</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sweep_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sweep_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.word2vec_epochs"><code class="docutils literal notranslate"><span class="pre">PipelineContext.word2vec_epochs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">PipelineContext.word2vec_model_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.word2vec_workers"><code class="docutils literal notranslate"><span class="pre">PipelineContext.word2vec_workers</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle"><code class="docutils literal notranslate"><span class="pre">ReportBundle</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">ReportBundle.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.feature_spaces"><code class="docutils literal notranslate"><span class="pre">ReportBundle.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.include_next_video"><code class="docutils literal notranslate"><span class="pre">ReportBundle.include_next_video</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.include_opinion"><code class="docutils literal notranslate"><span class="pre">ReportBundle.include_opinion</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.include_opinion_from_next"><code class="docutils literal notranslate"><span class="pre">ReportBundle.include_opinion_from_next</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.k_sweep"><code class="docutils literal notranslate"><span class="pre">ReportBundle.k_sweep</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.loso_metrics"><code class="docutils literal notranslate"><span class="pre">ReportBundle.loso_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.metrics_by_feature"><code class="docutils literal notranslate"><span class="pre">ReportBundle.metrics_by_feature</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_from_next_metrics"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_from_next_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_from_next_predictions_root"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_from_next_predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_metrics"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_predictions_root"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_selections"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_selections</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_sweep_outcomes</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.selections"><code class="docutils literal notranslate"><span class="pre">ReportBundle.selections</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.sentence_model"><code class="docutils literal notranslate"><span class="pre">ReportBundle.sentence_model</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.studies"><code class="docutils literal notranslate"><span class="pre">ReportBundle.studies</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">ReportBundle.sweep_outcomes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySelection"><code class="docutils literal notranslate"><span class="pre">StudySelection</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.StudySelection.accuracy"><code class="docutils literal notranslate"><span class="pre">StudySelection.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySelection.best_k"><code class="docutils literal notranslate"><span class="pre">StudySelection.best_k</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySpec"><code class="docutils literal notranslate"><span class="pre">StudySpec</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.StudySpec.evaluation_slug"><code class="docutils literal notranslate"><span class="pre">StudySpec.evaluation_slug</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySpec.issue"><code class="docutils literal notranslate"><span class="pre">StudySpec.issue</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySpec.issue_slug"><code class="docutils literal notranslate"><span class="pre">StudySpec.issue_slug</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySpec.key"><code class="docutils literal notranslate"><span class="pre">StudySpec.key</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySpec.label"><code class="docutils literal notranslate"><span class="pre">StudySpec.label</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySpec.study_slug"><code class="docutils literal notranslate"><span class="pre">StudySpec.study_slug</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig"><code class="docutils literal notranslate"><span class="pre">SweepConfig</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.cli_args"><code class="docutils literal notranslate"><span class="pre">SweepConfig.cli_args()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.feature_space"><code class="docutils literal notranslate"><span class="pre">SweepConfig.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.label"><code class="docutils literal notranslate"><span class="pre">SweepConfig.label()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.metric"><code class="docutils literal notranslate"><span class="pre">SweepConfig.metric</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_batch_size"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_batch_size</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_device"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_device</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_model"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_model</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_normalize"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_normalize</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.text_fields"><code class="docutils literal notranslate"><span class="pre">SweepConfig.text_fields</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_epochs"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_epochs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_min_count"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_min_count</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_size"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_size</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_window"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_window</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_workers"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_workers</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome"><code class="docutils literal notranslate"><span class="pre">SweepOutcome</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.accuracy"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.best_k"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.eligible"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.eligible</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.feature_space"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.feature_space</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask"><code class="docutils literal notranslate"><span class="pre">SweepTask</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask.issue"><code class="docutils literal notranslate"><span class="pre">SweepTask.issue</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask.issue_slug"><code class="docutils literal notranslate"><span class="pre">SweepTask.issue_slug</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask.train_participant_studies"><code class="docutils literal notranslate"><span class="pre">SweepTask.train_participant_studies</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">SweepTask.word2vec_model_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.base_cli"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.base_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.extra_cli"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.extra_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.sweep_dir"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.sweep_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.word2vec_model_base"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.word2vec_model_base</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.data.issue_slug_for_study"><code class="docutils literal notranslate"><span class="pre">issue_slug_for_study()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.data.resolve_studies"><code class="docutils literal notranslate"><span class="pre">resolve_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.data.study_specs"><code class="docutils literal notranslate"><span class="pre">study_specs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.data.warn_if_issue_tokens_used"><code class="docutils literal notranslate"><span class="pre">warn_if_issue_tokens_used()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.run_cross_study_evaluations"><code class="docutils literal notranslate"><span class="pre">run_cross_study_evaluations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.run_final_evaluations"><code class="docutils literal notranslate"><span class="pre">run_final_evaluations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.run_opinion_evaluations"><code class="docutils literal notranslate"><span class="pre">run_opinion_evaluations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_final_metrics_from_disk"><code class="docutils literal notranslate"><span class="pre">load_final_metrics_from_disk()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_loso_metrics_from_disk"><code class="docutils literal notranslate"><span class="pre">load_loso_metrics_from_disk()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_metrics"><code class="docutils literal notranslate"><span class="pre">load_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_opinion_metrics"><code class="docutils literal notranslate"><span class="pre">load_opinion_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.build_opinion_task"><code class="docutils literal notranslate"><span class="pre">build_opinion_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_task"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.format_opinion_sweep_task_descriptor"><code class="docutils literal notranslate"><span class="pre">format_opinion_sweep_task_descriptor()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.merge_opinion_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">merge_opinion_sweep_outcomes()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.opinion_sweep_outcome_from_metrics"><code class="docutils literal notranslate"><span class="pre">opinion_sweep_outcome_from_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.prepare_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">prepare_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.select_best_opinion_configs"><code class="docutils literal notranslate"><span class="pre">select_best_opinion_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.build_opinion_task"><code class="docutils literal notranslate"><span class="pre">build_opinion_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.build_sweep_configs"><code class="docutils literal notranslate"><span class="pre">build_sweep_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.emit_combined_sweep_plan"><code class="docutils literal notranslate"><span class="pre">emit_combined_sweep_plan()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.emit_sweep_plan"><code class="docutils literal notranslate"><span class="pre">emit_sweep_plan()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_opinion_sweep_task"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_sweep_task"><code class="docutils literal notranslate"><span class="pre">execute_sweep_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">execute_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.format_opinion_sweep_task_descriptor"><code class="docutils literal notranslate"><span class="pre">format_opinion_sweep_task_descriptor()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.format_sweep_task_descriptor"><code class="docutils literal notranslate"><span class="pre">format_sweep_task_descriptor()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.merge_opinion_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">merge_opinion_sweep_outcomes()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.merge_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">merge_sweep_outcomes()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.opinion_sweep_outcome_from_metrics"><code class="docutils literal notranslate"><span class="pre">opinion_sweep_outcome_from_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.prepare_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">prepare_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.prepare_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">prepare_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.run_knn_cli"><code class="docutils literal notranslate"><span class="pre">run_knn_cli()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.run_sweeps"><code class="docutils literal notranslate"><span class="pre">run_sweeps()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.select_best_configs"><code class="docutils literal notranslate"><span class="pre">select_best_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.select_best_opinion_configs"><code class="docutils literal notranslate"><span class="pre">select_best_opinion_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.sweep_outcome_from_metrics"><code class="docutils literal notranslate"><span class="pre">sweep_outcome_from_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.empty_descriptor"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.empty_descriptor</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.logger"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.logger</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.missing_descriptor"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.missing_descriptor</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.require_selected"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.require_selected</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy"><code class="docutils literal notranslate"><span class="pre">TaskCacheStrategy</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy.cache_path"><code class="docutils literal notranslate"><span class="pre">TaskCacheStrategy.cache_path</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy.load_cached"><code class="docutils literal notranslate"><span class="pre">TaskCacheStrategy.load_cached</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_dir"><code class="docutils literal notranslate"><span class="pre">ensure_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_feature_selections"><code class="docutils literal notranslate"><span class="pre">ensure_feature_selections()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_opinion_selection_coverage"><code class="docutils literal notranslate"><span class="pre">ensure_opinion_selection_coverage()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_selection_coverage"><code class="docutils literal notranslate"><span class="pre">ensure_selection_coverage()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_sweep_selection_coverage"><code class="docutils literal notranslate"><span class="pre">ensure_sweep_selection_coverage()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.extract_metric_summary"><code class="docutils literal notranslate"><span class="pre">extract_metric_summary()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.extract_opinion_summary"><code class="docutils literal notranslate"><span class="pre">extract_opinion_summary()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_count"><code class="docutils literal notranslate"><span class="pre">format_count()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_delta"><code class="docutils literal notranslate"><span class="pre">format_delta()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_float"><code class="docutils literal notranslate"><span class="pre">format_float()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_k"><code class="docutils literal notranslate"><span class="pre">format_k()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_optional_float"><code class="docutils literal notranslate"><span class="pre">format_optional_float()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_uncertainty_details"><code class="docutils literal notranslate"><span class="pre">format_uncertainty_details()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.handle_cached_task"><code class="docutils literal notranslate"><span class="pre">handle_cached_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.parse_ci"><code class="docutils literal notranslate"><span class="pre">parse_ci()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.partition_cached_tasks"><code class="docutils literal notranslate"><span class="pre">partition_cached_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.prepare_task_grid"><code class="docutils literal notranslate"><span class="pre">prepare_task_grid()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.safe_float"><code class="docutils literal notranslate"><span class="pre">safe_float()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.safe_int"><code class="docutils literal notranslate"><span class="pre">safe_int()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.snake_to_title"><code class="docutils literal notranslate"><span class="pre">snake_to_title()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline.reports">Report Builders</a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.generate_reports"><code class="docutils literal notranslate"><span class="pre">generate_reports()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.features.build_feature_report"><code class="docutils literal notranslate"><span class="pre">build_feature_report()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.asset_subdir"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.asset_subdir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.description_lines"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.description_lines</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.metrics_line"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.metrics_line</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.predictions_root"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.regenerate_plots"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.regenerate_plots</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.title"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.title</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.shared.parse_k_sweep"><code class="docutils literal notranslate"><span class="pre">parse_k_sweep()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline.reports.next_video.inputs">Next-Video Report Internals</a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.feature_spaces"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.loso_metrics"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.loso_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.metrics_by_feature"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.metrics_by_feature</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.output_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.output_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.studies"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.studies</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.xgb_next_video_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.xgb_next_video_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.accuracy"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.baseline"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.baseline</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.eligible"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.eligible</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.random"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.random</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.studies"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.studies</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator"><code class="docutils literal notranslate"><span class="pre">_ObservationAccumulator</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.averages"><code class="docutils literal notranslate"><span class="pre">_ObservationAccumulator.averages()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.delta_count"><code class="docutils literal notranslate"><span class="pre">_ObservationAccumulator.delta_count</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.delta_sum"><code class="docutils literal notranslate"><span class="pre">_ObservationAccumulator.delta_sum</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.random_count"><code class="docutils literal notranslate"><span class="pre">_ObservationAccumulator.random_count</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.random_sum"><code class="docutils literal notranslate"><span class="pre">_ObservationAccumulator.random_sum</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._ObservationAccumulator.record"><code class="docutils literal notranslate"><span class="pre">_ObservationAccumulator.record()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.accuracy_total"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.accuracy_total</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.accuracy_weight"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.accuracy_weight</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.add"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.add()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.baseline_total"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.baseline_total</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.baseline_weight"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.baseline_weight</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.random_total"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.random_total</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.random_weight"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.random_weight</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.result"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.result()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs._PortfolioAccumulator.studies_with_metrics"><code class="docutils literal notranslate"><span class="pre">_PortfolioAccumulator.studies_with_metrics</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._aggregate_portfolio_metrics"><code class="docutils literal notranslate"><span class="pre">_aggregate_portfolio_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._format_ci"><code class="docutils literal notranslate"><span class="pre">_format_ci()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._next_video_dataset_info"><code class="docutils literal notranslate"><span class="pre">_next_video_dataset_info()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._next_video_feature_section"><code class="docutils literal notranslate"><span class="pre">_next_video_feature_section()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._next_video_intro"><code class="docutils literal notranslate"><span class="pre">_next_video_intro()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._next_video_observations"><code class="docutils literal notranslate"><span class="pre">_next_video_observations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._next_video_portfolio_summary"><code class="docutils literal notranslate"><span class="pre">_next_video_portfolio_summary()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._next_video_uncertainty_info"><code class="docutils literal notranslate"><span class="pre">_next_video_uncertainty_info()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.sections._summarise_feature_observations"><code class="docutils literal notranslate"><span class="pre">_summarise_feature_observations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.curves._extract_curve_series"><code class="docutils literal notranslate"><span class="pre">_extract_curve_series()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.curves._next_video_curve_sections"><code class="docutils literal notranslate"><span class="pre">_next_video_curve_sections()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.curves._plot_knn_curve_bundle"><code class="docutils literal notranslate"><span class="pre">_plot_knn_curve_bundle()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.comparison._best_knn_summary_for_study"><code class="docutils literal notranslate"><span class="pre">_best_knn_summary_for_study()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.comparison._knn_vs_xgb_section"><code class="docutils literal notranslate"><span class="pre">_knn_vs_xgb_section()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.comparison._load_xgb_metrics_for_study"><code class="docutils literal notranslate"><span class="pre">_load_xgb_metrics_for_study()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.loso._collect_loso_summaries"><code class="docutils literal notranslate"><span class="pre">_collect_loso_summaries()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.loso._loso_highlight_lines"><code class="docutils literal notranslate"><span class="pre">_loso_highlight_lines()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.loso._loso_table_rows"><code class="docutils literal notranslate"><span class="pre">_loso_table_rows()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.loso._next_video_loso_section"><code class="docutils literal notranslate"><span class="pre">_next_video_loso_section()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.loso._ordered_loso_feature_spaces"><code class="docutils literal notranslate"><span class="pre">_ordered_loso_feature_spaces()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.csv_exports._write_next_video_loso_csv"><code class="docutils literal notranslate"><span class="pre">_write_next_video_loso_csv()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.csv_exports._write_next_video_metrics_csv"><code class="docutils literal notranslate"><span class="pre">_write_next_video_metrics_csv()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.helpers._ordered_feature_spaces"><code class="docutils literal notranslate"><span class="pre">_ordered_feature_spaces()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.helpers.accuracy_delta"><code class="docutils literal notranslate"><span class="pre">accuracy_delta()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.helpers.iter_metric_payloads"><code class="docutils literal notranslate"><span class="pre">iter_metric_payloads()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.report._build_next_video_report"><code class="docutils literal notranslate"><span class="pre">_build_next_video_report()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline_reports">Legacy Report Shims</a><ul>
<li><a class="reference internal" href="#knn.pipeline_reports.generate_reports"><code class="docutils literal notranslate"><span class="pre">generate_reports()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.feature_spaces"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.loso_metrics"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.loso_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.metrics_by_feature"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.metrics_by_feature</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.output_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.output_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.studies"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.studies</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.xgb_next_video_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.xgb_next_video_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline_reports.shared.parse_k_sweep"><code class="docutils literal notranslate"><span class="pre">parse_k_sweep()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.features.build_feature_report"><code class="docutils literal notranslate"><span class="pre">build_feature_report()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.asset_subdir"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.asset_subdir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.description_lines"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.description_lines</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.metrics_line"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.metrics_line</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.predictions_root"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.regenerate_plots"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.regenerate_plots</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.title"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.title</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.scripts">Scripts</a></li>
<li><a class="reference internal" href="#module-knn.cli.__main__">CLI Internals</a><ul>
<li><a class="reference internal" href="#knn.cli.main.build_parser"><code class="docutils literal notranslate"><span class="pre">build_parser()</span></code></a></li>
<li><a class="reference internal" href="#knn.cli.main.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#knn.cli.utils.add_sentence_transformer_normalize_flags"><code class="docutils literal notranslate"><span class="pre">add_sentence_transformer_normalize_flags()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>