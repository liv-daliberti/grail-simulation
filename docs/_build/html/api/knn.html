<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="GPT-4o Tools API" href="gpt4o.html"><link rel="prev" title="Prompt Builder API" href="prompt_builder.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>KNN Baseline API - GRAIL Simulation documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #1f4b8e;
  --color-brand-content: #1f4b8e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">GRAIL Simulation  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">GRAIL Simulation  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Utilities API</a></li>
<li class="toctree-l1"><a class="reference internal" href="clean_data.html">Clean Data Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="prompt_builder.html">Prompt Builder API</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">KNN Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpt4o.html">GPT-4o Tools API</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_r1.html">Open-R1 Training API</a></li>
<li class="toctree-l1"><a class="reference internal" href="xgb.html">XGBoost Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reports/index.html">Reports</a><input aria-label="Toggle navigation of Reports" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_stats.html">Prompt feature report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_builder.html">Prompt Builder Sample Prompts</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/knn.html">KNN Report Catalog</a><input aria-label="Toggle navigation of KNN Report Catalog" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_next_video.html">KNN Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion.html">KNN Opinion Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion.html#knn-opinion-shift-study">KNN Opinion Shift Study</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_hyperparameter_tuning.html">KNN Hyperparameter Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_hyperparameter_tuning.html#knn-hyperparameter-tuning-notes">KNN Hyperparameter Tuning Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reports/research_article_political_sciences.html">RESEARCH ARTICLE POLITICAL SCIENCES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/visualized_recommendation_trees.html">Visualized Recommendation Trees</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/knn.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="knn-baseline-api">
<h1>KNN Baseline API<a class="headerlink" href="#knn-baseline-api" title="Link to this heading">¶</a></h1>
<section id="feature-spaces">
<h2>Feature Spaces<a class="headerlink" href="#feature-spaces" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">knn</span></code> command-line entry point exposes a <code class="docutils literal notranslate"><span class="pre">--feature-space</span></code> switch to
toggle between sparse TF-IDF queries (default), dense Word2Vec embeddings, and
Sentence-Transformer embeddings. Word2Vec support depends on <code class="docutils literal notranslate"><span class="pre">gensim</span></code> being
available; Sentence-Transformer support depends on the
<code class="docutils literal notranslate"><span class="pre">sentence-transformers</span></code> package (and a compatible PyTorch backend). Install
the extras with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">gensim</span> <span class="pre">sentence-transformers</span></code> or include the
project’s <code class="docutils literal notranslate"><span class="pre">dev</span></code> extra.</p>
<p>Example invocations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>tfidf<span class="w"> </span>--out-dir<span class="w"> </span>models/knn/run-tfidf

python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>word2vec<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--word2vec-size<span class="w"> </span><span class="m">256</span><span class="w"> </span>--out-dir<span class="w"> </span>models/knn/run-w2v

python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>sentence_transformer<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--sentence-transformer-model<span class="w"> </span>sentence-transformers/all-MiniLM-L6-v2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--out-dir<span class="w"> </span>models/knn/run-st
</pre></div>
</div>
<p>Diagnostics (elbow plots, accuracy-by-k curves, and per-k predictions) are
saved under the configured <cite>–out-dir</cite>; use <cite>–train-curve-max</cite> to control how
many training examples contribute to the curve metrics.</p>
</section>
<section id="elbow-curve-metrics">
<h2>Elbow &amp; Curve Metrics<a class="headerlink" href="#elbow-curve-metrics" title="Link to this heading">¶</a></h2>
<p>Each evaluation issue produces:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reports/knn/next_video/&lt;feature-space&gt;/elbow_&lt;issue&gt;.png</span></code> – accuracy vs. <code class="docutils literal notranslate"><span class="pre">k</span></code> with the
elbow-selected point highlighted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models/knn/&lt;issue&gt;/knn_curves_&lt;issue&gt;.json</span></code> – serialised curves for the
evaluation split (and optionally the training split) containing accuracy-by-<code class="docutils literal notranslate"><span class="pre">k</span></code>,
eligible/correct counts, AUC (both absolute and normalised), and the selected
<code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models/knn/&lt;issue&gt;/k-&lt;k&gt;/</span></code> – per-<code class="docutils literal notranslate"><span class="pre">k</span></code> predictions and aggregate metrics for
downstream analysis.</p></li>
</ul>
<p>Set <code class="docutils literal notranslate"><span class="pre">--train-curve-max</span></code> when invoking the CLI to limit how many training
examples feed into the training curve diagnostics.</p>
<p id="module-knn.data">Top-level orchestration helpers for the <code class="docutils literal notranslate"><span class="pre">clean_data</span></code> package.</p>
<p>This module stitches together the key pieces of the cleaning pipeline:
loading raw CodeOcean or Hugging Face datasets, filtering unusable rows,
converting interactions into prompt-ready examples, validating schema
requirements, saving artifacts, and dispatching prompt statistics reports.
It is the public surface that downstream tooling should import when they
need to build or persist cleaned prompt datasets. All functionality here is
distributed under the repository’s Apache 2.0 license; see LICENSE for
details.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_dataset_for_issue">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/data.html#filter_dataset_for_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_dataset_for_issue" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset down to a specific issue label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">issue</span></code> column.</p></li>
<li><p><strong>issue</strong> (<em>str</em>) – Issue label to retain (<code class="docutils literal notranslate"><span class="pre">all</span></code> preserves every row).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary restricted to rows matching <code class="docutils literal notranslate"><span class="pre">issue</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_dataset_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/data.html#filter_dataset_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_dataset_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter the dataset to rows whose <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> matches <code class="docutils literal notranslate"><span class="pre">studies</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> column.</p></li>
<li><p><strong>studies</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary filtered to the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_split_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_split_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/data.html#filter_split_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_split_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset split to the requested <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_ds</strong> (<em>datasets.Dataset</em>) – Dataset split supporting <code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code>.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered dataset split covering only the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.issues_in_dataset">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">issues_in_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/data.html#issues_in_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.issues_in_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Return the list of issue labels present in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing at least one split.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of issue identifiers or <code class="docutils literal notranslate"><span class="pre">['all']</span></code> when absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.load_dataset_source">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">load_dataset_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/data.html#load_dataset_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.load_dataset_source" title="Link to this definition">¶</a></dt>
<dd><p>Load a cleaned dataset from disk or from the Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>str</em>) – Local directory path or Hugging Face dataset identifier.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – Cache directory passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">datasets.load_dataset()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary containing train and validation splits.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">datasets</span></code> is unavailable.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">source</span></code> does not yield a <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.DatasetDict</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-knn.features">Top-level orchestration helpers for the <code class="docutils literal notranslate"><span class="pre">clean_data</span></code> package.</p>
<p>This module stitches together the key pieces of the cleaning pipeline:
loading raw CodeOcean or Hugging Face datasets, filtering unusable rows,
converting interactions into prompt-ready examples, validating schema
requirements, saving artifacts, and dispatching prompt statistics reports.
It is the public surface that downstream tooling should import when they
need to build or persist cleaned prompt datasets. All functionality here is
distributed under the repository’s Apache 2.0 license; see LICENSE for
details.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('models/knn_word2vec')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration options for Word2Vec embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vector_size</strong> (<em>int</em>) – Dimensionality of the learned embedding vectors.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Context window size used during training.</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – Minimum token frequency retained in the vocabulary.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of Word2Vec training epochs.</p></li>
<li><p><strong>model_dir</strong> (<em>Path</em>) – Directory where trained embeddings are persisted.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed for Word2Vec initialisation.</p></li>
<li><p><strong>workers</strong> (<em>int</em>) – Number of worker threads allocated to training.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>vector_size</strong> (<em>int</em>)</p></li>
<li><p><strong>window</strong> (<em>int</em>)</p></li>
<li><p><strong>min_count</strong> (<em>int</em>)</p></li>
<li><p><strong>epochs</strong> (<em>int</em>)</p></li>
<li><p><strong>model_dir</strong> (<em>Path</em>)</p></li>
<li><p><strong>seed</strong> (<em>int</em>)</p></li>
<li><p><strong>workers</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#knn.features.Word2VecConfig.epochs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig.min_count">
<span class="sig-name descname"><span class="pre">min_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#knn.features.Word2VecConfig.min_count" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig.model_dir">
<span class="sig-name descname"><span class="pre">model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PosixPath('models/knn_word2vec')</span></em><a class="headerlink" href="#knn.features.Word2VecConfig.model_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">42</span></em><a class="headerlink" href="#knn.features.Word2VecConfig.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig.vector_size">
<span class="sig-name descname"><span class="pre">vector_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#knn.features.Word2VecConfig.vector_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig.window">
<span class="sig-name descname"><span class="pre">window</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#knn.features.Word2VecConfig.window" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.features.Word2VecConfig.workers">
<span class="sig-name descname"><span class="pre">workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#knn.features.Word2VecConfig.workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecFeatureBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create Word2Vec embeddings from viewer prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.features.Word2VecConfig" title="knn.features.Word2VecConfig"><em>Word2VecConfig</em></a>) – Configuration bundle controlling Word2Vec training/inference.</p></li>
<li><p><strong>_model</strong> (<em>gensim.models.Word2Vec</em><em> | </em><em>None</em>) – Loaded gensim <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2Vec</span></code> instance.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.features.Word2VecConfig" title="knn.features.Word2VecConfig"><em>Word2VecConfig</em></a><em>]</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the builder with optional configuration overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="#knn.features.Word2VecConfig" title="knn.features.Word2VecConfig"><em>Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional configuration bundle to override defaults.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.encode" title="Link to this definition">¶</a></dt>
<dd><p>Return the averaged embedding vector for <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Document to encode using the fitted embeddings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Averaged embedding vector representing <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.is_trained">
<span class="sig-name descname"><span class="pre">is_trained</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder.is_trained"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.is_trained" title="Link to this definition">¶</a></dt>
<dd><p>Indicate whether the underlying Word2Vec model is ready for inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> when a trained model is loaded.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a previously trained Word2Vec model from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Directory containing the saved Word2Vec model.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.save" title="Link to this definition">¶</a></dt>
<dd><p>Persist the trained model to <code class="docutils literal notranslate"><span class="pre">directory</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Destination directory receiving the model artefact.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.train" title="Link to this definition">¶</a></dt>
<dd><p>Train a Word2Vec model using the provided corpus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Iterable of documents used to fit the embeddings.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#Word2VecFeatureBuilder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.transform" title="Link to this definition">¶</a></dt>
<dd><p>Return stacked embeddings for <code class="docutils literal notranslate"><span class="pre">corpus</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Sequence of documents to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of shape <code class="docutils literal notranslate"><span class="pre">(len(corpus),</span> <span class="pre">vector_size)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.assemble_document">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">assemble_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#assemble_document"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.assemble_document" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate prompt components into a single document for featurisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>dict</em>) – Dataset row describing the prompt and slate context.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional column names appended to the document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined prompt text passed to vectorisers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.extract_now_watching">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">extract_now_watching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#extract_now_watching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.extract_now_watching" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the currently watched item for an interaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>dict</em>) – Interaction example describing viewer activity.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of <code class="docutils literal notranslate"><span class="pre">(title,</span> <span class="pre">video_id)</span></code> when the “now watching” context exists.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[str, str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.extract_slate_items">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">extract_slate_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#extract_slate_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.extract_slate_items" title="Link to this definition">¶</a></dt>
<dd><p>Extract the slate of candidate items from an interaction example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>dict</em>) – Dataset row containing slate metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list of <code class="docutils literal notranslate"><span class="pre">(title,</span> <span class="pre">video_id)</span></code> tuples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[Tuple[str, str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prepare_training_documents">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prepare_training_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#prepare_training_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prepare_training_documents" title="Link to this definition">¶</a></dt>
<dd><p>Prepare prompt documents, labels, and metadata for TF-IDF training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> (<em>datasets.Dataset</em><em> | </em><em>Sequence</em><em>[</em><em>dict</em><em>]</em>) – Dataset split providing training rows.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Optional cap on the number of training rows retained (0 keeps all).</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used when subsampling <code class="docutils literal notranslate"><span class="pre">train_ds</span></code>.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Additional columns appended to the prompt document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of <code class="docutils literal notranslate"><span class="pre">(documents,</span> <span class="pre">label_ids,</span> <span class="pre">participant_ids)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[list[str], list[str], list[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prompt_from_builder">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prompt_from_builder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#prompt_from_builder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prompt_from_builder" title="Link to this definition">¶</a></dt>
<dd><p>Assemble the full prompt text for a dataset example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>dict</em>) – Interaction example containing prompt components.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Prompt text used for feature extraction.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.title_for">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">title_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#title_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.title_for" title="Link to this definition">¶</a></dt>
<dd><p>Look up a human-readable title for a given YouTube identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>video_id</strong> (<em>str</em>) – Candidate YouTube video identifier to resolve.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Title associated with <code class="docutils literal notranslate"><span class="pre">video_id</span></code> when present in the cache.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.viewer_profile_sentence">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">viewer_profile_sentence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/features.html#viewer_profile_sentence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.viewer_profile_sentence" title="Link to this definition">¶</a></dt>
<dd><p>Compose the viewer profile sentence associated with a dataset row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>dict</em>) – Interaction example containing viewer profile fields.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Natural-language sentence describing the participant profile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.index">Top-level orchestration helpers for the <code class="docutils literal notranslate"><span class="pre">clean_data</span></code> package.</p>
<p>This module stitches together the key pieces of the cleaning pipeline:
loading raw CodeOcean or Hugging Face datasets, filtering unusable rows,
converting interactions into prompt-ready examples, validating schema
requirements, saving artifacts, and dispatching prompt statistics reports.
It is the public surface that downstream tooling should import when they
need to build or persist cleaned prompt datasets. All functionality here is
distributed under the repository’s Apache 2.0 license; see LICENSE for
details.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#build_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a sentence-transformer index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="common.html#common.embeddings.SentenceTransformerConfig" title="common.embeddings.SentenceTransformerConfig"><em>SentenceTransformerConfig</em></a><em> | </em><em>None</em>) – Optional <a class="reference internal" href="common.html#common.embeddings.SentenceTransformerConfig" title="common.embeddings.SentenceTransformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SentenceTransformerConfig</span></code></a> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the encoder, dense matrix, and label metadata.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If <code class="docutils literal notranslate"><span class="pre">sentence_transformers</span></code> is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#build_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a TF-IDF index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split (Hugging Face dataset or list-like).</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>max_features</strong> (<em>int</em><em> | </em><em>None</em>) – Optional vocabulary cap for the vectoriser.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the fitted vectoriser, sparse matrix, and
label metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#build_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a Word2Vec index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.features.Word2VecConfig" title="knn.features.Word2VecConfig"><em>Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional <a class="reference internal" href="#knn.features.Word2VecConfig" title="knn.features.Word2VecConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">Word2VecConfig</span></code></a> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the trained Word2Vec model and embeddings.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If gensim is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.knn_predict_among_slate_multi">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">knn_predict_among_slate_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#knn_predict_among_slate_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.knn_predict_among_slate_multi" title="Link to this definition">¶</a></dt>
<dd><p>Score each slate option using candidate-aware TF-IDF kNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knn_index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary describing the fitted index artifacts.</p></li>
<li><p><strong>example</strong> (<em>dict</em>) – Dataset row containing the slate to score.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sequence of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate.</p></li>
<li><p><strong>config</strong> (<em>SlateQueryConfig</em><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">SlateQueryConfig</span></code> overriding defaults.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping from <code class="docutils literal notranslate"><span class="pre">k</span></code> to the predicted 1-based option index. <code class="docutils literal notranslate"><span class="pre">None</span></code>
indicates that a prediction could not be produced for that <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[int, int | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#load_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a sentence-transformer index saved via <a class="reference internal" href="#knn.index.save_sentence_transformer_index" title="knn.index.save_sentence_transformer_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing previously persisted artefacts to load from disk.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the loaded sentence-transformer index and associated metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#load_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a TF-IDF index previously saved via <a class="reference internal" href="#knn.index.save_tfidf_index" title="knn.index.save_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted TF-IDF artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the loaded vectoriser, matrix, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#load_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a Word2Vec index previously saved via <a class="reference internal" href="#knn.index.save_word2vec_index" title="knn.index.save_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted Word2Vec artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the restored Word2Vec model, embeddings, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#save_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the sentence-transformer index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – KNN index object or registry being manipulated.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Output directory receiving generated metrics and reports.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#save_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the TF-IDF index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.index.build_tfidf_index" title="knn.index.build_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where artifacts will be written.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/index.html#save_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the Word2Vec index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.index.build_word2vec_index" title="knn.index.build_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where embeddings and metadata are stored.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.evaluate">Evaluation loop and metrics for the KNN baseline.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.bin_nopts">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">bin_nopts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#bin_nopts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.bin_nopts" title="Link to this definition">¶</a></dt>
<dd><p>Bucket the number of slate options into reporting-friendly categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option_count</strong> (<em>int</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.bucket_from_pos">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">bucket_from_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#bucket_from_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.bucket_from_pos" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Bucket a 0-based position index into the standard reporting bins.</p>
<p>Parameters</p>
<p>pos_idx:</p>
<blockquote>
<div><p>Zero-based position of the correct item within the retrieved slate.</p>
</div></blockquote>
<p>Returns</p>
<p>str</p>
<blockquote>
<div><p>One of <code class="docutils literal notranslate"><span class="pre">{&quot;unknown&quot;,</span> <span class="pre">&quot;1&quot;,</span> <span class="pre">&quot;2&quot;,</span> <span class="pre">&quot;3&quot;,</span> <span class="pre">&quot;4&quot;,</span> <span class="pre">&quot;5+&quot;}</span></code> describing the bucket.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pos_idx</strong> (<em>int</em>) – Position index being transformed into a categorical bucket.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Named bucket representing the supplied positional index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.canon">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">canon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#canon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.canon" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Canonicalise a text fragment by lowercasing and removing punctuation.</p>
<p>Parameters</p>
<p>text:</p>
<blockquote>
<div><p>Raw text fragment to normalize.</p>
</div></blockquote>
<p>Returns</p>
<p>str</p>
<blockquote>
<div><p>Canonical form suitable for equality comparisons.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Free-form text string that requires normalization.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Canonicalized text normalized for downstream processing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.compute_auc_from_curve">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">compute_auc_from_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#compute_auc_from_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.compute_auc_from_curve" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Compute the area under the accuracy-vs-<code class="docutils literal notranslate"><span class="pre">k</span></code> curve.</p>
<p>Parameters</p>
<p>k_values:</p>
<blockquote>
<div><p>Iterable of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p>
</div></blockquote>
<p>accuracy_by_k:</p>
<blockquote>
<div><p>Mapping from <code class="docutils literal notranslate"><span class="pre">k</span></code> to measured accuracy.</p>
</div></blockquote>
<p>Returns</p>
<p>tuple[float, float]</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">(auc_area,</span> <span class="pre">auc_normalized)</span></code> where <code class="docutils literal notranslate"><span class="pre">auc_area</span></code> is the trapezoidal</p>
<p>integral and <code class="docutils literal notranslate"><span class="pre">auc_normalized</span></code> scales the area by the extent of <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate or report.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Mapping from each <code class="docutils literal notranslate"><span class="pre">k</span></code> to its measured validation accuracy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Area-under-curve value computed from the accuracy trajectory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.evaluate_issue">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">evaluate_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue_slug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provenance</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#evaluate_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.evaluate_issue" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Evaluate a single issue slice and persist metrics, curves, and predictions.</p>
<p>Parameters</p>
<p>issue_slug:</p>
<blockquote>
<div><p>Normalised identifier for the issue under evaluation (used in paths).</p>
</div></blockquote>
<p>dataset_source:</p>
<blockquote>
<div><p>Name or path of the dataset backing the current run.</p>
</div></blockquote>
<p>train_ds:</p>
<blockquote>
<div><p>Training split (may be <code class="docutils literal notranslate"><span class="pre">None</span></code>) used for optional curve diagnostics.</p>
</div></blockquote>
<p>eval_ds:</p>
<blockquote>
<div><p>Evaluation split containing the rows scored for reporting.</p>
</div></blockquote>
<p>k_values:</p>
<blockquote>
<div><p>Sequence of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to consider when computing accuracy.</p>
</div></blockquote>
<p>knn_index:</p>
<blockquote>
<div><p>Prepared KNN index artefacts for the active feature space.</p>
</div></blockquote>
<p>extra_fields:</p>
<blockquote>
<div><p>Additional text fields concatenated into the query document.</p>
</div></blockquote>
<p>feature_space:</p>
<blockquote>
<div><p>Feature space identifier (<code class="docutils literal notranslate"><span class="pre">tfidf</span></code>, <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>, or <code class="docutils literal notranslate"><span class="pre">sentence_transformer</span></code>).</p>
</div></blockquote>
<p>args:</p>
<blockquote>
<div><p>Parsed CLI namespace controlling evaluation behavior.</p>
</div></blockquote>
<p>provenance:</p>
<blockquote>
<div><p>Mapping of provenance metadata recorded alongside the metrics.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>issue_slug</strong> (<em>str</em>) – Slugified identifier representing the study/issue on disk.</p></li>
<li><p><strong>dataset_source</strong> (<em>str</em>) – Identifier describing where the dataset was loaded from.</p></li>
<li><p><strong>train_ds</strong> (<em>Any</em>) – Training dataset split used to build the index.</p></li>
<li><p><strong>eval_ds</strong> (<em>Any</em>) – Evaluation dataset split passed to the scorer.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate or report.</p></li>
<li><p><strong>knn_index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Fitted KNN index used to score neighbours.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Additional dataset columns included when building prompts or outputs.</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier such as <code class="docutils literal notranslate"><span class="pre">tfidf</span></code> or <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>.</p></li>
<li><p><strong>args</strong> (<em>Any</em>) – Namespace object containing parsed command-line arguments.</p></li>
<li><p><strong>provenance</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Metadata describing how the evaluation artefacts were produced.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.parse_k_values">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">parse_k_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#parse_k_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.parse_k_values" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Derive the sorted set of <code class="docutils literal notranslate"><span class="pre">k</span></code> values requested for evaluation.</p>
<p>Parameters</p>
<p>k_default:</p>
<blockquote>
<div><p>The baseline <code class="docutils literal notranslate"><span class="pre">k</span></code> value supplied via the CLI (used when the sweep is empty).</p>
</div></blockquote>
<p>sweep:</p>
<blockquote>
<div><p>Comma-delimited string of additional <code class="docutils literal notranslate"><span class="pre">k</span></code> candidates provided by the user.</p>
</div></blockquote>
<p>Returns</p>
<p>list[int]</p>
<blockquote>
<div><p>Strictly positive <code class="docutils literal notranslate"><span class="pre">k</span></code> values in ascending order. Falls back to <code class="docutils literal notranslate"><span class="pre">k_default</span></code></p>
<p>(or <code class="docutils literal notranslate"><span class="pre">25</span></code> when unset) if the sweep does not contain any valid integers.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_default</strong> (<em>int</em>) – Fallback <code class="docutils literal notranslate"><span class="pre">k</span></code> value applied when no sweep result is available.</p></li>
<li><p><strong>sweep</strong> (<em>str</em>) – Sweep configuration or CLI payload under inspection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of unique <code class="docutils literal notranslate"><span class="pre">k</span></code> values parsed from the sweep specification.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.plot_elbow">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">plot_elbow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'validation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#plot_elbow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.plot_elbow" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Generate an error-rate plot to visualise the KNN elbow heuristic.</p>
<p>Parameters</p>
<p>k_values:</p>
<blockquote>
<div><p>Iterable of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p>
</div></blockquote>
<p>accuracy_by_k:</p>
<blockquote>
<div><p>Mapping from <code class="docutils literal notranslate"><span class="pre">k</span></code> to accuracy on the selected split.</p>
</div></blockquote>
<p>best_k:</p>
<blockquote>
<div><p>The configuration chosen for downstream reporting.</p>
</div></blockquote>
<p>output_path:</p>
<blockquote>
<div><p>Destination filename for the generated PNG.</p>
</div></blockquote>
<p>data_split:</p>
<blockquote>
<div><p>Human-readable label describing the evaluation split (defaults to <code class="docutils literal notranslate"><span class="pre">validation</span></code>).</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate or report.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Mapping from each <code class="docutils literal notranslate"><span class="pre">k</span></code> to its measured validation accuracy.</p></li>
<li><p><strong>best_k</strong> (<em>int</em>) – Neighborhood size selected as optimal for the evaluation.</p></li>
<li><p><strong>output_path</strong> (<em>Path</em>) – Filesystem path for the generated report or figure.</p></li>
<li><p><strong>data_split</strong> (<em>str</em>) – Name of the dataset split from which metrics were derived.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.resolve_reports_dir">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">resolve_reports_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#resolve_reports_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.resolve_reports_dir" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Resolve the canonical reports directory corresponding to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<p>Parameters</p>
<p>out_dir:</p>
<blockquote>
<div><p>Directory containing pipeline artefacts (typically under <code class="docutils literal notranslate"><span class="pre">models/knn</span></code>).</p>
</div></blockquote>
<p>Returns</p>
<p>pathlib.Path</p>
<blockquote>
<div><p>Path pointing at the root <code class="docutils literal notranslate"><span class="pre">reports</span></code> directory for the repository.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out_dir</strong> (<em>Path</em>) – Output directory receiving generated metrics and reports.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Directory path where the generated report files will be stored.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.run_eval">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.run_eval" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Evaluate the KNN baseline across the issues specified on the CLI.</p>
<p>Parameters</p>
<p>args:</p>
<blockquote>
<div><p>Namespace returned by <a class="reference internal" href="#knn.cli.build_parser" title="knn.cli.build_parser"><code class="xref py py-func docutils literal notranslate"><span class="pre">knn.cli.build_parser()</span></code></a>, including dataset,</p>
<p>feature-space, and sweep configuration.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Any</em>) – Namespace object containing parsed command-line arguments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.select_best_k">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">select_best_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/evaluate.html#select_best_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.select_best_k" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Choose an appropriate <code class="docutils literal notranslate"><span class="pre">k</span></code> by applying a simple elbow heuristic.</p>
<p>Parameters</p>
<p>k_values:</p>
<blockquote>
<div><p>Sorted sequence of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p>
</div></blockquote>
<p>accuracy_by_k:</p>
<blockquote>
<div><p>Observed accuracy for each <code class="docutils literal notranslate"><span class="pre">k</span></code> on the validation split.</p>
</div></blockquote>
<p>Returns</p>
<p>int</p>
<blockquote>
<div><p>The <code class="docutils literal notranslate"><span class="pre">k</span></code> value where marginal gains fall below half of the initial slope,</p>
<p>or the accuracy-maximizing <code class="docutils literal notranslate"><span class="pre">k</span></code> when the heuristic cannot be applied.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate or report.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Mapping from each <code class="docutils literal notranslate"><span class="pre">k</span></code> to its measured validation accuracy.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Neighborhood size that maximizes the provided accuracy scores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.opinion">Top-level orchestration helpers for the <code class="docutils literal notranslate"><span class="pre">clean_data</span></code> package.</p>
<p>This module stitches together the key pieces of the cleaning pipeline:
loading raw CodeOcean or Hugging Face datasets, filtering unusable rows,
converting interactions into prompt-ready examples, validating schema
requirements, saving artifacts, and dispatching prompt statistics reports.
It is the public surface that downstream tooling should import when they
need to build or persist cleaned prompt datasets. All functionality here is
distributed under the repository’s Apache 2.0 license; see LICENSE for
details.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.opinion.OpinionSpec">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/opinion.html#OpinionSpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.opinion.OpinionSpec" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration describing one study’s opinion index columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – Attribute <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p></li>
<li><p><strong>issue</strong> (<em>str</em>) – Attribute <code class="docutils literal notranslate"><span class="pre">issue</span></code>.</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Attribute <code class="docutils literal notranslate"><span class="pre">label</span></code>.</p></li>
<li><p><strong>before_column</strong> (<em>str</em>) – Attribute <code class="docutils literal notranslate"><span class="pre">before_column</span></code>.</p></li>
<li><p><strong>after_column</strong> (<em>str</em>) – Attribute <code class="docutils literal notranslate"><span class="pre">after_column</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>label</strong> (<em>str</em>)</p></li>
<li><p><strong>before_column</strong> (<em>str</em>)</p></li>
<li><p><strong>after_column</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.opinion.OpinionSpec.after_column">
<span class="sig-name descname"><span class="pre">after_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.opinion.OpinionSpec.after_column" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.opinion.OpinionSpec.before_column">
<span class="sig-name descname"><span class="pre">before_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.opinion.OpinionSpec.before_column" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.opinion.OpinionSpec.issue">
<span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.opinion.OpinionSpec.issue" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.opinion.OpinionSpec.key">
<span class="sig-name descname"><span class="pre">key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.opinion.OpinionSpec.key" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.opinion.OpinionSpec.label">
<span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.opinion.OpinionSpec.label" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.opinion.run_opinion_eval">
<span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">run_opinion_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/opinion.html#run_opinion_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.opinion.run_opinion_eval" title="Link to this definition">¶</a></dt>
<dd><p>Execute the post-study opinion index evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Any</em>) – Namespace object containing parsed command-line arguments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.cli">Top-level orchestration helpers for the <code class="docutils literal notranslate"><span class="pre">clean_data</span></code> package.</p>
<p>This module stitches together the key pieces of the cleaning pipeline:
loading raw CodeOcean or Hugging Face datasets, filtering unusable rows,
converting interactions into prompt-ready examples, validating schema
requirements, saving artifacts, and dispatching prompt statistics reports.
It is the public surface that downstream tooling should import when they
need to build or persist cleaned prompt datasets. All functionality here is
distributed under the repository’s Apache 2.0 license; see LICENSE for
details.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.build_parser">
<span class="sig-prename descclassname"><span class="pre">knn.cli.</span></span><span class="sig-name descname"><span class="pre">build_parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli.html#build_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.build_parser" title="Link to this definition">¶</a></dt>
<dd><p>Build the command-line parser that drives the refactored KNN workflows.</p>
<p>The parser exposes switches for both slate (next-video) and opinion
prediction flows, including feature-space selection, pre-computed index
reuse, bootstrap configuration, and Word2Vec/SentenceTransformer tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parser pre-populated with all supported CLI arguments for the KNN baseline.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>argparse.ArgumentParser</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.main">
<span class="sig-prename descclassname"><span class="pre">knn.cli.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.main" title="Link to this definition">¶</a></dt>
<dd><p>Dispatch execution for the CLI by parsing arguments and invoking the correct runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional argument vector supplied for testing. When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="xref py py-data docutils literal notranslate"><span class="pre">sys.argv</span></code> is used verbatim.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. The function delegates work to the slate or opinion pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">--task</span></code> is neither <code class="docutils literal notranslate"><span class="pre">slate</span></code> nor <code class="docutils literal notranslate"><span class="pre">opinion</span></code>.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gpt4o.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">GPT-4o Tools API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="prompt_builder.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Prompt Builder API</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, GRAIL Simulation Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">KNN Baseline API</a><ul>
<li><a class="reference internal" href="#feature-spaces">Feature Spaces</a></li>
<li><a class="reference internal" href="#elbow-curve-metrics">Elbow &amp; Curve Metrics</a><ul>
<li><a class="reference internal" href="#knn.data.filter_dataset_for_issue"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.filter_dataset_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.filter_split_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_split_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.issues_in_dataset"><code class="docutils literal notranslate"><span class="pre">issues_in_dataset()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.load_dataset_source"><code class="docutils literal notranslate"><span class="pre">load_dataset_source()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecConfig"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig</span></code></a><ul>
<li><a class="reference internal" href="#knn.features.Word2VecConfig.epochs"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.epochs</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecConfig.min_count"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.min_count</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecConfig.model_dir"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.model_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecConfig.seed"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.seed</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecConfig.vector_size"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.vector_size</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecConfig.window"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.window</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecConfig.workers"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.workers</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder</span></code></a><ul>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.encode"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.encode()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.is_trained"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.is_trained()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.load"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.load()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.save"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.save()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.train"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.train()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.transform"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.transform()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.features.assemble_document"><code class="docutils literal notranslate"><span class="pre">assemble_document()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.extract_now_watching"><code class="docutils literal notranslate"><span class="pre">extract_now_watching()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.extract_slate_items"><code class="docutils literal notranslate"><span class="pre">extract_slate_items()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prepare_training_documents"><code class="docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prompt_from_builder"><code class="docutils literal notranslate"><span class="pre">prompt_from_builder()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.title_for"><code class="docutils literal notranslate"><span class="pre">title_for()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.viewer_profile_sentence"><code class="docutils literal notranslate"><span class="pre">viewer_profile_sentence()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">build_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_tfidf_index"><code class="docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_word2vec_index"><code class="docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.knn_predict_among_slate_multi"><code class="docutils literal notranslate"><span class="pre">knn_predict_among_slate_multi()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">load_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_tfidf_index"><code class="docutils literal notranslate"><span class="pre">load_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_word2vec_index"><code class="docutils literal notranslate"><span class="pre">load_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_tfidf_index"><code class="docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_word2vec_index"><code class="docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.bin_nopts"><code class="docutils literal notranslate"><span class="pre">bin_nopts()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.bucket_from_pos"><code class="docutils literal notranslate"><span class="pre">bucket_from_pos()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.canon"><code class="docutils literal notranslate"><span class="pre">canon()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.compute_auc_from_curve"><code class="docutils literal notranslate"><span class="pre">compute_auc_from_curve()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.evaluate_issue"><code class="docutils literal notranslate"><span class="pre">evaluate_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.parse_k_values"><code class="docutils literal notranslate"><span class="pre">parse_k_values()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.plot_elbow"><code class="docutils literal notranslate"><span class="pre">plot_elbow()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.resolve_reports_dir"><code class="docutils literal notranslate"><span class="pre">resolve_reports_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.run_eval"><code class="docutils literal notranslate"><span class="pre">run_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.select_best_k"><code class="docutils literal notranslate"><span class="pre">select_best_k()</span></code></a></li>
<li><a class="reference internal" href="#knn.opinion.OpinionSpec"><code class="docutils literal notranslate"><span class="pre">OpinionSpec</span></code></a><ul>
<li><a class="reference internal" href="#knn.opinion.OpinionSpec.after_column"><code class="docutils literal notranslate"><span class="pre">OpinionSpec.after_column</span></code></a></li>
<li><a class="reference internal" href="#knn.opinion.OpinionSpec.before_column"><code class="docutils literal notranslate"><span class="pre">OpinionSpec.before_column</span></code></a></li>
<li><a class="reference internal" href="#knn.opinion.OpinionSpec.issue"><code class="docutils literal notranslate"><span class="pre">OpinionSpec.issue</span></code></a></li>
<li><a class="reference internal" href="#knn.opinion.OpinionSpec.key"><code class="docutils literal notranslate"><span class="pre">OpinionSpec.key</span></code></a></li>
<li><a class="reference internal" href="#knn.opinion.OpinionSpec.label"><code class="docutils literal notranslate"><span class="pre">OpinionSpec.label</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.opinion.run_opinion_eval"><code class="docutils literal notranslate"><span class="pre">run_opinion_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.cli.build_parser"><code class="docutils literal notranslate"><span class="pre">build_parser()</span></code></a></li>
<li><a class="reference internal" href="#knn.cli.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>