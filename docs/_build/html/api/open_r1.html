<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="XGBoost Baseline API" href="xgb.html"><link rel="prev" title="GPT-4o Tools API" href="gpt4o.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Open-R1 Training API - GRAIL Simulation documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #1f4b8e;
  --color-brand-content: #1f4b8e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">GRAIL Simulation  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">GRAIL Simulation  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Utilities API</a></li>
<li class="toctree-l1"><a class="reference internal" href="clean_data.html">Clean Data Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="prompt_builder.html">Prompt Builder API</a></li>
<li class="toctree-l1"><a class="reference internal" href="knn.html">KNN Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpt4o.html">GPT-4o Tools API</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Open-R1 Training API</a></li>
<li class="toctree-l1"><a class="reference internal" href="xgb.html">XGBoost Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reports/index.html">Reports</a><input aria-label="Toggle navigation of Reports" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_stats.html">Prompt feature report</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_builder.html">Prompt Builder Sample Prompts</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/knn.html">KNN Report Catalog</a><input aria-label="Toggle navigation of KNN Report Catalog" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_next_video.html">KNN Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion.html">KNN Opinion Shift Study</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_hyperparameter_tuning.html">KNN Hyperparameter Tuning Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reports/research_article_political_sciences.html">RESEARCH ARTICLE POLITICAL SCIENCES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/visualized_recommendation_trees.html">Visualized Recommendation Trees</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/open_r1.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="open-r1-training-api">
<h1>Open-R1 Training API<a class="headerlink" href="#open-r1-training-api" title="Link to this heading">¶</a></h1>
<p>The <a class="reference internal" href="#module-open_r1" title="open_r1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">open_r1</span></code></a> package hosts reinforcement learning pipelines for
GRAIL’s Open R1 experiments along with a suite of utilities for data
loading, rollout orchestration, and evaluation.  Use the modules below
to explore the available configuration surfaces and helper tooling.</p>
<section id="module-open_r1">
<span id="core-modules"></span><h2>Core Modules<a class="headerlink" href="#module-open_r1" title="Link to this heading">¶</a></h2>
<p>Reinforcement-learning tooling for the GRAIL simulation project.</p>
<p id="module-open_r1.configs">Configuration helpers for open_r1 training scripts.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.configs.DatasetConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.configs.</span></span><span class="sig-name descname"><span class="pre">DatasetConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/configs.html#DatasetConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.configs.DatasetConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for a dataset in a mixture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>str</em>)</p></li>
<li><p><strong>config</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>split</strong> (<em>str</em>)</p></li>
<li><p><strong>columns</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>weight</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetConfig.columns">
<span class="sig-name descname"><span class="pre">columns</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.DatasetConfig.columns" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetConfig.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.DatasetConfig.config" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetConfig.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#open_r1.configs.DatasetConfig.id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetConfig.split">
<span class="sig-name descname"><span class="pre">split</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'train'</span></em><a class="headerlink" href="#open_r1.configs.DatasetConfig.split" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetConfig.weight">
<span class="sig-name descname"><span class="pre">weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.DatasetConfig.weight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.configs.DatasetMixtureConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.configs.</span></span><span class="sig-name descname"><span class="pre">DatasetMixtureConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datasets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_split_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/configs.html#DatasetMixtureConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.configs.DatasetMixtureConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for a mixture of datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datasets</strong> (<em>list</em><em>[</em><a class="reference internal" href="#open_r1.configs.DatasetConfig" title="open_r1.configs.DatasetConfig"><em>DatasetConfig</em></a><em>]</em>)</p></li>
<li><p><strong>seed</strong> (<em>int</em>)</p></li>
<li><p><strong>test_split_size</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetMixtureConfig.datasets">
<span class="sig-name descname"><span class="pre">datasets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#open_r1.configs.DatasetConfig" title="open_r1.configs.DatasetConfig"><span class="pre">DatasetConfig</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#open_r1.configs.DatasetMixtureConfig.datasets" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetMixtureConfig.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#open_r1.configs.DatasetMixtureConfig.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.DatasetMixtureConfig.test_split_size">
<span class="sig-name descname"><span class="pre">test_split_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.DatasetMixtureConfig.test_split_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.configs.</span></span><span class="sig-name descname"><span class="pre">GRPOConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmarks=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chat_template=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hub_model_revision='main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_completions_to_print=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_hub_revision=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">push_to_hub_revision=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_prompt=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_log_unique_prompts=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_entity=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_project=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_run_group=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/configs.html#GRPOConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.configs.GRPOConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GRPOConfig</span></code></p>
<p>Arguments for callbacks, benchmarks, and related settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>benchmarks</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>callbacks</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>chat_template</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>hub_model_revision</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>num_completions_to_print</strong> (<em>int</em>)</p></li>
<li><p><strong>overwrite_hub_revision</strong> (<em>bool</em>)</p></li>
<li><p><strong>push_to_hub_revision</strong> (<em>bool</em>)</p></li>
<li><p><strong>system_prompt</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>wandb_log_unique_prompts</strong> (<em>bool</em>)</p></li>
<li><p><strong>wandb_entity</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>wandb_project</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>wandb_run_group</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.benchmarks">
<span class="sig-name descname"><span class="pre">benchmarks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.benchmarks" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.callbacks">
<span class="sig-name descname"><span class="pre">callbacks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.callbacks" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.chat_template">
<span class="sig-name descname"><span class="pre">chat_template</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.chat_template" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.hub_model_revision">
<span class="sig-name descname"><span class="pre">hub_model_revision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'main'</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.hub_model_revision" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.num_completions_to_print">
<span class="sig-name descname"><span class="pre">num_completions_to_print</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.num_completions_to_print" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.overwrite_hub_revision">
<span class="sig-name descname"><span class="pre">overwrite_hub_revision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.overwrite_hub_revision" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.push_to_hub_revision">
<span class="sig-name descname"><span class="pre">push_to_hub_revision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.push_to_hub_revision" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.system_prompt">
<span class="sig-name descname"><span class="pre">system_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.system_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.wandb_entity">
<span class="sig-name descname"><span class="pre">wandb_entity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.wandb_entity" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.wandb_log_unique_prompts">
<span class="sig-name descname"><span class="pre">wandb_log_unique_prompts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.wandb_log_unique_prompts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.wandb_project">
<span class="sig-name descname"><span class="pre">wandb_project</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.wandb_project" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOConfig.wandb_run_group">
<span class="sig-name descname"><span class="pre">wandb_run_group</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.GRPOConfig.wandb_run_group" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.configs.</span></span><span class="sig-name descname"><span class="pre">GRPOScriptArguments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_mixture=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_funcs=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_min_value_wrong=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_max_value_wrong=-0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_min_value_correct=0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_max_value_correct=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosine_max_len=1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repetition_n_grams=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repetition_max_penalty=-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code_language='python'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code_eval_test_batch_size=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code_eval_scoring_mode='weighted_sum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel_code_exec_per_proc=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_prompt_column='problem'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_solution_column='answer'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2b_router_url=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph_router_url=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code_provider='e2b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ioi_provider='piston'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_completion_len=16384</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_punish_cache=4096</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_kl_target=0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_kl_beta0=0.12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_kl_horizon=10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/configs.html#GRPOScriptArguments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#open_r1.configs.ScriptArguments" title="open_r1.configs.ScriptArguments"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptArguments</span></code></a></p>
<p>Script arguments for the GRPO training script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reward_funcs</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of reward functions. Possible values: <code class="docutils literal notranslate"><span class="pre">&quot;accuracy&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;format&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;reasoning_steps&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cosine&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;repetition_penalty&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;length&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;tag_count&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;code&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ioi_code&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;code_format&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;soft_overlong_punishment&quot;</span></code>.</p></li>
<li><p><strong>cosine_min_value_wrong</strong> (<em>float</em>) – Minimum reward for cosine scaling for wrong answers.</p></li>
<li><p><strong>cosine_max_value_wrong</strong> (<em>float</em>) – Maximum reward for cosine scaling for wrong answers.</p></li>
<li><p><strong>cosine_min_value_correct</strong> (<em>float</em>) – Minimum reward for cosine scaling for correct answers.</p></li>
<li><p><strong>cosine_max_value_correct</strong> (<em>float</em>) – Maximum reward for cosine scaling for correct answers.</p></li>
<li><p><strong>cosine_max_len</strong> (<em>int</em>) – Maximum length for cosine scaling.</p></li>
<li><p><strong>code_language</strong> (<em>str</em>) – Language for the code format reward.</p></li>
<li><p><strong>max_completion_len</strong> (<em>int</em>) – Maximum number of tokens in a completion.</p></li>
<li><p><strong>soft_punish_cache</strong> (<em>int</em>) – Minimum number of tokens in a completion before the hard penalty applies.</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>dataset_mixture</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>repetition_n_grams</strong> (<em>int</em>)</p></li>
<li><p><strong>repetition_max_penalty</strong> (<em>float</em>)</p></li>
<li><p><strong>code_eval_test_batch_size</strong> (<em>int</em>)</p></li>
<li><p><strong>code_eval_scoring_mode</strong> (<em>Literal</em><em>[</em><em>'pass_fail'</em><em>, </em><em>'partial'</em><em>, </em><em>'weighted_sum'</em><em>]</em>)</p></li>
<li><p><strong>parallel_code_exec_per_proc</strong> (<em>int</em>)</p></li>
<li><p><strong>dataset_prompt_column</strong> (<em>str</em>)</p></li>
<li><p><strong>dataset_solution_column</strong> (<em>str</em>)</p></li>
<li><p><strong>e2b_router_url</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>morph_router_url</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>code_provider</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>ioi_provider</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>span_kl_target</strong> (<em>float</em>)</p></li>
<li><p><strong>span_kl_beta0</strong> (<em>float</em>)</p></li>
<li><p><strong>span_kl_horizon</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.code_eval_scoring_mode">
<span class="sig-name descname"><span class="pre">code_eval_scoring_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'pass_fail'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'partial'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'weighted_sum'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'weighted_sum'</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.code_eval_scoring_mode" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.code_eval_test_batch_size">
<span class="sig-name descname"><span class="pre">code_eval_test_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.code_eval_test_batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.code_language">
<span class="sig-name descname"><span class="pre">code_language</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'python'</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.code_language" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.code_provider">
<span class="sig-name descname"><span class="pre">code_provider</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'e2b'</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.code_provider" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.cosine_max_len">
<span class="sig-name descname"><span class="pre">cosine_max_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.cosine_max_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.cosine_max_value_correct">
<span class="sig-name descname"><span class="pre">cosine_max_value_correct</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.cosine_max_value_correct" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.cosine_max_value_wrong">
<span class="sig-name descname"><span class="pre">cosine_max_value_wrong</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-0.5</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.cosine_max_value_wrong" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.cosine_min_value_correct">
<span class="sig-name descname"><span class="pre">cosine_min_value_correct</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.5</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.cosine_min_value_correct" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.cosine_min_value_wrong">
<span class="sig-name descname"><span class="pre">cosine_min_value_wrong</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.cosine_min_value_wrong" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.dataset_prompt_column">
<span class="sig-name descname"><span class="pre">dataset_prompt_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'problem'</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.dataset_prompt_column" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.dataset_solution_column">
<span class="sig-name descname"><span class="pre">dataset_solution_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'answer'</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.dataset_solution_column" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.e2b_router_url">
<span class="sig-name descname"><span class="pre">e2b_router_url</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.e2b_router_url" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.ioi_provider">
<span class="sig-name descname"><span class="pre">ioi_provider</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'piston'</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.ioi_provider" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.max_completion_len">
<span class="sig-name descname"><span class="pre">max_completion_len</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16384</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.max_completion_len" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.morph_router_url">
<span class="sig-name descname"><span class="pre">morph_router_url</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.morph_router_url" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.parallel_code_exec_per_proc">
<span class="sig-name descname"><span class="pre">parallel_code_exec_per_proc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.parallel_code_exec_per_proc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.repetition_max_penalty">
<span class="sig-name descname"><span class="pre">repetition_max_penalty</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1.0</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.repetition_max_penalty" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.repetition_n_grams">
<span class="sig-name descname"><span class="pre">repetition_n_grams</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.repetition_n_grams" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.reward_funcs">
<span class="sig-name descname"><span class="pre">reward_funcs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.reward_funcs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.soft_punish_cache">
<span class="sig-name descname"><span class="pre">soft_punish_cache</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4096</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.soft_punish_cache" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.span_kl_beta0">
<span class="sig-name descname"><span class="pre">span_kl_beta0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.12</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.span_kl_beta0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.span_kl_horizon">
<span class="sig-name descname"><span class="pre">span_kl_horizon</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10000</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.span_kl_horizon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.GRPOScriptArguments.span_kl_target">
<span class="sig-name descname"><span class="pre">span_kl_target</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.05</span></em><a class="headerlink" href="#open_r1.configs.GRPOScriptArguments.span_kl_target" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.configs.</span></span><span class="sig-name descname"><span class="pre">SFTConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmarks=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chat_template=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_prompt=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hub_model_revision='main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_hub_revision=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">push_to_hub_revision=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_entity=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_project=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_run_group=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/configs.html#SFTConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.configs.SFTConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">SFTConfig</span></code></p>
<p>Arguments for callbacks, benchmarks, and related settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>benchmarks</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>callbacks</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>chat_template</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>system_prompt</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>hub_model_revision</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>overwrite_hub_revision</strong> (<em>bool</em>)</p></li>
<li><p><strong>push_to_hub_revision</strong> (<em>bool</em>)</p></li>
<li><p><strong>wandb_entity</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>wandb_project</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>wandb_run_group</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.benchmarks">
<span class="sig-name descname"><span class="pre">benchmarks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.benchmarks" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.callbacks">
<span class="sig-name descname"><span class="pre">callbacks</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.callbacks" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.chat_template">
<span class="sig-name descname"><span class="pre">chat_template</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.chat_template" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.hub_model_revision">
<span class="sig-name descname"><span class="pre">hub_model_revision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'main'</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.hub_model_revision" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.overwrite_hub_revision">
<span class="sig-name descname"><span class="pre">overwrite_hub_revision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.overwrite_hub_revision" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.push_to_hub_revision">
<span class="sig-name descname"><span class="pre">push_to_hub_revision</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.push_to_hub_revision" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.system_prompt">
<span class="sig-name descname"><span class="pre">system_prompt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.system_prompt" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.wandb_entity">
<span class="sig-name descname"><span class="pre">wandb_entity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.wandb_entity" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.wandb_project">
<span class="sig-name descname"><span class="pre">wandb_project</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.wandb_project" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.SFTConfig.wandb_run_group">
<span class="sig-name descname"><span class="pre">wandb_run_group</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.SFTConfig.wandb_run_group" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.configs.ScriptArguments">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.configs.</span></span><span class="sig-name descname"><span class="pre">ScriptArguments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_mixture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/configs.html#ScriptArguments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.configs.ScriptArguments" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ScriptArguments</span></code></p>
<p>Extended version of ScriptArguments with support for dataset mixtures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_mixture</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>] </em><em>| </em><em>None</em>) – <p>Configuration for creating dataset mixtures with advanced
options. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_mixture</span><span class="p">:</span>
  <span class="n">datasets</span><span class="p">:</span>
    <span class="o">-</span> <span class="nb">id</span><span class="p">:</span> <span class="n">dataset_id1</span>
      <span class="n">config</span><span class="p">:</span> <span class="n">config_name</span>
      <span class="n">columns</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">col1</span>
        <span class="o">-</span> <span class="n">col2</span>
      <span class="n">weight</span><span class="p">:</span> <span class="mf">0.5</span>
    <span class="o">-</span> <span class="nb">id</span><span class="p">:</span> <span class="n">dataset_id2</span>
      <span class="n">config</span><span class="p">:</span> <span class="n">config_name</span>
      <span class="n">columns</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">col1</span>
        <span class="o">-</span> <span class="n">col2</span>
      <span class="n">weight</span><span class="p">:</span> <span class="mf">0.5</span>
  <span class="n">seed</span><span class="p">:</span> <span class="mi">42</span>
  <span class="n">test_split_size</span><span class="p">:</span> <span class="mf">0.1</span>
</pre></div>
</div>
</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.ScriptArguments.dataset_mixture">
<span class="sig-name descname"><span class="pre">dataset_mixture</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.ScriptArguments.dataset_mixture" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.configs.ScriptArguments.dataset_name">
<span class="sig-name descname"><span class="pre">dataset_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#open_r1.configs.ScriptArguments.dataset_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-open_r1.generate">Utilities for constructing distilabel pipelines for data generation.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.generate.build_distilabel_pipeline">
<span class="sig-prename descclassname"><span class="pre">open_r1.generate.</span></span><span class="sig-name descname"><span class="pre">build_distilabel_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'http://localhost:8000/v1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prompt_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prompt_template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'{{</span> <span class="pre">instruction</span> <span class="pre">}}'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_new_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_generations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_replicas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">900</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/generate.html#build_distilabel_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.generate.build_distilabel_pipeline" title="Link to this definition">¶</a></dt>
<dd><p>Construct a distilabel pipeline configured for OpenAI-compatible endpoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em>)</p></li>
<li><p><strong>base_url</strong> (<em>str</em>)</p></li>
<li><p><strong>prompt_column</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>prompt_template</strong> (<em>str</em>)</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>top_p</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>max_new_tokens</strong> (<em>int</em>)</p></li>
<li><p><strong>num_generations</strong> (<em>int</em>)</p></li>
<li><p><strong>input_batch_size</strong> (<em>int</em>)</p></li>
<li><p><strong>client_replicas</strong> (<em>int</em>)</p></li>
<li><p><strong>timeout</strong> (<em>int</em>)</p></li>
<li><p><strong>retries</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>distilabel.pipeline.Pipeline</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.grail">GRPO training entrypoint with optional discriminator (GAIL-style) shaping.</p>
<p>This variant mirrors the standard GRPO pipeline but can append an auxiliary
reward derived from a learned discriminator when $GAIL_USE=1. The underlying
user prompt construction is shared with <cite>open_r1.grpo</cite> through the
<cite>prompt_builder</cite> utilities.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.grail.OnlineDiscriminator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.grail.</span></span><span class="sig-name descname"><span class="pre">OnlineDiscriminator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/grail.html#OnlineDiscriminator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.grail.OnlineDiscriminator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Lightweight text classifier trained on-policy to supply optional GAIL rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>)</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>)</p></li>
<li><p><strong>lr</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.grail.OnlineDiscriminator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/grail.html#OnlineDiscriminator.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.grail.OnlineDiscriminator.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the discriminator with the specified pretrained backbone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>) – Hugging Face model identifier for the classifier.</p></li>
<li><p><strong>device</strong> (<em>torch.device</em>) – Torch device where the model should live.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – Learning rate used for the discriminator optimiser.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.grail.OnlineDiscriminator.prob_positive">
<span class="sig-name descname"><span class="pre">prob_positive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">texts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.grail.OnlineDiscriminator.prob_positive" title="Link to this definition">¶</a></dt>
<dd><p>Return the positive-class probability for each input string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>texts</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.grail.OnlineDiscriminator.train_batch">
<span class="sig-name descname"><span class="pre">train_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">texts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/grail.html#OnlineDiscriminator.train_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.grail.OnlineDiscriminator.train_batch" title="Link to this definition">¶</a></dt>
<dd><p>Perform one gradient step on the discriminator; returns the loss for logging.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>texts</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>labels</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.grail.</span></span><span class="sig-name descname"><span class="pre">RewardContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">policy_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_valid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chosen_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">viewer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gold_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gold_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/grail.html#RewardContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.grail.RewardContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>Container for discriminator training data extracted from GRPO completions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy_text</strong> (<em>str</em>)</p></li>
<li><p><strong>is_valid</strong> (<em>bool</em>)</p></li>
<li><p><strong>chosen_index</strong> (<em>int</em>)</p></li>
<li><p><strong>viewer</strong> (<em>str</em>)</p></li>
<li><p><strong>state</strong> (<em>str</em>)</p></li>
<li><p><strong>items</strong> (<em>List</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>gold_id</strong> (<em>str</em>)</p></li>
<li><p><strong>gold_index</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.chosen_index">
<span class="sig-name descname"><span class="pre">chosen_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#open_r1.grail.RewardContext.chosen_index" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.gold_id">
<span class="sig-name descname"><span class="pre">gold_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#open_r1.grail.RewardContext.gold_id" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.gold_index">
<span class="sig-name descname"><span class="pre">gold_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#open_r1.grail.RewardContext.gold_index" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.is_valid">
<span class="sig-name descname"><span class="pre">is_valid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#open_r1.grail.RewardContext.is_valid" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.items">
<span class="sig-name descname"><span class="pre">items</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#open_r1.grail.RewardContext.items" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.policy_text">
<span class="sig-name descname"><span class="pre">policy_text</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#open_r1.grail.RewardContext.policy_text" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.state">
<span class="sig-name descname"><span class="pre">state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#open_r1.grail.RewardContext.state" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.grail.RewardContext.viewer">
<span class="sig-name descname"><span class="pre">viewer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#open_r1.grail.RewardContext.viewer" title="Link to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.grail.get_peft_config">
<span class="sig-prename descclassname"><span class="pre">open_r1.grail.</span></span><span class="sig-name descname"><span class="pre">get_peft_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.grail.get_peft_config" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.grail.main">
<span class="sig-prename descclassname"><span class="pre">open_r1.grail.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/grail.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.grail.main" title="Link to this definition">¶</a></dt>
<dd><p>Launch the GRPO + optional GAIL training loop with the configured rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>script_args</strong> (<a class="reference internal" href="#open_r1.configs.GRPOScriptArguments" title="open_r1.configs.GRPOScriptArguments"><em>GRPOScriptArguments</em></a>)</p></li>
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>)</p></li>
<li><p><strong>model_args</strong> (<em>ModelConfig</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.grail.make_gail_reward_fn">
<span class="sig-prename descclassname"><span class="pre">open_r1.grail.</span></span><span class="sig-name descname"><span class="pre">make_gail_reward_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">disc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/grail.html#make_gail_reward_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.grail.make_gail_reward_fn" title="Link to this definition">¶</a></dt>
<dd><p>Wrap discriminator scores so they plug into the GRPO reward interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>disc</strong> (<a class="reference internal" href="#open_r1.grail.OnlineDiscriminator" title="open_r1.grail.OnlineDiscriminator"><em>OnlineDiscriminator</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>alpha</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.grpo">Standard GRPO training entrypoint for the GRAIL simulation dataset.</p>
<p>This variant performs vanilla GRPO without any discriminator shaping. It relies
solely on reward functions specified in the recipe YAML and uses the shared
prompt-builder utilities to render user messages from dataset columns.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.grpo.get_peft_config">
<span class="sig-prename descclassname"><span class="pre">open_r1.grpo.</span></span><span class="sig-name descname"><span class="pre">get_peft_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.grpo.get_peft_config" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.grpo.main">
<span class="sig-prename descclassname"><span class="pre">open_r1.grpo.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/grpo.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.grpo.main" title="Link to this definition">¶</a></dt>
<dd><p>Orchestrate dataset preparation, trainer construction, and the training loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>script_args</strong> (<a class="reference internal" href="#open_r1.configs.GRPOScriptArguments" title="open_r1.configs.GRPOScriptArguments"><em>GRPOScriptArguments</em></a>)</p></li>
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>)</p></li>
<li><p><strong>model_args</strong> (<em>ModelConfig</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.rewards">Reward functions for GRPO training.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.accuracy_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">accuracy_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#accuracy_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.accuracy_reward" title="Link to this definition">¶</a></dt>
<dd><p>Reward function that checks if a completion matches the ground truth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>completions</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>solution</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[float | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.binary_code_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">binary_code_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provider_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'e2b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_same_language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#binary_code_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.binary_code_reward" title="Link to this definition">¶</a></dt>
<dd><p>Convert execution rewards into binary success scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_parallel</strong> (<em>int</em>)</p></li>
<li><p><strong>provider_type</strong> (<em>str</em>)</p></li>
<li><p><strong>enforce_same_language</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[float | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.code_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">code_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provider_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'e2b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_same_language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#code_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.code_reward" title="Link to this definition">¶</a></dt>
<dd><p>Reward function that evaluates code snippets using a code execution provider.</p>
<p>Assumes the dataset contains a <cite>verification_info</cite> column with test cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>completions</strong> (<em>list</em><em>[</em><em>Any</em><em>]</em>) – List of model completions to evaluate.</p></li>
<li><p><strong>num_parallel</strong> (<em>int</em>) – Number of parallel code executions.</p></li>
<li><p><strong>provider_type</strong> (<em>str</em>) – Code execution provider to use (default <code class="docutils literal notranslate"><span class="pre">&quot;e2b&quot;</span></code>).</p></li>
<li><p><strong>enforce_same_language</strong> (<em>bool</em>) – Whether to verify all problems share the same language.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional arguments passed to the verification layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reward values for each completion.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.extract_code">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">extract_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'python'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#extract_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.extract_code" title="Link to this definition">¶</a></dt>
<dd><p>Return the last fenced code block for the requested language.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>completion</strong> (<em>str</em>)</p></li>
<li><p><strong>language</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.format_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">format_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">answer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#format_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.format_reward" title="Link to this definition">¶</a></dt>
<dd><p>Return the usual format reward only if the sample’s accuracy reward is 0.
Works with either <cite>solution=[…]</cite> or <cite>answer=[…]</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>completions</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>dict</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>solution</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>answer</strong> (<em>List</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List</em>[float | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.formating">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">formating</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#formating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.formating" title="Link to this definition">¶</a></dt>
<dd><p>Check whether completions follow the expected think/answer tag format.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.get_code_format_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">get_code_format_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'python'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#get_code_format_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.get_code_format_reward" title="Link to this definition">¶</a></dt>
<dd><p>Format reward function specifically for code responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>language</strong> (<em>str</em>) – Programming language supported by E2B.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reward function that checks the language-specific format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[list[Any]], list[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.get_cosine_scaled_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">get_cosine_scaled_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_value_wrong</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value_wrong</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_value_correct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_value_correct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_len</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#get_cosine_scaled_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.get_cosine_scaled_reward" title="Link to this definition">¶</a></dt>
<dd><p>Create a cosine-scaled reward function parameterised by length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_value_wrong</strong> (<em>float</em>)</p></li>
<li><p><strong>max_value_wrong</strong> (<em>float</em>)</p></li>
<li><p><strong>min_value_correct</strong> (<em>float</em>)</p></li>
<li><p><strong>max_value_correct</strong> (<em>float</em>)</p></li>
<li><p><strong>max_len</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.get_repetition_penalty_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">get_repetition_penalty_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ngram_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_penalty</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'en'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#get_repetition_penalty_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.get_repetition_penalty_reward" title="Link to this definition">¶</a></dt>
<dd><p>Compute an n‑gram repetition penalty (Appendix C.2 of
<a class="reference external" href="https://huggingface.co/papers/2502.03373">https://huggingface.co/papers/2502.03373</a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ngram_size</strong> (<em>int</em>) – Size of the n-grams to inspect.</p></li>
<li><p><strong>max_penalty</strong> (<em>float</em>) – Most negative reward; must be ≤ 0.</p></li>
<li><p><strong>language</strong> (<em>str</em>) – <code class="docutils literal notranslate"><span class="pre">&quot;en&quot;</span></code> (whitespace split) or <code class="docutils literal notranslate"><span class="pre">&quot;zh&quot;</span></code> (jieba split).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function that scores completions with the configured repetition penalty.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[list[Any]], list[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.get_reward_funcs">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">get_reward_funcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">script_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_ref_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#get_reward_funcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.get_reward_funcs" title="Link to this definition">¶</a></dt>
<dd><p>Assemble the reward functions requested by the training script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>_ref_model</strong> (<em>transformers.PreTrainedModel</em>)</p></li>
<li><p><strong>_tokenizer</strong> (<em>transformers.PreTrainedTokenizerBase</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[<em>Callable</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.get_soft_overlong_punishment">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">get_soft_overlong_punishment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_completion_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft_punish_cache</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#get_soft_overlong_punishment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.get_soft_overlong_punishment" title="Link to this definition">¶</a></dt>
<dd><p>Penalise overlong completions without rewarding shorter ones.</p>
<p>Reference: Eq. (13) from the DAPO paper
(<a class="reference external" href="https://huggingface.co/papers/2503.14476">https://huggingface.co/papers/2503.14476</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_completion_len</strong> (<em>int</em>) – Maximum allowed completion length.</p></li>
<li><p><strong>soft_punish_cache</strong> (<em>int</em>) – Buffer length before the hard penalty applies.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reward function that softly penalises long completions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[list[list[int]]], list[float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.ioi_code_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">ioi_code_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">provider_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'piston'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#ioi_code_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.ioi_code_reward" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate IOI problems using the configured execution client.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_batch_size</strong> (<em>int</em>)</p></li>
<li><p><strong>provider_type</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.len_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">len_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#len_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.len_reward" title="Link to this definition">¶</a></dt>
<dd><p>Compute length-based rewards to discourage overthinking and promote token efficiency.</p>
<p>Taken from the Kimi 1.5 tech report: <a class="reference external" href="https://huggingface.co/papers/2501.12599">https://huggingface.co/papers/2501.12599</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>completions</strong> (<em>list</em><em>[</em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – List of model completions.</p></li>
<li><p><strong>solution</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of ground truth solutions.</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional keyword arguments (unused).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of rewards where:
- For correct answers: reward = 0.5 - (len - min_len)/(max_len - min_len)
- For incorrect answers: reward = min(0, 0.5 - (len - min_len)/(max_len - min_len))</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.pure_accuracy_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">pure_accuracy_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_answer</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#pure_accuracy_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.pure_accuracy_reward" title="Link to this definition">¶</a></dt>
<dd><p>Score completions using index-only accuracy.</p>
<p>Steps:</p>
<ol class="arabic simple">
<li><p>Parse the numeric answer from <code class="docutils literal notranslate"><span class="pre">&lt;answer&gt;…&lt;/answer&gt;</span></code> blocks (or bare numbers when
the <code class="docutils literal notranslate"><span class="pre">PUREACC_ALLOW_BARE_NUMBER</span></code> environment flag is enabled).</p></li>
<li><p>Compare the parsed value to <code class="docutils literal notranslate"><span class="pre">gold_index</span></code> (1-based).</p></li>
<li><p>Optionally ensure <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">NUMBER</span> <span class="pre">&lt;=</span> <span class="pre">n_options</span></code> if option counts are provided.</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Per-sample accuracy scores (<code class="docutils literal notranslate"><span class="pre">1.0</span></code> or <code class="docutils literal notranslate"><span class="pre">0.0</span></code>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[float]</p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>completions</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em>)</p></li>
<li><p><strong>_answer</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.reasoning_steps_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">reasoning_steps_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#reasoning_steps_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.reasoning_steps_reward" title="Link to this definition">¶</a></dt>
<dd><p>Reward function that checks for clear step-by-step reasoning.</p>
<dl class="simple">
<dt>Regex pattern:</dt><dd><p>Step d+:  matches “Step 1:”, “Step 2:”, etc.
^d+.     matches numbered lists like “1.”, “2.”, etc. at line start
n-        matches bullet points with hyphens
n*       matches bullet points with asterisks
First,|Second,|Next,|Finally,  matches transition words</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.rewards.tag_count_reward">
<span class="sig-prename descclassname"><span class="pre">open_r1.rewards.</span></span><span class="sig-name descname"><span class="pre">tag_count_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">completions</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/rewards.html#tag_count_reward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.rewards.tag_count_reward" title="Link to this definition">¶</a></dt>
<dd><p>Reward function that checks if we produce the desired number of think and
answer tags associated with <cite>format_reward()</cite>.</p>
<p>Adapted from:
<a class="reference external" href="https://gist.github.com/willccbb/4676755236bb08cab5f4e54a0475d6fb#file-grpo_demo-py-L90">https://gist.github.com/willccbb/4676755236bb08cab5f4e54a0475d6fb#file-grpo_demo-py-L90</a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-open_r1.utils">
<span id="utility-modules"></span><h2>Utility Modules<a class="headerlink" href="#module-open_r1.utils" title="Link to this heading">¶</a></h2>
<p>Utility helpers shared across the Open-R1 training pipelines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.get_dataset">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.</span></span><span class="sig-name descname"><span class="pre">get_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/data.html#get_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.get_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Load a dataset or a mixture of datasets based on the configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="#open_r1.configs.ScriptArguments" title="open_r1.configs.ScriptArguments"><em>ScriptArguments</em></a>) – Script arguments containing dataset configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded dataset dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.get_model">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/model_utils.html#get_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.get_model" title="Link to this definition">¶</a></dt>
<dd><p>Instantiate the causal language model used for supervised or GRPO training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_args</strong> (<em>ModelConfig</em>) – Model configuration taken from the CLI or config file.</p></li>
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.SFTConfig" title="open_r1.configs.SFTConfig"><em>SFTConfig</em></a><em> | </em><a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>) – Training hyper-parameters that decide caching/quantisation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initialised <code class="docutils literal notranslate"><span class="pre">AutoModelForCausalLM</span></code> ready for fine-tuning.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>transformers.AutoModelForCausalLM</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.get_tokenizer">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.</span></span><span class="sig-name descname"><span class="pre">get_tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/model_utils.html#get_tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.get_tokenizer" title="Link to this definition">¶</a></dt>
<dd><p>Instantiate the tokenizer requested by the training configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_args</strong> (<em>ModelConfig</em>) – Configuration describing the base pretrained checkpoint.</p></li>
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.SFTConfig" title="open_r1.configs.SFTConfig"><em>SFTConfig</em></a><em> | </em><a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>) – Training hyper-parameters including optional chat template.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded and optionally chat-template enriched tokenizer instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>transformers.PreTrainedTokenizer</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.is_e2b_available">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.</span></span><span class="sig-name descname"><span class="pre">is_e2b_available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/import_utils.html#is_e2b_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.is_e2b_available" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> when the optional e2b dependency is installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.is_morph_available">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.</span></span><span class="sig-name descname"><span class="pre">is_morph_available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/import_utils.html#is_morph_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.is_morph_available" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> when the optional morphcloud dependency is installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.callbacks">Trainer callbacks that integrate Open-R1 runs with auxiliary services.</p>
<p>The callbacks defined here extend Hugging Face <code class="docutils literal notranslate"><span class="pre">Trainer</span></code> runs with behaviour
used by the Open-R1 experiments: automatically pushing checkpoints to the Hub,
collecting high-performing prompts in a replay buffer, and mirroring batches
into that buffer in real time.  The functions are written to be picked up by
Sphinx autodoc so they show up in the generated API reference.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.PushToHubRevisionCallback">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.callbacks.</span></span><span class="sig-name descname"><span class="pre">PushToHubRevisionCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#PushToHubRevisionCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.PushToHubRevisionCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></p>
<p>Callback that pushes checkpoints to the Hub using revision tags.</p>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.PushToHubRevisionCallback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_cfg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#PushToHubRevisionCallback.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.PushToHubRevisionCallback.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Store the model configuration used when scheduling pushes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.PushToHubRevisionCallback.on_save">
<span class="sig-name descname"><span class="pre">on_save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#PushToHubRevisionCallback.on_save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.PushToHubRevisionCallback.on_save" title="Link to this definition">¶</a></dt>
<dd><p>Push the current checkpoint to the Hub and optionally schedule benchmarks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>transformers.TrainingArguments</em>)</p></li>
<li><p><strong>state</strong> (<em>transformers.TrainerState</em>)</p></li>
<li><p><strong>control</strong> (<em>transformers.TrainerControl</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.ReplayBufferCallback">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.callbacks.</span></span><span class="sig-name descname"><span class="pre">ReplayBufferCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#ReplayBufferCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.ReplayBufferCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></p>
<p>Callback that logs batches directly into the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>replay_buffer</strong> (<a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer" title="open_r1.utils.replay_buffer.ReplayBuffer"><em>ReplayBuffer</em></a>)</p></li>
<li><p><strong>accuracy_key</strong> (<em>str</em>)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.ReplayBufferCallback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'crossword_accuracy_reward'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#ReplayBufferCallback.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.ReplayBufferCallback.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Configure the callback with replay buffer, tokenizer and reward key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>replay_buffer</strong> (<a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer" title="open_r1.utils.replay_buffer.ReplayBuffer"><em>ReplayBuffer</em></a>)</p></li>
<li><p><strong>accuracy_key</strong> (<em>str</em>)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.ReplayBufferCallback.on_train_batch_end">
<span class="sig-name descname"><span class="pre">on_train_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#ReplayBufferCallback.on_train_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.ReplayBufferCallback.on_train_batch_end" title="Link to this definition">¶</a></dt>
<dd><p>Inspect training outputs and enqueue prompts crossing the threshold.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.SuccessCachingCallback">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.callbacks.</span></span><span class="sig-name descname"><span class="pre">SuccessCachingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#SuccessCachingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.SuccessCachingCallback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></p>
<p>Scrape <code class="docutils literal notranslate"><span class="pre">trainer._textual_logs</span></code> after each log step and push any prompt whose
accuracy meets or exceeds <code class="docutils literal notranslate"><span class="pre">acc_threshold</span></code> into the attached <code class="docutils literal notranslate"><span class="pre">ReplayBuffer</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Transformers never passes the trainer instance via <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>; call
<a class="reference internal" href="#open_r1.utils.callbacks.SuccessCachingCallback.set_trainer" title="open_r1.utils.callbacks.SuccessCachingCallback.set_trainer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_trainer()</span></code></a> during setup to register it.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>replay_buffer</strong> (<a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer" title="open_r1.utils.replay_buffer.ReplayBuffer"><em>ReplayBuffer</em></a>)</p></li>
<li><p><strong>acc_threshold</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.SuccessCachingCallback.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">replay_buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#SuccessCachingCallback.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.SuccessCachingCallback.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the callback with a replay buffer and accuracy threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>replay_buffer</strong> (<a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer" title="open_r1.utils.replay_buffer.ReplayBuffer"><em>ReplayBuffer</em></a>)</p></li>
<li><p><strong>acc_threshold</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.SuccessCachingCallback.on_log">
<span class="sig-name descname"><span class="pre">on_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#SuccessCachingCallback.on_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.SuccessCachingCallback.on_log" title="Link to this definition">¶</a></dt>
<dd><p>Scrape textual logs and add high-accuracy prompts to the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>transformers.TrainingArguments</em>)</p></li>
<li><p><strong>state</strong> (<em>transformers.TrainerState</em>)</p></li>
<li><p><strong>control</strong> (<em>transformers.TrainerControl</em>)</p></li>
<li><p><strong>logs</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>float</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.SuccessCachingCallback.set_trainer">
<span class="sig-name descname"><span class="pre">set_trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#SuccessCachingCallback.set_trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.SuccessCachingCallback.set_trainer" title="Link to this definition">¶</a></dt>
<dd><p>Register the owning trainer instance for later log inspection.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.callbacks.get_callbacks">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.callbacks.</span></span><span class="sig-name descname"><span class="pre">get_callbacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_cfg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_cfg</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">replay_buffer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/callbacks.html#get_callbacks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.callbacks.get_callbacks" title="Link to this definition">¶</a></dt>
<dd><p>Instantiate the callbacks listed in <code class="docutils literal notranslate"><span class="pre">train_cfg.callbacks</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>replay_buffer</strong> (<a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer" title="open_r1.utils.replay_buffer.ReplayBuffer"><em>ReplayBuffer</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.code_providers">Code execution providers for executing and evaluating code snippets.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.CodeExecutionProvider">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.code_providers.</span></span><span class="sig-name descname"><span class="pre">CodeExecutionProvider</span></span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#CodeExecutionProvider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.CodeExecutionProvider" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for code execution providers.</p>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.CodeExecutionProvider.execute_scripts">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">execute_scripts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scripts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">languages</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#CodeExecutionProvider.execute_scripts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.CodeExecutionProvider.execute_scripts" title="Link to this definition">¶</a></dt>
<dd><p>Execute multiple scripts and return their reward values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scripts</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Code scripts to execute.</p></li>
<li><p><strong>languages</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Programming language for each script.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float rewards (one per script).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.E2BProvider">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.code_providers.</span></span><span class="sig-name descname"><span class="pre">E2BProvider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2b_router_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#E2BProvider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.E2BProvider" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#open_r1.utils.code_providers.CodeExecutionProvider" title="open_r1.utils.code_providers.CodeExecutionProvider"><code class="xref py py-class docutils literal notranslate"><span class="pre">CodeExecutionProvider</span></code></a></p>
<p>Provider that executes code using E2B sandboxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_parallel</strong> (<em>int</em>)</p></li>
<li><p><strong>e2b_router_url</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.E2BProvider.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2b_router_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#E2BProvider.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.E2BProvider.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the E2B provider.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_parallel</strong> (<em>int</em>) – Number of parallel sandboxes to use.</p></li>
<li><p><strong>e2b_router_url</strong> (<em>str</em><em> | </em><em>None</em>) – URL for the E2B router (when using router mode).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.E2BProvider.execute_scripts">
<span class="sig-name descname"><span class="pre">execute_scripts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scripts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">languages</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#E2BProvider.execute_scripts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.E2BProvider.execute_scripts" title="Link to this definition">¶</a></dt>
<dd><p>Execute scripts using E2B sandboxes.</p>
<p>If e2b_router_url is provided, uses the RoutedSandbox for batch processing.
Otherwise, uses direct AsyncSandbox with parallelization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scripts</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>languages</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List</em>[float]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.MorphProvider">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.code_providers.</span></span><span class="sig-name descname"><span class="pre">MorphProvider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph_router_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#MorphProvider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.MorphProvider" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#open_r1.utils.code_providers.CodeExecutionProvider" title="open_r1.utils.code_providers.CodeExecutionProvider"><code class="xref py py-class docutils literal notranslate"><span class="pre">CodeExecutionProvider</span></code></a></p>
<p>Provider that executes code using MorphCloud’s Sandbox API.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_parallel</strong> (<em>int</em>)</p></li>
<li><p><strong>morph_router_url</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.MorphProvider.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">morph_router_url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#MorphProvider.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.MorphProvider.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the Morph provider.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_parallel</strong> (<em>int</em>) – Number of parallel executions to use.</p></li>
<li><p><strong>morph_router_url</strong> (<em>str</em><em> | </em><em>None</em>) – URL for the MorphCloud router (when using router mode).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.MorphProvider.execute_scripts">
<span class="sig-name descname"><span class="pre">execute_scripts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scripts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">languages</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#MorphProvider.execute_scripts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.MorphProvider.execute_scripts" title="Link to this definition">¶</a></dt>
<dd><p>Execute scripts using MorphCloud Sandbox API.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scripts</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Python scripts to execute.</p></li>
<li><p><strong>languages</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Programming language for each script.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float rewards (one per script).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[float]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.code_providers.get_provider">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.code_providers.</span></span><span class="sig-name descname"><span class="pre">get_provider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">provider_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'e2b'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/code_providers.html#get_provider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.code_providers.get_provider" title="Link to this definition">¶</a></dt>
<dd><p>Factory function to get the appropriate code execution provider.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>provider_type</strong> (<em>str</em>) – Provider type to use (<code class="docutils literal notranslate"><span class="pre">&quot;e2b&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;morph&quot;</span></code>).</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Additional arguments forwarded to the provider constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instantiated code execution provider.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#open_r1.utils.code_providers.CodeExecutionProvider" title="open_r1.utils.code_providers.CodeExecutionProvider">CodeExecutionProvider</a></p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.data">Helpers for loading datasets and mixtures used by the training scripts.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.data.get_dataset">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.data.</span></span><span class="sig-name descname"><span class="pre">get_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/data.html#get_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.data.get_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Load a dataset or a mixture of datasets based on the configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<a class="reference internal" href="#open_r1.configs.ScriptArguments" title="open_r1.configs.ScriptArguments"><em>ScriptArguments</em></a>) – Script arguments containing dataset configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded dataset dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DatasetDict</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.evaluation">Evaluation utilities for orchestrating LightEval benchmark runs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.evaluation.get_lighteval_tasks">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.evaluation.</span></span><span class="sig-name descname"><span class="pre">get_lighteval_tasks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/evaluation.html#get_lighteval_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.evaluation.get_lighteval_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Return the list of registered LightEval task identifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.evaluation.register_lighteval_task">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.evaluation.</span></span><span class="sig-name descname"><span class="pre">register_lighteval_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_suite</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_fewshot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/evaluation.html#register_lighteval_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.evaluation.register_lighteval_task" title="Link to this definition">¶</a></dt>
<dd><p>Register a LightEval task configuration.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Core tasks can be added from this table:
<a class="reference external" href="https://github.com/huggingface/lighteval/blob/main/src/lighteval/tasks/tasks_table.jsonl">https://github.com/huggingface/lighteval/blob/main/src/lighteval/tasks/tasks_table.jsonl</a></p></li>
<li><p>Custom tasks requiring bespoke metrics or scripts should live in
<cite>scripts/evaluation/extended_lighteval_tasks</cite>.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – Dictionary used to store the task configuration.</p></li>
<li><p><strong>eval_suite</strong> (<em>str</em>) – Evaluation suite to pull tasks from.</p></li>
<li><p><strong>task_name</strong> (<em>str</em>) – Display name for the task.</p></li>
<li><p><strong>task_list</strong> (<em>str</em>) – Comma-separated task list using the LightEval format:
<code class="docutils literal notranslate"><span class="pre">extended|{task_name}|{num_fewshot}|0</span></code> or
<code class="docutils literal notranslate"><span class="pre">lighteval|{task_name}|{num_fewshot}|0</span></code>.</p></li>
<li><p><strong>num_fewshot</strong> (<em>int</em>) – Number of few-shot examples.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.evaluation.run_benchmark_jobs">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.evaluation.</span></span><span class="sig-name descname"><span class="pre">run_benchmark_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/evaluation.html#run_benchmark_jobs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.evaluation.run_benchmark_jobs" title="Link to this definition">¶</a></dt>
<dd><p>Launch benchmark jobs according to the training configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.SFTConfig" title="open_r1.configs.SFTConfig"><em>SFTConfig</em></a><em> | </em><a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>)</p></li>
<li><p><strong>model_args</strong> (<em>ModelConfig</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.evaluation.run_lighteval_job">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.evaluation.</span></span><span class="sig-name descname"><span class="pre">run_lighteval_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">benchmark</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/evaluation.html#run_lighteval_job"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.evaluation.run_lighteval_job" title="Link to this definition">¶</a></dt>
<dd><p>Submit a LightEval benchmark job via SLURM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>benchmark</strong> (<em>str</em>)</p></li>
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.SFTConfig" title="open_r1.configs.SFTConfig"><em>SFTConfig</em></a><em> | </em><a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>)</p></li>
<li><p><strong>model_args</strong> (<em>ModelConfig</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.hierarchical_rollout">Hierarchical rollout utilities extending the GRPO trainer.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.HierarchicalGRPOTrainer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.hierarchical_rollout.</span></span><span class="sig-name descname"><span class="pre">HierarchicalGRPOTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_reason</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hierarchical_rollout.html#HierarchicalGRPOTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.HierarchicalGRPOTrainer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">GRPOTrainer</span></code></p>
<p>GRPO trainer that supports hierarchical rollouts and optional vLLM generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout_fn</strong> (<em>Any</em>)</p></li>
<li><p><strong>tokenizer</strong> (<em>Any</em>)</p></li>
<li><p><strong>return_reason</strong> (<em>bool</em>)</p></li>
<li><p><strong>callbacks</strong> (<em>list</em><em>[</em><em>Any</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.HierarchicalGRPOTrainer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_reason</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hierarchical_rollout.html#HierarchicalGRPOTrainer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.HierarchicalGRPOTrainer.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the trainer with optional rollout function and callback factories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout_fn</strong> (<em>Any</em>)</p></li>
<li><p><strong>tokenizer</strong> (<em>Any</em>)</p></li>
<li><p><strong>return_reason</strong> (<em>bool</em>)</p></li>
<li><p><strong>callbacks</strong> (<em>list</em><em>[</em><em>Any</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.HierarchicalRollout">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.hierarchical_rollout.</span></span><span class="sig-name descname"><span class="pre">HierarchicalRollout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vllm_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reason_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hierarchical_rollout.html#HierarchicalRollout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.HierarchicalRollout" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Two-stage generation:</dt><dd><ol class="arabic simple">
<li><p>Generate until &lt;/think&gt; (or first &lt;answer&gt;), append the tags.</p></li>
<li><p>Feed that full sequence back in to finish the answer.</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>transformers.generation.utils.GenerationMixin</em>)</p></li>
<li><p><strong>tokenizer</strong> (<em>transformers.PreTrainedTokenizerBase</em>)</p></li>
<li><p><strong>vllm_client</strong> (<em>Any</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>max_reason_tokens</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.HierarchicalRollout.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vllm_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_reason_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">800</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hierarchical_rollout.html#HierarchicalRollout.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.HierarchicalRollout.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the rollout helper with model/tokenizer and optional vLLM client.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>transformers.generation.utils.GenerationMixin</em>)</p></li>
<li><p><strong>tokenizer</strong> (<em>transformers.PreTrainedTokenizerBase</em>)</p></li>
<li><p><strong>vllm_client</strong> (<em>Any</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>max_reason_tokens</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.is_conversational">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hierarchical_rollout.</span></span><span class="sig-name descname"><span class="pre">is_conversational</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.is_conversational" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.maybe_apply_chat_template">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hierarchical_rollout.</span></span><span class="sig-name descname"><span class="pre">maybe_apply_chat_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.maybe_apply_chat_template" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.pad">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hierarchical_rollout.</span></span><span class="sig-name descname"><span class="pre">pad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.pad" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hierarchical_rollout.unwrap_model_for_generation">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hierarchical_rollout.</span></span><span class="sig-name descname"><span class="pre">unwrap_model_for_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.utils.hierarchical_rollout.unwrap_model_for_generation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<p id="module-open_r1.utils.hub">Helpers for pushing training artifacts to the Hugging Face Hub.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hub.check_hub_revision_exists">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hub.</span></span><span class="sig-name descname"><span class="pre">check_hub_revision_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hub.html#check_hub_revision_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hub.check_hub_revision_exists" title="Link to this definition">¶</a></dt>
<dd><p>Checks if a given Hub revision exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>training_args</strong> (<em>SFTConfig</em><em> | </em><em>GRPOConfig</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hub.get_gpu_count_for_vllm">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hub.</span></span><span class="sig-name descname"><span class="pre">get_gpu_count_for_vllm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">revision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hub.html#get_gpu_count_for_vllm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hub.get_gpu_count_for_vllm" title="Link to this definition">¶</a></dt>
<dd><p>Return a GPU count compatible with vLLM attention head constraints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>)</p></li>
<li><p><strong>revision</strong> (<em>str</em>)</p></li>
<li><p><strong>num_gpus</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hub.get_param_count_from_repo_id">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hub.</span></span><span class="sig-name descname"><span class="pre">get_param_count_from_repo_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hub.html#get_param_count_from_repo_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hub.get_param_count_from_repo_id" title="Link to this definition">¶</a></dt>
<dd><p>Return parameter count from safetensors metadata or repo naming pattern.</p>
<p>The repo ID can include human-readable counts such as 42m, 1.5b, 0.5m, or
products like 8x7b. If metadata is unavailable, those tokens are parsed to
estimate the parameter count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>repo_id</strong> (<em>str</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.hub.push_to_hub_revision">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.hub.</span></span><span class="sig-name descname"><span class="pre">push_to_hub_revision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_ignore_patterns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/hub.html#push_to_hub_revision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.hub.push_to_hub_revision" title="Link to this definition">¶</a></dt>
<dd><p>Pushes the model to branch on a Hub repo.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>training_args</strong> (<em>SFTConfig</em><em> | </em><em>GRPOConfig</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>concurrent.futures.Future</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.import_utils">Availability checks for optional third-party integrations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.import_utils.is_e2b_available">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">is_e2b_available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/import_utils.html#is_e2b_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.import_utils.is_e2b_available" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> when the optional e2b dependency is installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.import_utils.is_morph_available">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.import_utils.</span></span><span class="sig-name descname"><span class="pre">is_morph_available</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/import_utils.html#is_morph_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.import_utils.is_morph_available" title="Link to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> when the optional morphcloud dependency is installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.model_utils">Model and tokenizer factory helpers for Open-R1 training scripts.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.model_utils.get_kbit_device_map">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.model_utils.</span></span><span class="sig-name descname"><span class="pre">get_kbit_device_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.utils.model_utils.get_kbit_device_map" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.model_utils.get_model">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.model_utils.</span></span><span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/model_utils.html#get_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.model_utils.get_model" title="Link to this definition">¶</a></dt>
<dd><p>Instantiate the causal language model used for supervised or GRPO training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_args</strong> (<em>ModelConfig</em>) – Model configuration taken from the CLI or config file.</p></li>
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.SFTConfig" title="open_r1.configs.SFTConfig"><em>SFTConfig</em></a><em> | </em><a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>) – Training hyper-parameters that decide caching/quantisation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Initialised <code class="docutils literal notranslate"><span class="pre">AutoModelForCausalLM</span></code> ready for fine-tuning.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>transformers.AutoModelForCausalLM</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.model_utils.get_quantization_config">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.model_utils.</span></span><span class="sig-name descname"><span class="pre">get_quantization_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#open_r1.utils.model_utils.get_quantization_config" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.model_utils.get_tokenizer">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.model_utils.</span></span><span class="sig-name descname"><span class="pre">get_tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/model_utils.html#get_tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.model_utils.get_tokenizer" title="Link to this definition">¶</a></dt>
<dd><p>Instantiate the tokenizer requested by the training configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_args</strong> (<em>ModelConfig</em>) – Configuration describing the base pretrained checkpoint.</p></li>
<li><p><strong>training_args</strong> (<a class="reference internal" href="#open_r1.configs.SFTConfig" title="open_r1.configs.SFTConfig"><em>SFTConfig</em></a><em> | </em><a class="reference internal" href="#open_r1.configs.GRPOConfig" title="open_r1.configs.GRPOConfig"><em>GRPOConfig</em></a>) – Training hyper-parameters including optional chat template.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded and optionally chat-template enriched tokenizer instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>transformers.PreTrainedTokenizer</p>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.replay_buffer">Replay buffer helpers for bandit-style GRPO training.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.replay_buffer.</span></span><span class="sig-name descname"><span class="pre">ReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">capacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bandit / UCB replay buffer with stable UIDs and optional exploit/explore mixing.</p>
<ul class="simple">
<li><p>add_group(…) -&gt; uid (&gt;=0) on success, -1 on failure</p></li>
<li><p>sample_uid(…) returns a uid you can feed back into trainer._inject_one_replay_group</p></li>
<li><p>update_priority_by_uid updates μ / priority using a stable uid (safe for DDP)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>capacity</strong> (<em>int</em>)</p></li>
<li><p><strong>C</strong> (<em>float</em>)</p></li>
<li><p><strong>debug_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">capacity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Create a replay buffer with the specified capacity and exploration scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>capacity</strong> (<em>int</em>) – Maximum number of replay groups retained.</p></li>
<li><p><strong>C</strong> (<em>float</em>) – Exploration/exploitation trade-off constant.</p></li>
<li><p><strong>debug_steps</strong> (<em>int</em>) – Enable verbose logging when &gt; 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.add" title="Link to this definition">¶</a></dt>
<dd><p>Add (sample, reward). If full, replace the worst-μ entry only if reward is higher.
Returns (inserted?, uid). On failure, returns (False, -1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>Any</em>)</p></li>
<li><p><strong>reward</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[bool, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.add_group">
<span class="sig-name descname"><span class="pre">add_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.add_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.add_group" title="Link to this definition">¶</a></dt>
<dd><p>Store a <em>group</em> (list) of examples under a single uid.
Returns the uid (or the same uid if it was deduped and not inserted).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (<em>List</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>reward</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.debug_state">
<span class="sig-name descname"><span class="pre">debug_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.debug_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.debug_state" title="Link to this definition">¶</a></dt>
<dd><p>Return a diagnostic snapshot of the buffer internals.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing length, capacity, and tail stats.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.get_group">
<span class="sig-name descname"><span class="pre">get_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.get_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.get_group" title="Link to this definition">¶</a></dt>
<dd><p>Return a deep copy of the stored group associated with <code class="docutils literal notranslate"><span class="pre">uid</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>uid</strong> (<em>int</em>) – Unique identifier returned by <a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.add_group" title="open_r1.utils.replay_buffer.ReplayBuffer.add_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_group()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of prompt dictionaries or an empty list when missing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[dict[str, <em>Any</em>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.last_error">
<span class="sig-name descname"><span class="pre">last_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.last_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.last_error" title="Link to this definition">¶</a></dt>
<dd><p>Return the most recent error metadata recorded by the buffer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.sample" title="Link to this definition">¶</a></dt>
<dd><p>Uniformly sample <cite>batch_size</cite> distinct entries from the buffer.</p>
<ul class="simple">
<li><p>Ignores μ, n, C, and mix_exploit_ratio.</p></li>
<li><p>Still returns (samples, idxs, uids, isw) so the rest of your
training loop remains untouched.  <cite>isw</cite> stays all‑ones.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>List</em>[<em>Any</em>], <em>List</em>[int], <em>List</em>[int], numpy.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.sample_uid">
<span class="sig-name descname"><span class="pre">sample_uid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">_</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">__</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.sample_uid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.sample_uid" title="Link to this definition">¶</a></dt>
<dd><p>Convenience: return a single UID chosen uniformly at random.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.update_priority">
<span class="sig-name descname"><span class="pre">update_priority</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.update_priority"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.update_priority" title="Link to this definition">¶</a></dt>
<dd><p>Update reward statistics for an item referenced by buffer index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – Index within the replay buffer.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – New reward value to merge into the running statistics.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_buffer.ReplayBuffer.update_priority_by_uid">
<span class="sig-name descname"><span class="pre">update_priority_by_uid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_buffer.html#ReplayBuffer.update_priority_by_uid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_buffer.ReplayBuffer.update_priority_by_uid" title="Link to this definition">¶</a></dt>
<dd><p>Update the tracked reward statistics for an item referenced by UID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uid</strong> (<em>int</em>) – Unique identifier returned by <a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.add" title="open_r1.utils.replay_buffer.ReplayBuffer.add"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code></a> or <a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.add_group" title="open_r1.utils.replay_buffer.ReplayBuffer.add_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_group()</span></code></a>.</p></li>
<li><p><strong>reward</strong> (<em>float</em>) – New reward value to merge into the running statistics.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-open_r1.utils.replay_dataset">Dataset helpers for mixing fresh and replayed experiences during training.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.replay_dataset.ReplayMixDataset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.replay_dataset.</span></span><span class="sig-name descname"><span class="pre">ReplayMixDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_dataset.html#ReplayMixDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_dataset.ReplayMixDataset" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>Dataset wrapper that annotates rows with the replay flag.</p>
<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.replay_dataset.ReplayMixDataset.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tok</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_dataset.html#ReplayMixDataset.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_dataset.ReplayMixDataset.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Store the underlying dataset and tokenizer used for assertions.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.replay_dataset.replay_collate">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.replay_dataset.</span></span><span class="sig-name descname"><span class="pre">replay_collate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">replay_buffer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replay_prob</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/replay_dataset.html#replay_collate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.replay_dataset.replay_collate" title="Link to this definition">¶</a></dt>
<dd><p>Identity collate that simply clears replay flags and preserves accuracy.</p>
</dd></dl>

<p id="module-open_r1.utils.routed_morph">Thin wrapper around the MorphCloud router batch execution API.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.routed_morph.RoutedMorphSandbox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.routed_morph.</span></span><span class="sig-name descname"><span class="pre">RoutedMorphSandbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">router_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/routed_morph.html#RoutedMorphSandbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.routed_morph.RoutedMorphSandbox" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Client for the MorphCloud router service that mimics the API of MorphCloud’s Sandbox.</p>
<p>This class provides a simple interface to execute code via a central MorphCloud router,
which manages sandbox creation and cleanup. It allows batch processing of multiple scripts
in a single request for improved efficiency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>router_url</strong> (<em>str</em>)</p></li>
<li><p><strong>timeout</strong> (<em>int</em>)</p></li>
<li><p><strong>request_timeout</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.utils.routed_morph.RoutedMorphSandbox.router_url">
<span class="sig-name descname"><span class="pre">router_url</span></span><a class="headerlink" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.router_url" title="Link to this definition">¶</a></dt>
<dd><p>The URL of the MorphCloud router service.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.utils.routed_morph.RoutedMorphSandbox.timeout">
<span class="sig-name descname"><span class="pre">timeout</span></span><a class="headerlink" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.timeout" title="Link to this definition">¶</a></dt>
<dd><p>Execution timeout in seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.utils.routed_morph.RoutedMorphSandbox.request_timeout">
<span class="sig-name descname"><span class="pre">request_timeout</span></span><a class="headerlink" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.request_timeout" title="Link to this definition">¶</a></dt>
<dd><p>HTTP request timeout in seconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.routed_morph.RoutedMorphSandbox.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">router_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/routed_morph.html#RoutedMorphSandbox.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the routed MorphCloud sandbox client.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>router_url</strong> (<em>str</em>) – URL of the MorphCloud router, including host and port.</p></li>
<li><p><strong>timeout</strong> (<em>int</em>) – Default execution timeout in seconds.</p></li>
<li><p><strong>request_timeout</strong> (<em>int</em>) – Default HTTP request timeout in seconds.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.routed_morph.RoutedMorphSandbox.run_code">
<span class="sig-name descname"><span class="pre">run_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scripts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">languages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/routed_morph.html#RoutedMorphSandbox.run_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.run_code" title="Link to this definition">¶</a></dt>
<dd><p>Execute multiple scripts using MorphCloud via the router.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scripts</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Code scripts to execute.</p></li>
<li><p><strong>languages</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Programming languages for each script; defaults to Python when omitted.</p></li>
<li><p><strong>timeout</strong> (<em>int</em><em> | </em><em>None</em>) – Execution timeout in seconds; defaults to the instance timeout.</p></li>
<li><p><strong>request_timeout</strong> (<em>int</em><em> | </em><em>None</em>) – HTTP request timeout in seconds; defaults to the instance setting.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Execution results with <code class="docutils literal notranslate"><span class="pre">text</span></code> and <code class="docutils literal notranslate"><span class="pre">exception_str</span></code> attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-open_r1.utils.routed_sandbox">Compatibility layer that routes batch jobs to an E2B sandbox router.</p>
<dl class="py class">
<dt class="sig sig-object py" id="open_r1.utils.routed_sandbox.RoutedSandbox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">open_r1.utils.routed_sandbox.</span></span><span class="sig-name descname"><span class="pre">RoutedSandbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">router_url</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/routed_sandbox.html#RoutedSandbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.routed_sandbox.RoutedSandbox" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A sandbox environment that routes code execution requests to the E2B Router.
This class is designed for batched execution of scripts, primarily for Python code.
It mimics the usage of ‘Sandbox’ from ‘e2b_code_interpreter’, but adds support for batch processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>router_url</strong> (<em>str</em>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="open_r1.utils.routed_sandbox.RoutedSandbox.router_url">
<span class="sig-name descname"><span class="pre">router_url</span></span><a class="headerlink" href="#open_r1.utils.routed_sandbox.RoutedSandbox.router_url" title="Link to this definition">¶</a></dt>
<dd><p>The URL of the E2B Router to which code execution requests are sent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.routed_sandbox.RoutedSandbox.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">router_url</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/routed_sandbox.html#RoutedSandbox.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.routed_sandbox.RoutedSandbox.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initializes the RoutedSandbox with the specified router URL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>router_url</strong> (<em>str</em>) – URL of the E2B Router.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="open_r1.utils.routed_sandbox.RoutedSandbox.run_code">
<span class="sig-name descname"><span class="pre">run_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scripts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">languages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/routed_sandbox.html#RoutedSandbox.run_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.routed_sandbox.RoutedSandbox.run_code" title="Link to this definition">¶</a></dt>
<dd><p>Executes a batch of scripts in the sandbox environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scripts</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Code scripts to execute.</p></li>
<li><p><strong>languages</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Programming languages for each script; defaults to Python when omitted.</p></li>
<li><p><strong>timeout</strong> (<em>int</em><em> | </em><em>None</em>) – Maximum execution time for each script in seconds.</p></li>
<li><p><strong>request_timeout</strong> (<em>int</em><em> | </em><em>None</em>) – HTTP request timeout in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Execution objects containing results, logs, and errors (if any) per script.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[Execution]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-open_r1.utils.vllm_patch">Helpers for talking to an external <cite>trl vllm-serve</cite> instance.</p>
<dl class="simple">
<dt>vLLM ≤ 0.8.5 returns <em>token IDs</em> by default:</dt><dd><p>{“completion_ids”: [[ids…]], “prompt_ids”: [[ids…]]}</p>
</dd>
</dl>
<p>This helper now detects that schema and decodes it if a tokenizer is passed.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.vllm_patch.safe_generate">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.vllm_patch.</span></span><span class="sig-name descname"><span class="pre">safe_generate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">prompts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'http://localhost:8000/generate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/vllm_patch.html#safe_generate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.vllm_patch.safe_generate" title="Link to this definition">¶</a></dt>
<dd><p>Robust call to /generate with retry + schema-agnostic decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prompts</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>url</strong> (<em>str</em>)</p></li>
<li><p><strong>max_tokens</strong> (<em>int</em>)</p></li>
<li><p><strong>temperature</strong> (<em>float</em>)</p></li>
<li><p><strong>top_p</strong> (<em>float</em>)</p></li>
<li><p><strong>n</strong> (<em>int</em>)</p></li>
<li><p><strong>stream</strong> (<em>bool</em>)</p></li>
<li><p><strong>max_retries</strong> (<em>int</em>)</p></li>
<li><p><strong>backoff</strong> (<em>float</em>)</p></li>
<li><p><strong>timeout</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List</em>[<em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.vllm_patch.safe_request">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.vllm_patch.</span></span><span class="sig-name descname"><span class="pre">safe_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/vllm_patch.html#safe_request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.vllm_patch.safe_request" title="Link to this definition">¶</a></dt>
<dd><p>Perform a GET request with retry/backoff handling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>)</p></li>
<li><p><strong>max_retries</strong> (<em>int</em>)</p></li>
<li><p><strong>backoff</strong> (<em>float</em>)</p></li>
<li><p><strong>timeout</strong> (<em>float</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-open_r1.utils.wandb_logging">Utility for wiring Weights &amp; Biases environment variables from configs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="open_r1.utils.wandb_logging.init_wandb_training">
<span class="sig-prename descclassname"><span class="pre">open_r1.utils.wandb_logging.</span></span><span class="sig-name descname"><span class="pre">init_wandb_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">training_args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/open_r1/utils/wandb_logging.html#init_wandb_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#open_r1.utils.wandb_logging.init_wandb_training" title="Link to this definition">¶</a></dt>
<dd><p>Populate Weights &amp; Biases environment variables from training arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>training_args</strong> – Namespace or dataclass with <code class="docutils literal notranslate"><span class="pre">wandb_*</span></code> attributes.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="xgb.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">XGBoost Baseline API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="gpt4o.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">GPT-4o Tools API</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, GRAIL Simulation Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Open-R1 Training API</a><ul>
<li><a class="reference internal" href="#module-open_r1">Core Modules</a><ul>
<li><a class="reference internal" href="#open_r1.configs.DatasetConfig"><code class="docutils literal notranslate"><span class="pre">DatasetConfig</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.configs.DatasetConfig.columns"><code class="docutils literal notranslate"><span class="pre">DatasetConfig.columns</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.DatasetConfig.config"><code class="docutils literal notranslate"><span class="pre">DatasetConfig.config</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.DatasetConfig.id"><code class="docutils literal notranslate"><span class="pre">DatasetConfig.id</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.DatasetConfig.split"><code class="docutils literal notranslate"><span class="pre">DatasetConfig.split</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.DatasetConfig.weight"><code class="docutils literal notranslate"><span class="pre">DatasetConfig.weight</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.configs.DatasetMixtureConfig"><code class="docutils literal notranslate"><span class="pre">DatasetMixtureConfig</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.configs.DatasetMixtureConfig.datasets"><code class="docutils literal notranslate"><span class="pre">DatasetMixtureConfig.datasets</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.DatasetMixtureConfig.seed"><code class="docutils literal notranslate"><span class="pre">DatasetMixtureConfig.seed</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.DatasetMixtureConfig.test_split_size"><code class="docutils literal notranslate"><span class="pre">DatasetMixtureConfig.test_split_size</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig"><code class="docutils literal notranslate"><span class="pre">GRPOConfig</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.benchmarks"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.benchmarks</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.callbacks"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.callbacks</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.chat_template"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.chat_template</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.hub_model_revision"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.hub_model_revision</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.num_completions_to_print"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.num_completions_to_print</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.overwrite_hub_revision"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.overwrite_hub_revision</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.push_to_hub_revision"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.push_to_hub_revision</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.system_prompt"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.system_prompt</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.wandb_entity"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.wandb_entity</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.wandb_log_unique_prompts"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.wandb_log_unique_prompts</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.wandb_project"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.wandb_project</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOConfig.wandb_run_group"><code class="docutils literal notranslate"><span class="pre">GRPOConfig.wandb_run_group</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.code_eval_scoring_mode"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.code_eval_scoring_mode</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.code_eval_test_batch_size"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.code_eval_test_batch_size</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.code_language"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.code_language</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.code_provider"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.code_provider</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.cosine_max_len"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.cosine_max_len</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.cosine_max_value_correct"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.cosine_max_value_correct</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.cosine_max_value_wrong"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.cosine_max_value_wrong</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.cosine_min_value_correct"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.cosine_min_value_correct</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.cosine_min_value_wrong"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.cosine_min_value_wrong</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.dataset_prompt_column"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.dataset_prompt_column</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.dataset_solution_column"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.dataset_solution_column</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.e2b_router_url"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.e2b_router_url</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.ioi_provider"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.ioi_provider</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.max_completion_len"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.max_completion_len</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.morph_router_url"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.morph_router_url</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.parallel_code_exec_per_proc"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.parallel_code_exec_per_proc</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.repetition_max_penalty"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.repetition_max_penalty</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.repetition_n_grams"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.repetition_n_grams</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.reward_funcs"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.reward_funcs</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.soft_punish_cache"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.soft_punish_cache</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.span_kl_beta0"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.span_kl_beta0</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.span_kl_horizon"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.span_kl_horizon</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.GRPOScriptArguments.span_kl_target"><code class="docutils literal notranslate"><span class="pre">GRPOScriptArguments.span_kl_target</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig"><code class="docutils literal notranslate"><span class="pre">SFTConfig</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.benchmarks"><code class="docutils literal notranslate"><span class="pre">SFTConfig.benchmarks</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.callbacks"><code class="docutils literal notranslate"><span class="pre">SFTConfig.callbacks</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.chat_template"><code class="docutils literal notranslate"><span class="pre">SFTConfig.chat_template</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.hub_model_revision"><code class="docutils literal notranslate"><span class="pre">SFTConfig.hub_model_revision</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.overwrite_hub_revision"><code class="docutils literal notranslate"><span class="pre">SFTConfig.overwrite_hub_revision</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.push_to_hub_revision"><code class="docutils literal notranslate"><span class="pre">SFTConfig.push_to_hub_revision</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.system_prompt"><code class="docutils literal notranslate"><span class="pre">SFTConfig.system_prompt</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.wandb_entity"><code class="docutils literal notranslate"><span class="pre">SFTConfig.wandb_entity</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.wandb_project"><code class="docutils literal notranslate"><span class="pre">SFTConfig.wandb_project</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.SFTConfig.wandb_run_group"><code class="docutils literal notranslate"><span class="pre">SFTConfig.wandb_run_group</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.configs.ScriptArguments"><code class="docutils literal notranslate"><span class="pre">ScriptArguments</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.configs.ScriptArguments.dataset_mixture"><code class="docutils literal notranslate"><span class="pre">ScriptArguments.dataset_mixture</span></code></a></li>
<li><a class="reference internal" href="#open_r1.configs.ScriptArguments.dataset_name"><code class="docutils literal notranslate"><span class="pre">ScriptArguments.dataset_name</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.generate.build_distilabel_pipeline"><code class="docutils literal notranslate"><span class="pre">build_distilabel_pipeline()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.OnlineDiscriminator"><code class="docutils literal notranslate"><span class="pre">OnlineDiscriminator</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.grail.OnlineDiscriminator.__init__"><code class="docutils literal notranslate"><span class="pre">OnlineDiscriminator.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.OnlineDiscriminator.prob_positive"><code class="docutils literal notranslate"><span class="pre">OnlineDiscriminator.prob_positive()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.OnlineDiscriminator.train_batch"><code class="docutils literal notranslate"><span class="pre">OnlineDiscriminator.train_batch()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext"><code class="docutils literal notranslate"><span class="pre">RewardContext</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.chosen_index"><code class="docutils literal notranslate"><span class="pre">RewardContext.chosen_index</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.gold_id"><code class="docutils literal notranslate"><span class="pre">RewardContext.gold_id</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.gold_index"><code class="docutils literal notranslate"><span class="pre">RewardContext.gold_index</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.is_valid"><code class="docutils literal notranslate"><span class="pre">RewardContext.is_valid</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.items"><code class="docutils literal notranslate"><span class="pre">RewardContext.items</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.policy_text"><code class="docutils literal notranslate"><span class="pre">RewardContext.policy_text</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.state"><code class="docutils literal notranslate"><span class="pre">RewardContext.state</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.RewardContext.viewer"><code class="docutils literal notranslate"><span class="pre">RewardContext.viewer</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.grail.get_peft_config"><code class="docutils literal notranslate"><span class="pre">get_peft_config()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grail.make_gail_reward_fn"><code class="docutils literal notranslate"><span class="pre">make_gail_reward_fn()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grpo.get_peft_config"><code class="docutils literal notranslate"><span class="pre">get_peft_config()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.grpo.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.accuracy_reward"><code class="docutils literal notranslate"><span class="pre">accuracy_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.binary_code_reward"><code class="docutils literal notranslate"><span class="pre">binary_code_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.code_reward"><code class="docutils literal notranslate"><span class="pre">code_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.extract_code"><code class="docutils literal notranslate"><span class="pre">extract_code()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.format_reward"><code class="docutils literal notranslate"><span class="pre">format_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.formating"><code class="docutils literal notranslate"><span class="pre">formating()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.get_code_format_reward"><code class="docutils literal notranslate"><span class="pre">get_code_format_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.get_cosine_scaled_reward"><code class="docutils literal notranslate"><span class="pre">get_cosine_scaled_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.get_repetition_penalty_reward"><code class="docutils literal notranslate"><span class="pre">get_repetition_penalty_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.get_reward_funcs"><code class="docutils literal notranslate"><span class="pre">get_reward_funcs()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.get_soft_overlong_punishment"><code class="docutils literal notranslate"><span class="pre">get_soft_overlong_punishment()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.ioi_code_reward"><code class="docutils literal notranslate"><span class="pre">ioi_code_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.len_reward"><code class="docutils literal notranslate"><span class="pre">len_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.pure_accuracy_reward"><code class="docutils literal notranslate"><span class="pre">pure_accuracy_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.reasoning_steps_reward"><code class="docutils literal notranslate"><span class="pre">reasoning_steps_reward()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.rewards.tag_count_reward"><code class="docutils literal notranslate"><span class="pre">tag_count_reward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-open_r1.utils">Utility Modules</a><ul>
<li><a class="reference internal" href="#open_r1.utils.get_dataset"><code class="docutils literal notranslate"><span class="pre">get_dataset()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.get_model"><code class="docutils literal notranslate"><span class="pre">get_model()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.get_tokenizer"><code class="docutils literal notranslate"><span class="pre">get_tokenizer()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.is_e2b_available"><code class="docutils literal notranslate"><span class="pre">is_e2b_available()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.is_morph_available"><code class="docutils literal notranslate"><span class="pre">is_morph_available()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.PushToHubRevisionCallback"><code class="docutils literal notranslate"><span class="pre">PushToHubRevisionCallback</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.callbacks.PushToHubRevisionCallback.__init__"><code class="docutils literal notranslate"><span class="pre">PushToHubRevisionCallback.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.PushToHubRevisionCallback.on_save"><code class="docutils literal notranslate"><span class="pre">PushToHubRevisionCallback.on_save()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.ReplayBufferCallback"><code class="docutils literal notranslate"><span class="pre">ReplayBufferCallback</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.callbacks.ReplayBufferCallback.__init__"><code class="docutils literal notranslate"><span class="pre">ReplayBufferCallback.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.ReplayBufferCallback.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">ReplayBufferCallback.on_train_batch_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.SuccessCachingCallback"><code class="docutils literal notranslate"><span class="pre">SuccessCachingCallback</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.callbacks.SuccessCachingCallback.__init__"><code class="docutils literal notranslate"><span class="pre">SuccessCachingCallback.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.SuccessCachingCallback.on_log"><code class="docutils literal notranslate"><span class="pre">SuccessCachingCallback.on_log()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.SuccessCachingCallback.set_trainer"><code class="docutils literal notranslate"><span class="pre">SuccessCachingCallback.set_trainer()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.callbacks.get_callbacks"><code class="docutils literal notranslate"><span class="pre">get_callbacks()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.code_providers.CodeExecutionProvider"><code class="docutils literal notranslate"><span class="pre">CodeExecutionProvider</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.code_providers.CodeExecutionProvider.execute_scripts"><code class="docutils literal notranslate"><span class="pre">CodeExecutionProvider.execute_scripts()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.code_providers.E2BProvider"><code class="docutils literal notranslate"><span class="pre">E2BProvider</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.code_providers.E2BProvider.__init__"><code class="docutils literal notranslate"><span class="pre">E2BProvider.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.code_providers.E2BProvider.execute_scripts"><code class="docutils literal notranslate"><span class="pre">E2BProvider.execute_scripts()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.code_providers.MorphProvider"><code class="docutils literal notranslate"><span class="pre">MorphProvider</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.code_providers.MorphProvider.__init__"><code class="docutils literal notranslate"><span class="pre">MorphProvider.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.code_providers.MorphProvider.execute_scripts"><code class="docutils literal notranslate"><span class="pre">MorphProvider.execute_scripts()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.code_providers.get_provider"><code class="docutils literal notranslate"><span class="pre">get_provider()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.data.get_dataset"><code class="docutils literal notranslate"><span class="pre">get_dataset()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.evaluation.get_lighteval_tasks"><code class="docutils literal notranslate"><span class="pre">get_lighteval_tasks()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.evaluation.register_lighteval_task"><code class="docutils literal notranslate"><span class="pre">register_lighteval_task()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.evaluation.run_benchmark_jobs"><code class="docutils literal notranslate"><span class="pre">run_benchmark_jobs()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.evaluation.run_lighteval_job"><code class="docutils literal notranslate"><span class="pre">run_lighteval_job()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.HierarchicalGRPOTrainer"><code class="docutils literal notranslate"><span class="pre">HierarchicalGRPOTrainer</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.HierarchicalGRPOTrainer.__init__"><code class="docutils literal notranslate"><span class="pre">HierarchicalGRPOTrainer.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.HierarchicalRollout"><code class="docutils literal notranslate"><span class="pre">HierarchicalRollout</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.HierarchicalRollout.__init__"><code class="docutils literal notranslate"><span class="pre">HierarchicalRollout.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.is_conversational"><code class="docutils literal notranslate"><span class="pre">is_conversational()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.maybe_apply_chat_template"><code class="docutils literal notranslate"><span class="pre">maybe_apply_chat_template()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.pad"><code class="docutils literal notranslate"><span class="pre">pad()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hierarchical_rollout.unwrap_model_for_generation"><code class="docutils literal notranslate"><span class="pre">unwrap_model_for_generation()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hub.check_hub_revision_exists"><code class="docutils literal notranslate"><span class="pre">check_hub_revision_exists()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hub.get_gpu_count_for_vllm"><code class="docutils literal notranslate"><span class="pre">get_gpu_count_for_vllm()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hub.get_param_count_from_repo_id"><code class="docutils literal notranslate"><span class="pre">get_param_count_from_repo_id()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.hub.push_to_hub_revision"><code class="docutils literal notranslate"><span class="pre">push_to_hub_revision()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.import_utils.is_e2b_available"><code class="docutils literal notranslate"><span class="pre">is_e2b_available()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.import_utils.is_morph_available"><code class="docutils literal notranslate"><span class="pre">is_morph_available()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.model_utils.get_kbit_device_map"><code class="docutils literal notranslate"><span class="pre">get_kbit_device_map()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.model_utils.get_model"><code class="docutils literal notranslate"><span class="pre">get_model()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.model_utils.get_quantization_config"><code class="docutils literal notranslate"><span class="pre">get_quantization_config()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.model_utils.get_tokenizer"><code class="docutils literal notranslate"><span class="pre">get_tokenizer()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.__init__"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.add"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.add()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.add_group"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.add_group()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.debug_state"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.debug_state()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.get_group"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.get_group()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.last_error"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.last_error()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.sample"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.sample()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.sample_uid"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.sample_uid()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.update_priority"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.update_priority()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.replay_buffer.ReplayBuffer.update_priority_by_uid"><code class="docutils literal notranslate"><span class="pre">ReplayBuffer.update_priority_by_uid()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.replay_dataset.ReplayMixDataset"><code class="docutils literal notranslate"><span class="pre">ReplayMixDataset</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.replay_dataset.ReplayMixDataset.__init__"><code class="docutils literal notranslate"><span class="pre">ReplayMixDataset.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.replay_dataset.replay_collate"><code class="docutils literal notranslate"><span class="pre">replay_collate()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.routed_morph.RoutedMorphSandbox"><code class="docutils literal notranslate"><span class="pre">RoutedMorphSandbox</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.router_url"><code class="docutils literal notranslate"><span class="pre">RoutedMorphSandbox.router_url</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.timeout"><code class="docutils literal notranslate"><span class="pre">RoutedMorphSandbox.timeout</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.request_timeout"><code class="docutils literal notranslate"><span class="pre">RoutedMorphSandbox.request_timeout</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.__init__"><code class="docutils literal notranslate"><span class="pre">RoutedMorphSandbox.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.routed_morph.RoutedMorphSandbox.run_code"><code class="docutils literal notranslate"><span class="pre">RoutedMorphSandbox.run_code()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.routed_sandbox.RoutedSandbox"><code class="docutils literal notranslate"><span class="pre">RoutedSandbox</span></code></a><ul>
<li><a class="reference internal" href="#open_r1.utils.routed_sandbox.RoutedSandbox.router_url"><code class="docutils literal notranslate"><span class="pre">RoutedSandbox.router_url</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.routed_sandbox.RoutedSandbox.__init__"><code class="docutils literal notranslate"><span class="pre">RoutedSandbox.__init__()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.routed_sandbox.RoutedSandbox.run_code"><code class="docutils literal notranslate"><span class="pre">RoutedSandbox.run_code()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#open_r1.utils.vllm_patch.safe_generate"><code class="docutils literal notranslate"><span class="pre">safe_generate()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.vllm_patch.safe_request"><code class="docutils literal notranslate"><span class="pre">safe_request()</span></code></a></li>
<li><a class="reference internal" href="#open_r1.utils.wandb_logging.init_wandb_training"><code class="docutils literal notranslate"><span class="pre">init_wandb_training()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>