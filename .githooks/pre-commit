#!/usr/bin/env bash
set -euo pipefail

REPO_ROOT="$(git rev-parse --show-toplevel)"

if [ "${SKIP_REPORT_REFRESH:-0}" = "1" ]; then
  printf '[pre-commit] Skipping report refresh (SKIP_REPORT_REFRESH=1).\n' >&2
  exit 0
fi

"${REPO_ROOT}/reports/build-reports.sh"

git -C "${REPO_ROOT}" add reports
