<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="XGBoost Baseline API" href="xgb.html"><link rel="prev" title="Clean Data Pipeline" href="clean_data.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>KNN Baseline API - GRAIL Simulation documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  --color-brand-primary: #1f4b8e;
  --color-brand-content: #1f4b8e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #8bbcef;
  --color-brand-content: #8bbcef;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">GRAIL Simulation  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">GRAIL Simulation  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="clean_data.html">Clean Data Pipeline</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">KNN Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="xgb.html">XGBoost Baseline API</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpt4o.html">GPT-4o Tools API</a></li>
<li class="toctree-l1"><a class="reference internal" href="grail.html">GRAIL Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="grpo.html">GRPO Pipeline API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common.html">Common Utilities API</a></li>
<li class="toctree-l1"><a class="reference internal" href="prompt_builder.html">Prompt Builder API</a></li>
<li class="toctree-l1"><a class="reference internal" href="open_r1.html">Open-R1 Training API</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlhf.html">Shared RLHF Helpers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization Utilities</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reports/index.html">Reports</a><input aria-label="Toggle navigation of Reports" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_stats.html">Prompt feature report</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/grpo.html">GRPO Reports</a><input aria-label="Toggle navigation of GRPO Reports" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/grpo_sample_generative_responses.html">GRPO Sample Generative Model Responses</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/grail.html">GRAIL Reports</a><input aria-label="Toggle navigation of GRAIL Reports" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/grail_next_video.html">GRAIL Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/grail_opinion.html">GRAIL Opinion Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/grail_sample_generative_responses.html">GRAIL Sample Generative Model Responses</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/gpt4o.html">GPT-4o Report Catalog</a><input aria-label="Toggle navigation of GPT-4o Report Catalog" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/gpt4o_next_video.html">GPT-4o Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/gpt4o_opinion.html">GPT-4o Opinion Shift</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/gpt4o_hyperparameter_tuning.html">GPT-4o Hyper-parameter Sweep</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/gpt4o_sample_generative_responses.html">GPT-4o Sample Generative Model Responses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reports/prompt_builder.html">Prompt Builder Sample Prompts</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/knn.html">KNN Report Catalog</a><input aria-label="Toggle navigation of KNN Report Catalog" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_next_video.html">KNN Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_next_video.html#id1">KNN Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion.html">KNN Opinion Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion.html#knn-opinion-shift-study">KNN Opinion Shift Study</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_hyperparameter_tuning.html">KNN Hyperparameter Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_hyperparameter_tuning.html#hyper-parameter-sweep-results">Hyper-Parameter Sweep Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion_from_next.html">KNN Opinion Regression (Next-Video Config)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_opinion_from_next.html#knn-opinion-shift-study-next-video-config">KNN Opinion Shift Study (Next-Video Config)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_additional_features.html">KNN Additional Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/knn_additional_features.html#additional-text-features">Additional Text Features</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../reports/xgb.html">XGBoost Report Catalog</a><input aria-label="Toggle navigation of XGBoost Report Catalog" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_next_video.html">XGBoost Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_next_video.html#id1">XGBoost Next-Video Baseline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_opinion.html">XGBoost Opinion Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_opinion.html#id1">XGBoost Opinion Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_opinion_from_next.html">XGBoost Opinion (Next-Video Config)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_opinion_from_next.html#xgboost-opinion-regression-next-video-config">XGBoost Opinion Regression (Next-Video Config)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_hyperparameter_tuning.html">XGBoost Hyperparameter Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_hyperparameter_tuning.html#hyper-parameter-tuning">Hyper-parameter Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_additional_features.html">XGBoost Additional Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../reports/xgb_additional_features.html#additional-text-features">Additional Text Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reports/main.html">Portfolio Comparison (Main)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/research_article_political_sciences.html">RESEARCH ARTICLE POLITICAL SCIENCES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reports/visualized_recommendation_trees.html">Visualized Recommendation Trees</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/knn.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="knn-baseline-api">
<h1>KNN Baseline API<a class="headerlink" href="#knn-baseline-api" title="Link to this heading">¶</a></h1>
<section id="feature-spaces">
<h2>Feature Spaces<a class="headerlink" href="#feature-spaces" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">knn</span></code> command-line entry point exposes a <code class="docutils literal notranslate"><span class="pre">--feature-space</span></code> switch to
toggle between sparse TF-IDF queries (default), dense Word2Vec embeddings, and
Sentence-Transformer embeddings. Word2Vec support depends on <code class="docutils literal notranslate"><span class="pre">gensim</span></code> being
available; Sentence-Transformer support depends on the
<code class="docutils literal notranslate"><span class="pre">sentence-transformers</span></code> package (and a compatible PyTorch backend). Install
the extras with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">gensim</span> <span class="pre">sentence-transformers</span></code> or include the
project’s <code class="docutils literal notranslate"><span class="pre">dev</span></code> extra.</p>
<p>Example invocations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>tfidf<span class="w"> </span>--out-dir<span class="w"> </span>models/knn/run-tfidf

python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>word2vec<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--word2vec-size<span class="w"> </span><span class="m">256</span><span class="w"> </span>--out-dir<span class="w"> </span>models/knn/run-w2v

python<span class="w"> </span>-m<span class="w"> </span>knn.cli<span class="w"> </span>--fit-index<span class="w"> </span>--feature-space<span class="w"> </span>sentence_transformer<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--sentence-transformer-model<span class="w"> </span>sentence-transformers/all-MiniLM-L6-v2<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--out-dir<span class="w"> </span>models/knn/run-st
</pre></div>
</div>
<p>Diagnostics (elbow plots, accuracy-by-k curves, and per-k predictions) are
saved under the configured <cite>–out-dir</cite>; use <cite>–train-curve-max</cite> to control how
many training examples contribute to the curve metrics.</p>
</section>
<section id="elbow-curve-metrics">
<h2>Elbow &amp; Curve Metrics<a class="headerlink" href="#elbow-curve-metrics" title="Link to this heading">¶</a></h2>
<p>Each evaluation issue produces:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reports/knn/next_video/&lt;feature-space&gt;/elbow_&lt;issue&gt;.png</span></code> – accuracy vs. <code class="docutils literal notranslate"><span class="pre">k</span></code> with the
elbow-selected point highlighted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models/knn/next_video/&lt;feature-space&gt;/&lt;study&gt;/&lt;issue&gt;/knn_curves_&lt;issue&gt;.json</span></code> – serialised
curves for the evaluation split (and optionally the training split) containing accuracy-by-<code class="docutils literal notranslate"><span class="pre">k</span></code>,
eligible/correct counts, AUC (both absolute and normalised), and the selected <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models/knn/next_video/&lt;feature-space&gt;/&lt;study&gt;/&lt;issue&gt;/</span></code> – per-<code class="docutils literal notranslate"><span class="pre">k</span></code> predictions and aggregate
metrics for downstream analysis.</p></li>
</ul>
<p>Set <code class="docutils literal notranslate"><span class="pre">--train-curve-max</span></code> when invoking the CLI to limit how many training
examples feed into the training curve diagnostics.</p>
</section>
<section id="module-knn">
<span id="package-overview"></span><h2>Package Overview<a class="headerlink" href="#module-knn" title="Link to this heading">¶</a></h2>
<p>Grail Simulation KNN baseline package.</p>
<p>Exposes CLI utilities, pipeline coordination, and reporting helpers for
the slate-ranking and opinion-regression experiments.</p>
<p id="module-knn.core">Core feature extraction, indexing, and evaluation utilities for the KNN baseline.</p>
<p id="module-knn.data">Dataset loading and filtering utilities for the KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_dataset_for_issue">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_dataset_for_issue" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset down to a specific issue label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">issue</span></code> column.</p></li>
<li><p><strong>issue</strong> (<em>str</em>) – Issue label to retain (<code class="docutils literal notranslate"><span class="pre">all</span></code> preserves every row).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary restricted to rows matching <code class="docutils literal notranslate"><span class="pre">issue</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_dataset_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_dataset_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter the dataset to rows whose <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> matches <code class="docutils literal notranslate"><span class="pre">studies</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> column.</p></li>
<li><p><strong>studies</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary filtered to the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.filter_split_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">filter_split_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_split_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.filter_split_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset split to the requested <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_ds</strong> (<em>datasets.Dataset</em>) – Dataset split supporting <code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code>.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered dataset split covering only the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.issues_in_dataset">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">issues_in_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#issues_in_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.issues_in_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Return the list of issue labels present in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing at least one split.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of issue identifiers or <code class="docutils literal notranslate"><span class="pre">['all']</span></code> when absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.data.load_dataset_source">
<span class="sig-prename descclassname"><span class="pre">knn.data.</span></span><span class="sig-name descname"><span class="pre">load_dataset_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#load_dataset_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.data.load_dataset_source" title="Link to this definition">¶</a></dt>
<dd><p>Load a cleaned dataset from disk or from the Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>str</em>) – Local directory path or Hugging Face dataset identifier.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – Cache directory passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">datasets.load_dataset()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary containing train and validation splits.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">datasets</span></code> is unavailable.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">source</span></code> does not yield a <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.DatasetDict</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-knn.features">Prompt feature construction utilities shared by the KNN baselines.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecFeatureBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create Word2Vec embeddings from viewer prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a>) – Configuration bundle controlling Word2Vec training/inference.</p></li>
<li><p><strong>_model</strong> (<em>gensim.models.Word2Vec</em><em> | </em><em>None</em>) – Loaded gensim <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2Vec</span></code> instance.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em>]</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the builder with optional configuration overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional configuration bundle to override defaults.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.encode" title="Link to this definition">¶</a></dt>
<dd><p>Return the averaged embedding vector for <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Document to encode using the fitted embeddings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Averaged embedding vector representing <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a previously trained Word2Vec model from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Directory containing the saved Word2Vec model.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.save" title="Link to this definition">¶</a></dt>
<dd><p>Persist the trained model to <code class="docutils literal notranslate"><span class="pre">directory</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Destination directory receiving the model artefact.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.train" title="Link to this definition">¶</a></dt>
<dd><p>Train a Word2Vec model using the provided corpus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Iterable of documents used to fit the embeddings.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.features.Word2VecFeatureBuilder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.Word2VecFeatureBuilder.transform" title="Link to this definition">¶</a></dt>
<dd><p>Return stacked embeddings for <code class="docutils literal notranslate"><span class="pre">corpus</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Sequence of documents to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of shape <code class="docutils literal notranslate"><span class="pre">(len(corpus),</span> <span class="pre">vector_size)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.assemble_document">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">assemble_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#assemble_document"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.assemble_document" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate prompt components and selection tokens for feature extraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing base fields and slate metadata.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields injected into the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Document string suitable for downstream vectorisation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.candidate_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">candidate_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">option_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#candidate_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.candidate_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Delegate to <a class="reference internal" href="#knn.features.candidate_feature_tokens" title="knn.features.candidate_feature_tokens"><code class="xref py py-func docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a> for convenience.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate</strong> (<a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a>) – Slate candidate to transform into feature tokens.</p></li>
<li><p><strong>option_count</strong> (<em>int</em><em> | </em><em>None</em>) – Optional total number of options available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens describing the candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.collect_candidate_metadata">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">collect_candidate_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#collect_candidate_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.collect_candidate_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Return slate candidate metadata enriched with slot indices and channel info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example providing slate items and metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of
<a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">CandidateMetadata</span></code></a> entries for the slate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata">common.prompts.selection.CandidateMetadata</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.extract_now_watching">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">extract_now_watching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_now_watching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.extract_now_watching" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the currently watched item for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of title and video ID, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str, str] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.extract_slate_items">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">extract_slate_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_slate_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.extract_slate_items" title="Link to this definition">¶</a></dt>
<dd><p>Extract the slate of candidate items from <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate candidates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of <code class="docutils literal notranslate"><span class="pre">(title,</span> <span class="pre">video_id)</span></code> pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[str, str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prepare_prompt_documents">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prepare_prompt_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_prompt_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prepare_prompt_documents" title="Link to this definition">¶</a></dt>
<dd><p>Convenience wrapper mirroring <a class="reference internal" href="#knn.features.prepare_training_documents" title="knn.features.prepare_training_documents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prepare_training_documents">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prepare_training_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_training_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prepare_training_documents" title="Link to this definition">¶</a></dt>
<dd><p>Prepare prompt documents, labels, and metadata for TF-IDF style training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If no eligible documents are generated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.prompt_from_builder">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">prompt_from_builder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prompt_from_builder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.prompt_from_builder" title="Link to this definition">¶</a></dt>
<dd><p>Assemble the full prompt text for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example to convert into prompt text.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full prompt string including contextual tokens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.selection_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">selection_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#selection_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.selection_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Construct additive tokens that highlight the selected candidate within a prompt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing the gold candidate.</p></li>
<li><p><strong>candidates</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a><em>] </em><em>| </em><em>None</em>) – Precomputed candidate metadata, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to derive it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens emphasising the gold candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.title_for">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">title_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#title_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.title_for" title="Link to this definition">¶</a></dt>
<dd><p>Look up a human-readable title for <code class="docutils literal notranslate"><span class="pre">video_id</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>video_id</strong> (<em>str</em>) – Candidate video identifier.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-friendly title or <code class="docutils literal notranslate"><span class="pre">None</span></code> when unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.features.viewer_profile_sentence">
<span class="sig-prename descclassname"><span class="pre">knn.features.</span></span><span class="sig-name descname"><span class="pre">viewer_profile_sentence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#viewer_profile_sentence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.features.viewer_profile_sentence" title="Link to this definition">¶</a></dt>
<dd><p>Compose the viewer profile sentence associated with <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing viewer metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Viewer profile sentence assembled by the builder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.index">Index construction and scoring logic for the KNN slate baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a sentence-transformer index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>) – Optional <a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SentenceTransformerConfig</span></code></a> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the encoder, dense matrix, and label metadata.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If <code class="docutils literal notranslate"><span class="pre">sentence_transformers</span></code> is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a TF-IDF index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split (Hugging Face dataset or list-like).</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>max_features</strong> (<em>int</em><em> | </em><em>None</em>) – Optional vocabulary cap for the vectoriser.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the fitted vectoriser, sparse matrix, and
label metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.build_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">build_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.build_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a Word2Vec index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2VecConfig</span></code> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the trained Word2Vec model and embeddings.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If gensim is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.knn_predict_among_slate_multi">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">knn_predict_among_slate_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#knn_predict_among_slate_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.knn_predict_among_slate_multi" title="Link to this definition">¶</a></dt>
<dd><p>Score each slate option using candidate-aware TF-IDF kNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knn_index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary describing the fitted index artifacts.</p></li>
<li><p><strong>example</strong> (<em>dict</em>) – Dataset row containing the slate to score.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sequence of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate.</p></li>
<li><p><strong>config</strong> (<em>knn.core.index.SlateQueryConfig</em><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">SlateQueryConfig</span></code> overriding defaults.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping from <code class="docutils literal notranslate"><span class="pre">k</span></code> to the predicted 1-based option index. <code class="docutils literal notranslate"><span class="pre">None</span></code>
indicates that a prediction could not be produced for that <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[int, int | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a sentence-transformer index saved via <a class="reference internal" href="#knn.index.save_sentence_transformer_index" title="knn.index.save_sentence_transformer_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing previously persisted artefacts to load from disk.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the loaded sentence-transformer index and associated metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a TF-IDF index previously saved via <a class="reference internal" href="#knn.index.save_tfidf_index" title="knn.index.save_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted TF-IDF artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the loaded vectoriser, matrix, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.load_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">load_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.load_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a Word2Vec index previously saved via <a class="reference internal" href="#knn.index.save_word2vec_index" title="knn.index.save_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted Word2Vec artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the restored Word2Vec model, embeddings, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the sentence-transformer index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – KNN index object or registry being manipulated.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Output directory receiving generated metrics and reports.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the TF-IDF index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.index.build_tfidf_index" title="knn.index.build_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where artifacts will be written.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.index.save_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.index.</span></span><span class="sig-name descname"><span class="pre">save_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.index.save_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the Word2Vec index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.index.build_word2vec_index" title="knn.index.build_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where embeddings and metadata are stored.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.evaluate">Top-level exports for the KNN evaluation helpers.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.bin_nopts">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">bin_nopts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bin_nopts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.bin_nopts" title="Link to this definition">¶</a></dt>
<dd><p>Bucket the number of slate options into reporting-friendly categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option_count</strong> (<em>int</em>) – Number of options contained in a recommendation slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="docutils literal notranslate"><span class="pre">{&quot;1&quot;,</span> <span class="pre">&quot;2&quot;,</span> <span class="pre">&quot;3&quot;,</span> <span class="pre">&quot;4&quot;,</span> <span class="pre">&quot;5+&quot;}</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.bucket_from_pos">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">bucket_from_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bucket_from_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.bucket_from_pos" title="Link to this definition">¶</a></dt>
<dd><p>Bucket a 0-based position index into the standard reporting bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pos_idx</strong> (<em>int</em>) – Zero-based position of the correct item within the retrieved slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="xref py py-data docutils literal notranslate"><span class="pre">BUCKET_LABELS</span></code> describing the position bucket.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.canon">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">canon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#canon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.canon" title="Link to this definition">¶</a></dt>
<dd><p>Canonicalise a text fragment by lowercasing and removing punctuation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Raw text fragment to normalise.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Canonical representation suitable for equality comparisons.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.compute_auc_from_curve">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">compute_auc_from_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#compute_auc_from_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.compute_auc_from_curve" title="Link to this definition">¶</a></dt>
<dd><p>Compute the area under the accuracy curve across <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy observed for each <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (area, normalised_area).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.evaluate_issue">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">evaluate_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#evaluate_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.evaluate_issue" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate a single issue slice and persist metrics, curves, and predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>knn.core.evaluate.pipeline.IssueEvaluationRequest</em>) – Evaluation bundle describing the issue to score.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Results are persisted via <code class="xref py py-func docutils literal notranslate"><span class="pre">write_issue_outputs()</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.parse_k_values">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">parse_k_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#parse_k_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.parse_k_values" title="Link to this definition">¶</a></dt>
<dd><p>Derive the sorted set of <code class="docutils literal notranslate"><span class="pre">k</span></code> values requested for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_default</strong> (<em>int</em>) – Baseline <code class="docutils literal notranslate"><span class="pre">k</span></code> value used when the sweep is empty.</p></li>
<li><p><strong>sweep</strong> (<em>str</em>) – Comma-delimited string of additional <code class="docutils literal notranslate"><span class="pre">k</span></code> candidates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Strictly positive <code class="docutils literal notranslate"><span class="pre">k</span></code> values in ascending order. Falls back to
<code class="docutils literal notranslate"><span class="pre">k_default</span></code> (or <code class="docutils literal notranslate"><span class="pre">25</span></code> when unset) if no valid integers are supplied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.plot_elbow">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">plot_elbow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'validation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#plot_elbow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.plot_elbow" title="Link to this definition">¶</a></dt>
<dd><p>Plot the accuracy curve (acc&#64;k) for the evaluation stage and mark <code class="docutils literal notranslate"><span class="pre">best_k</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values that were evaluated.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Mapping</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy keyed by <code class="docutils literal notranslate"><span class="pre">k</span></code> for the evaluation split.</p></li>
<li><p><strong>best_k</strong> (<em>int</em>) – Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> to highlight in the plot.</p></li>
<li><p><strong>output_path</strong> (<em>pathlib.Path</em>) – Destination path for the generated PNG artefact.</p></li>
<li><p><strong>data_split</strong> (<em>str</em>) – Split label used for the legend title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.resolve_reports_dir">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">resolve_reports_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/outputs.html#resolve_reports_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.resolve_reports_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the canonical reports directory corresponding to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out_dir</strong> (<em>pathlib.Path</em>) – Directory containing pipeline artefacts (typically under <code class="docutils literal notranslate"><span class="pre">models/knn</span></code>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path pointing at the repository-level <code class="docutils literal notranslate"><span class="pre">reports</span></code> directory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.run_eval">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.run_eval" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the KNN baseline across the issues specified on the CLI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – Namespace returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">knn.cli.build_parser()</span></code>, including dataset,
feature-space, and sweep configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Evaluation artefacts are persisted via downstream helpers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.evaluate.select_best_k">
<span class="sig-prename descclassname"><span class="pre">knn.evaluate.</span></span><span class="sig-name descname"><span class="pre">select_best_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'elbow'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#select_best_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.evaluate.select_best_k" title="Link to this definition">¶</a></dt>
<dd><p>Select <code class="docutils literal notranslate"><span class="pre">k</span></code> using either max-accuracy or an elbow heuristic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sorted sequence of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Observed eligible-only accuracy for each <code class="docutils literal notranslate"><span class="pre">k</span></code> on the
validation split.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Selection strategy (default: <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code>). <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> picks
the accuracy-maximising <code class="docutils literal notranslate"><span class="pre">k</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code> picks the first <code class="docutils literal notranslate"><span class="pre">k</span></code> where
marginal gains fall below half the initial slope, falling back to
max-accuracy when the heuristic is not applicable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> per the requested method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p>Opinion-regression utilities supporting the KNN baselines.</p>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionEmbeddingConfigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word2vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEmbeddingConfigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optional embedding builders available during evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word2vec</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>sentence_transformer</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">sentence_transformer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><span class="pre">common.text.embeddings.SentenceTransformerConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">word2vec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><span class="pre">knn.core.features.Word2VecConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionEvaluationContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs_root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEvaluationContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared configuration for evaluating a single opinion study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>)</p></li>
<li><p><strong>dataset</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Sequence</em><em>[</em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>embedding_configs</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><em>knn.core.opinion_models.OpinionEmbeddingConfigs</em></a>)</p></li>
<li><p><strong>outputs_root</strong> (<em>pathlib.Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">embedding_configs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><span class="pre">knn.core.opinion_models.OpinionEmbeddingConfigs</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">extra_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">k_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">outputs_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionExample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">participant_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionExample"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <a class="reference internal" href="common.html#common.opinion.models.OpinionExample" title="common.opinion.models.OpinionExample"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.models.OpinionExample</span></code></a></p>
<p>Collapsed participant-level prompt and opinion values with session context.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>session</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.core.opinion_models.SessionInfo" title="knn.core.opinion_models.SessionInfo"><em>SessionInfo</em></a><em>]</em>) – Optional tuple of step index and session identifier.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>participant_id</strong> (<em>str</em>)</p></li>
<li><p><strong>participant_study</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>document</strong> (<em>str</em>)</p></li>
<li><p><strong>before</strong> (<em>float</em>)</p></li>
<li><p><strong>after</strong> (<em>float</em>)</p></li>
<li><p><strong>session</strong> (<a class="reference internal" href="#knn.core.opinion_models.SessionInfo" title="knn.core.opinion_models.SessionInfo"><em>knn.core.opinion_models.SessionInfo</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">session</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.SessionInfo" title="knn.core.opinion_models.SessionInfo"><span class="pre">knn.core.opinion_models.SessionInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">session_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd><p>Return the recorded session identifier when available.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em></dt>
<dd><p>Return the recorded step index or <code class="docutils literal notranslate"><span class="pre">-1</span></code> when unavailable.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionIndex"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Vectorised training corpus, cached targets, and fitted neighbour index.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (tfidf, word2vec, sentence_transformer).</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Distance metric used by the KNN index.</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>) – Document-term matrix or embedding matrix backing the index.</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>) – Trained vectoriser or embedding builder.</p></li>
<li><p><strong>embeds</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – Optional Word2Vec feature builder used for inference.</p></li>
<li><p><strong>targets</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionTargets" title="knn.core.opinion_models.OpinionTargets"><em>OpinionTargets</em></a>) – Grouped post/pre opinion targets and participant keys aligned with the corpus.</p></li>
<li><p><strong>neighbors</strong> (<em>NearestNeighbors</em>) – Fitted <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.neighbors.NearestNeighbors</span></code> index.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>metric</strong> (<em>str</em>)</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>)</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>)</p></li>
<li><p><strong>embeds</strong> (<em>Any</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>targets</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionTargets" title="knn.core.opinion_models.OpinionTargets"><em>knn.core.opinion_models.OpinionTargets</em></a>)</p></li>
<li><p><strong>neighbors</strong> (<em>sklearn.neighbors.NearestNeighbors</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">embeds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">neighbors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">sklearn.neighbors.NearestNeighbors</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">targets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.OpinionTargets" title="knn.core.opinion_models.OpinionTargets"><span class="pre">knn.core.opinion_models.OpinionTargets</span></a></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">vectorizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after_column</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/opinion/models.html#OpinionSpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration describing one opinion-study index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>label</strong> (<em>str</em>)</p></li>
<li><p><strong>before_column</strong> (<em>str</em>)</p></li>
<li><p><strong>after_column</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">after_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">before_column</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">build_example_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/opinion/models.html#OpinionSpec.build_example_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Return the standard keyword arguments for an <code class="docutils literal notranslate"><span class="pre">OpinionExample</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>participant_id</strong> (<em>str</em>) – Participant identifier associated with the example.</p></li>
<li><p><strong>document</strong> (<em>str</em>) – Prompt document presented to the participant.</p></li>
<li><p><strong>before</strong> (<em>float</em>) – Pre-study opinion value.</p></li>
<li><p><strong>after</strong> (<em>float</em>) – Post-study opinion value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of keyword arguments suitable for
<a class="reference internal" href="common.html#common.opinion.opinion_example_kwargs" title="common.opinion.opinion_example_kwargs"><code class="xref py py-func docutils literal notranslate"><span class="pre">opinion_example_kwargs()</span></code></a>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, object]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">key</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">label</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">knn.opinion.</span></span><span class="sig-name descname"><span class="pre">run_opinion_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion.html#run_opinion_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Execute the post-study opinion index evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Any</em>) – Namespace object containing parsed command-line arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.cli">CLI subpackage exposing the public KNN entrypoints.</p>
</section>
<section id="module-knn.core.data">
<span id="core-canonical-paths"></span><h2>Core (Canonical Paths)<a class="headerlink" href="#module-knn.core.data" title="Link to this heading">¶</a></h2>
<p>Dataset loading and filtering utilities for the KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.filter_dataset_for_issue">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.filter_dataset_for_issue" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset down to a specific issue label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">issue</span></code> column.</p></li>
<li><p><strong>issue</strong> (<em>str</em>) – Issue label to retain (<code class="docutils literal notranslate"><span class="pre">all</span></code> preserves every row).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary restricted to rows matching <code class="docutils literal notranslate"><span class="pre">issue</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.filter_dataset_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">filter_dataset_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_dataset_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.filter_dataset_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter the dataset to rows whose <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> matches <code class="docutils literal notranslate"><span class="pre">studies</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing the <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> column.</p></li>
<li><p><strong>studies</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary filtered to the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.filter_split_for_participant_studies">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">filter_split_for_participant_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#filter_split_for_participant_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.filter_split_for_participant_studies" title="Link to this definition">¶</a></dt>
<dd><p>Filter a dataset split to the requested <code class="docutils literal notranslate"><span class="pre">participant_study</span></code> tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_ds</strong> (<em>datasets.Dataset</em>) – Dataset split supporting <code class="xref py py-meth docutils literal notranslate"><span class="pre">filter()</span></code>.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Study identifiers to retain.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered dataset split covering only the requested studies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.issues_in_dataset">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">issues_in_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#issues_in_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.issues_in_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Return the list of issue labels present in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>datasets.DatasetDict</em>) – Dataset dictionary containing at least one split.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted list of issue identifiers or <code class="docutils literal notranslate"><span class="pre">['all']</span></code> when absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.data.load_dataset_source">
<span class="sig-prename descclassname"><span class="pre">knn.core.data.</span></span><span class="sig-name descname"><span class="pre">load_dataset_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/data.html#load_dataset_source"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.data.load_dataset_source" title="Link to this definition">¶</a></dt>
<dd><p>Load a cleaned dataset from disk or from the Hugging Face Hub.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>str</em>) – Local directory path or Hugging Face dataset identifier.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – Cache directory passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">datasets.load_dataset()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataset dictionary containing train and validation splits.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>datasets.DatasetDict</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">datasets</span></code> is unavailable.</p></li>
<li><p><strong>ValueError</strong> – When <code class="docutils literal notranslate"><span class="pre">source</span></code> does not yield a <code class="xref py py-class docutils literal notranslate"><span class="pre">datasets.DatasetDict</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.features">Prompt feature construction utilities shared by the KNN baselines.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">CandidateMetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">video_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#CandidateMetadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.CandidateMetadata" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Lightweight view of slate candidate attributes used for token augmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slot</strong> (<em>int</em>)</p></li>
<li><p><strong>title</strong> (<em>str</em>)</p></li>
<li><p><strong>video_id</strong> (<em>str</em>)</p></li>
<li><p><strong>channel_title</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>channel_id</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.channel_id">
<span class="sig-name descname"><span class="pre">channel_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.channel_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.channel_title">
<span class="sig-name descname"><span class="pre">channel_title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.channel_title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.slot">
<span class="sig-name descname"><span class="pre">slot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.slot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.CandidateMetadata.video_id">
<span class="sig-name descname"><span class="pre">video_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.features.CandidateMetadata.video_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vector_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('models/knn/next_video/word2vec_models')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration options for Word2Vec embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vector_size</strong> (<em>int</em>) – Dimensionality of the learned embedding vectors.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Context window size used during training.</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – Minimum token frequency retained in the vocabulary.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of Word2Vec training epochs.</p></li>
<li><p><strong>model_dir</strong> (<em>Path</em>) – Directory where trained embeddings are persisted.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed for Word2Vec initialisation.</p></li>
<li><p><strong>workers</strong> (<em>int</em>) – Number of worker threads allocated to training.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>vector_size</strong> (<em>int</em>)</p></li>
<li><p><strong>window</strong> (<em>int</em>)</p></li>
<li><p><strong>min_count</strong> (<em>int</em>)</p></li>
<li><p><strong>epochs</strong> (<em>int</em>)</p></li>
<li><p><strong>model_dir</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>seed</strong> (<em>int</em>)</p></li>
<li><p><strong>workers</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.epochs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.min_count">
<span class="sig-name descname"><span class="pre">min_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.min_count" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.model_dir">
<span class="sig-name descname"><span class="pre">model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">PosixPath('models/knn/next_video/word2vec_models')</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.model_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">42</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.vector_size">
<span class="sig-name descname"><span class="pre">vector_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.vector_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.window">
<span class="sig-name descname"><span class="pre">window</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.window" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.features.Word2VecConfig.workers">
<span class="sig-name descname"><span class="pre">workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#knn.core.features.Word2VecConfig.workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">Word2VecFeatureBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create Word2Vec embeddings from viewer prompts.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a>) – Configuration bundle controlling Word2Vec training/inference.</p></li>
<li><p><strong>_model</strong> (<em>gensim.models.Word2Vec</em><em> | </em><em>None</em>) – Loaded gensim <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2Vec</span></code> instance.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>config</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em>]</em>)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the builder with optional configuration overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional configuration bundle to override defaults.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.encode">
<span class="sig-name descname"><span class="pre">encode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.encode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.encode" title="Link to this definition">¶</a></dt>
<dd><p>Return the averaged embedding vector for <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Document to encode using the fitted embeddings.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Averaged embedding vector representing <code class="docutils literal notranslate"><span class="pre">text</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.load" title="Link to this definition">¶</a></dt>
<dd><p>Load a previously trained Word2Vec model from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Directory containing the saved Word2Vec model.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.save" title="Link to this definition">¶</a></dt>
<dd><p>Persist the trained model to <code class="docutils literal notranslate"><span class="pre">directory</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<em>Path</em>) – Destination directory receiving the model artefact.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.train" title="Link to this definition">¶</a></dt>
<dd><p>Train a Word2Vec model using the provided corpus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Iterable</em><em>[</em><em>str</em><em>]</em>) – Iterable of documents used to fit the embeddings.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ImportError</strong> – If <code class="xref py py-mod docutils literal notranslate"><span class="pre">gensim</span></code> is unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.features.Word2VecFeatureBuilder.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/features.html#Word2VecFeatureBuilder.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.Word2VecFeatureBuilder.transform" title="Link to this definition">¶</a></dt>
<dd><p>Return stacked embeddings for <code class="docutils literal notranslate"><span class="pre">corpus</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>corpus</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Sequence of documents to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matrix of shape <code class="docutils literal notranslate"><span class="pre">(len(corpus),</span> <span class="pre">vector_size)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If the model has not been trained or loaded.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.assemble_document">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">assemble_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#assemble_document"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.assemble_document" title="Link to this definition">¶</a></dt>
<dd><p>Concatenate prompt components and selection tokens for feature extraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing base fields and slate metadata.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields injected into the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Document string suitable for downstream vectorisation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.candidate_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">candidate_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">candidate</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">option_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#candidate_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.candidate_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Delegate to <a class="reference internal" href="#knn.core.features.candidate_feature_tokens" title="knn.core.features.candidate_feature_tokens"><code class="xref py py-func docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a> for convenience.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate</strong> (<a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a>) – Slate candidate to transform into feature tokens.</p></li>
<li><p><strong>option_count</strong> (<em>int</em><em> | </em><em>None</em>) – Optional total number of options available.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens describing the candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.collect_candidate_metadata">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">collect_candidate_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#collect_candidate_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.collect_candidate_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Return slate candidate metadata enriched with slot indices and channel info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example providing slate items and metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of
<a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><code class="xref py py-class docutils literal notranslate"><span class="pre">CandidateMetadata</span></code></a> entries for the slate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata">common.prompts.selection.CandidateMetadata</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.extract_now_watching">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">extract_now_watching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_now_watching"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.extract_now_watching" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the currently watched item for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of title and video ID, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if absent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[str, str] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.extract_slate_items">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">extract_slate_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#extract_slate_items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.extract_slate_items" title="Link to this definition">¶</a></dt>
<dd><p>Extract the slate of candidate items from <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing slate candidates.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of <code class="docutils literal notranslate"><span class="pre">(title,</span> <span class="pre">video_id)</span></code> pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<em>Tuple</em>[str, str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.prepare_prompt_documents">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">prepare_prompt_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_prompt_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.prepare_prompt_documents" title="Link to this definition">¶</a></dt>
<dd><p>Convenience wrapper mirroring <a class="reference internal" href="#knn.core.features.prepare_training_documents" title="knn.core.features.prepare_training_documents"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.prepare_training_documents">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">prepare_training_documents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prepare_training_documents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.prepare_training_documents" title="Link to this definition">¶</a></dt>
<dd><p>Prepare prompt documents, labels, and metadata for TF-IDF style training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset consumed by <code class="xref py py-func docutils literal notranslate"><span class="pre">collect_selected_examples()</span></code>.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of training examples to include.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed controlling subsampling determinism.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional additional fields appended to the prompt.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of documents, label IDs, and label titles.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If no eligible documents are generated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple</em>[<em>List</em>[str], <em>List</em>[str], <em>List</em>[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.prompt_from_builder">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">prompt_from_builder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#prompt_from_builder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.prompt_from_builder" title="Link to this definition">¶</a></dt>
<dd><p>Assemble the full prompt text for <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example to convert into prompt text.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full prompt string including contextual tokens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.selection_feature_tokens">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">selection_feature_tokens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#selection_feature_tokens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.selection_feature_tokens" title="Link to this definition">¶</a></dt>
<dd><p>Construct additive tokens that highlight the selected candidate within a prompt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing the gold candidate.</p></li>
<li><p><strong>candidates</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.prompts.selection.CandidateMetadata" title="common.prompts.selection.CandidateMetadata"><em>common.prompts.selection.CandidateMetadata</em></a><em>] </em><em>| </em><em>None</em>) – Precomputed candidate metadata, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to derive it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of tokens emphasising the gold candidate.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.title_for">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">title_for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#title_for"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.title_for" title="Link to this definition">¶</a></dt>
<dd><p>Look up a human-readable title for <code class="docutils literal notranslate"><span class="pre">video_id</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>video_id</strong> (<em>str</em>) – Candidate video identifier.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-friendly title or <code class="docutils literal notranslate"><span class="pre">None</span></code> when unavailable.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.features.viewer_profile_sentence">
<span class="sig-prename descclassname"><span class="pre">knn.core.features.</span></span><span class="sig-name descname"><span class="pre">viewer_profile_sentence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">example</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/prompts/selection.html#viewer_profile_sentence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.features.viewer_profile_sentence" title="Link to this definition">¶</a></dt>
<dd><p>Compose the viewer profile sentence associated with <code class="docutils literal notranslate"><span class="pre">example</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>example</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Prompt example containing viewer metadata.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Viewer profile sentence assembled by the builder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.index">Index construction and scoring logic for the KNN slate baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.build_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">build_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.build_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a sentence-transformer index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>) – Optional <a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SentenceTransformerConfig</span></code></a> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the encoder, dense matrix, and label metadata.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If <code class="docutils literal notranslate"><span class="pre">sentence_transformers</span></code> is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.build_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">build_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.build_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a TF-IDF index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split (Hugging Face dataset or list-like).</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>max_features</strong> (<em>int</em><em> | </em><em>None</em>) – Optional vocabulary cap for the vectoriser.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the fitted vectoriser, sparse matrix, and
label metadata.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.build_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">build_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_ds</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#build_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.build_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Create a Word2Vec index from the training split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_ds</strong> – Training dataset split.</p></li>
<li><p><strong>max_train</strong> (<em>int</em>) – Maximum number of rows to sample for fitting.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed used for subsampling.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Extra textual columns concatenated into each document.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">Word2VecConfig</span></code> override.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing the trained Word2Vec model and embeddings.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong> – If gensim is unavailable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.knn_predict_among_slate_multi">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">knn_predict_among_slate_multi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">example</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#knn_predict_among_slate_multi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.knn_predict_among_slate_multi" title="Link to this definition">¶</a></dt>
<dd><p>Score each slate option using candidate-aware TF-IDF kNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>knn_index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary describing the fitted index artifacts.</p></li>
<li><p><strong>example</strong> (<em>dict</em>) – Dataset row containing the slate to score.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sequence of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate.</p></li>
<li><p><strong>config</strong> (<em>knn.core.index.SlateQueryConfig</em><em> | </em><em>None</em>) – Optional <code class="xref py py-class docutils literal notranslate"><span class="pre">SlateQueryConfig</span></code> overriding defaults.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping from <code class="docutils literal notranslate"><span class="pre">k</span></code> to the predicted 1-based option index. <code class="docutils literal notranslate"><span class="pre">None</span></code>
indicates that a prediction could not be produced for that <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[int, int | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.load_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">load_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.load_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a sentence-transformer index saved via <a class="reference internal" href="#knn.core.index.save_sentence_transformer_index" title="knn.core.index.save_sentence_transformer_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing previously persisted artefacts to load from disk.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of the loaded sentence-transformer index and associated metadata.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.load_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">load_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.load_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a TF-IDF index previously saved via <a class="reference internal" href="#knn.core.index.save_tfidf_index" title="knn.core.index.save_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted TF-IDF artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the loaded vectoriser, matrix, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.load_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">load_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#load_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.load_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Load a Word2Vec index previously saved via <a class="reference internal" href="#knn.core.index.save_word2vec_index" title="knn.core.index.save_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>in_dir</strong> (<em>str</em>) – Directory containing the persisted Word2Vec artifacts.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with the restored Word2Vec model, embeddings, and labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.save_sentence_transformer_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">save_sentence_transformer_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_sentence_transformer_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.save_sentence_transformer_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the sentence-transformer index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – KNN index object or registry being manipulated.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Output directory receiving generated metrics and reports.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.save_tfidf_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">save_tfidf_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_tfidf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.save_tfidf_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the TF-IDF index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.core.index.build_tfidf_index" title="knn.core.index.build_tfidf_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where artifacts will be written.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.index.save_word2vec_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.index.</span></span><span class="sig-name descname"><span class="pre">save_word2vec_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/index.html#save_word2vec_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.index.save_word2vec_index" title="Link to this definition">¶</a></dt>
<dd><p>Persist the Word2Vec index to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> for later reuse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary returned by <a class="reference internal" href="#knn.core.index.build_word2vec_index" title="knn.core.index.build_word2vec_index"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a>.</p></li>
<li><p><strong>out_dir</strong> (<em>str</em>) – Target directory where embeddings and metadata are stored.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.evaluate">Top-level exports for the KNN evaluation helpers.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.bin_nopts">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">bin_nopts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">option_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bin_nopts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.bin_nopts" title="Link to this definition">¶</a></dt>
<dd><p>Bucket the number of slate options into reporting-friendly categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>option_count</strong> (<em>int</em>) – Number of options contained in a recommendation slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="docutils literal notranslate"><span class="pre">{&quot;1&quot;,</span> <span class="pre">&quot;2&quot;,</span> <span class="pre">&quot;3&quot;,</span> <span class="pre">&quot;4&quot;,</span> <span class="pre">&quot;5+&quot;}</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.bucket_from_pos">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">bucket_from_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#bucket_from_pos"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.bucket_from_pos" title="Link to this definition">¶</a></dt>
<dd><p>Bucket a 0-based position index into the standard reporting bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pos_idx</strong> (<em>int</em>) – Zero-based position of the correct item within the retrieved slate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One of <code class="xref py py-data docutils literal notranslate"><span class="pre">BUCKET_LABELS</span></code> describing the position bucket.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.canon">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">canon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/utils.html#canon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.canon" title="Link to this definition">¶</a></dt>
<dd><p>Canonicalise a text fragment by lowercasing and removing punctuation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Raw text fragment to normalise.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Canonical representation suitable for equality comparisons.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.compute_auc_from_curve">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">compute_auc_from_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#compute_auc_from_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.compute_auc_from_curve" title="Link to this definition">¶</a></dt>
<dd><p>Compute the area under the accuracy curve across <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy observed for each <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of (area, normalised_area).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.evaluate_issue">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">evaluate_issue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#evaluate_issue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.evaluate_issue" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate a single issue slice and persist metrics, curves, and predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>request</strong> (<em>knn.core.evaluate.pipeline.IssueEvaluationRequest</em>) – Evaluation bundle describing the issue to score.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Results are persisted via <code class="xref py py-func docutils literal notranslate"><span class="pre">write_issue_outputs()</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.parse_k_values">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">parse_k_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#parse_k_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.parse_k_values" title="Link to this definition">¶</a></dt>
<dd><p>Derive the sorted set of <code class="docutils literal notranslate"><span class="pre">k</span></code> values requested for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_default</strong> (<em>int</em>) – Baseline <code class="docutils literal notranslate"><span class="pre">k</span></code> value used when the sweep is empty.</p></li>
<li><p><strong>sweep</strong> (<em>str</em>) – Comma-delimited string of additional <code class="docutils literal notranslate"><span class="pre">k</span></code> candidates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Strictly positive <code class="docutils literal notranslate"><span class="pre">k</span></code> values in ascending order. Falls back to
<code class="docutils literal notranslate"><span class="pre">k_default</span></code> (or <code class="docutils literal notranslate"><span class="pre">25</span></code> when unset) if no valid integers are supplied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.plot_elbow">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">plot_elbow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'validation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/curves.html#plot_elbow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.plot_elbow" title="Link to this definition">¶</a></dt>
<dd><p>Plot the accuracy curve (acc&#64;k) for the evaluation stage and mark <code class="docutils literal notranslate"><span class="pre">best_k</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values that were evaluated.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Mapping</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Accuracy keyed by <code class="docutils literal notranslate"><span class="pre">k</span></code> for the evaluation split.</p></li>
<li><p><strong>best_k</strong> (<em>int</em>) – Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> to highlight in the plot.</p></li>
<li><p><strong>output_path</strong> (<em>pathlib.Path</em>) – Destination path for the generated PNG artefact.</p></li>
<li><p><strong>data_split</strong> (<em>str</em>) – Split label used for the legend title.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.resolve_reports_dir">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">resolve_reports_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/outputs.html#resolve_reports_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.resolve_reports_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the canonical reports directory corresponding to <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>out_dir</strong> (<em>pathlib.Path</em>) – Directory containing pipeline artefacts (typically under <code class="docutils literal notranslate"><span class="pre">models/knn</span></code>).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path pointing at the repository-level <code class="docutils literal notranslate"><span class="pre">reports</span></code> directory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.run_eval">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/pipeline.html#run_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.run_eval" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the KNN baseline across the issues specified on the CLI.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> – Namespace returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">knn.cli.build_parser()</span></code>, including dataset,
feature-space, and sweep configuration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Evaluation artefacts are persisted via downstream helpers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.evaluate.select_best_k">
<span class="sig-prename descclassname"><span class="pre">knn.core.evaluate.</span></span><span class="sig-name descname"><span class="pre">select_best_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy_by_k</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'elbow'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/evaluate/k_selection.html#select_best_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.evaluate.select_best_k" title="Link to this definition">¶</a></dt>
<dd><p>Select <code class="docutils literal notranslate"><span class="pre">k</span></code> using either max-accuracy or an elbow heuristic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Sorted sequence of evaluated <code class="docutils literal notranslate"><span class="pre">k</span></code> values.</p></li>
<li><p><strong>accuracy_by_k</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>]</em>) – Observed eligible-only accuracy for each <code class="docutils literal notranslate"><span class="pre">k</span></code> on the
validation split.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Selection strategy (default: <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code>). <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code> picks
the accuracy-maximising <code class="docutils literal notranslate"><span class="pre">k</span></code>. <code class="docutils literal notranslate"><span class="pre">&quot;elbow&quot;</span></code> picks the first <code class="docutils literal notranslate"><span class="pre">k</span></code> where
marginal gains fall below half the initial slope, falling back to
max-accuracy when the heuristic is not applicable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Selected <code class="docutils literal notranslate"><span class="pre">k</span></code> per the requested method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion">Opinion-regression utilities supporting the KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion.run_opinion_eval">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion.</span></span><span class="sig-name descname"><span class="pre">run_opinion_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion.html#run_opinion_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion.run_opinion_eval" title="Link to this definition">¶</a></dt>
<dd><p>Execute the post-study opinion index evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>Any</em>) – Namespace object containing parsed command-line arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_models">Shared data structures used by the KNN opinion baseline.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEmbeddingConfigs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionEmbeddingConfigs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word2vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEmbeddingConfigs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optional embedding builders available during evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word2vec</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>sentence_transformer</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEmbeddingConfigs.sentence_transformer">
<span class="sig-name descname"><span class="pre">sentence_transformer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><span class="pre">common.text.embeddings.SentenceTransformerConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.sentence_transformer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEmbeddingConfigs.word2vec">
<span class="sig-name descname"><span class="pre">word2vec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><span class="pre">knn.core.features.Word2VecConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.word2vec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionEvaluationContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs_root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionEvaluationContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared configuration for evaluating a single opinion study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>Any</em>)</p></li>
<li><p><strong>dataset</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Sequence</em><em>[</em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>embedding_configs</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><em>knn.core.opinion_models.OpinionEmbeddingConfigs</em></a>)</p></li>
<li><p><strong>outputs_root</strong> (<em>pathlib.Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.args">
<span class="sig-name descname"><span class="pre">args</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.args" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.embedding_configs">
<span class="sig-name descname"><span class="pre">embedding_configs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs" title="knn.core.opinion_models.OpinionEmbeddingConfigs"><span class="pre">knn.core.opinion_models.OpinionEmbeddingConfigs</span></a></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.embedding_configs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.extra_fields">
<span class="sig-name descname"><span class="pre">extra_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.extra_fields" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.k_values">
<span class="sig-name descname"><span class="pre">k_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.k_values" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionEvaluationContext.outputs_root">
<span class="sig-name descname"><span class="pre">outputs_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionEvaluationContext.outputs_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionExample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">participant_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">document</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">after</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionExample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionExample" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="common.html#common.opinion.models.OpinionExample" title="common.opinion.models.OpinionExample"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.models.OpinionExample</span></code></a></p>
<p>Collapsed participant-level prompt and opinion values with session context.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>session</strong> (<em>Optional</em><em>[</em><a class="reference internal" href="#knn.core.opinion_models.SessionInfo" title="knn.core.opinion_models.SessionInfo"><em>SessionInfo</em></a><em>]</em>) – Optional tuple of step index and session identifier.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>participant_id</strong> (<em>str</em>)</p></li>
<li><p><strong>participant_study</strong> (<em>str</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>document</strong> (<em>str</em>)</p></li>
<li><p><strong>before</strong> (<em>float</em>)</p></li>
<li><p><strong>after</strong> (<em>float</em>)</p></li>
<li><p><strong>session</strong> (<a class="reference internal" href="#knn.core.opinion_models.SessionInfo" title="knn.core.opinion_models.SessionInfo"><em>knn.core.opinion_models.SessionInfo</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.after">
<span class="sig-name descname"><span class="pre">after</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.after" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.before">
<span class="sig-name descname"><span class="pre">before</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.before" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.document">
<span class="sig-name descname"><span class="pre">document</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.document" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.issue">
<span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.issue" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.participant_id">
<span class="sig-name descname"><span class="pre">participant_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.participant_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.participant_study">
<span class="sig-name descname"><span class="pre">participant_study</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.participant_study" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.session">
<span class="sig-name descname"><span class="pre">session</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.SessionInfo" title="knn.core.opinion_models.SessionInfo"><span class="pre">knn.core.opinion_models.SessionInfo</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.session" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.session_id">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">session_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.session_id" title="Link to this definition">¶</a></dt>
<dd><p>Return the recorded session identifier when available.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionExample.step_index">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionExample.step_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the recorded step index or <code class="docutils literal notranslate"><span class="pre">-1</span></code> when unavailable.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neighbors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionIndex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Vectorised training corpus, cached targets, and fitted neighbour index.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (tfidf, word2vec, sentence_transformer).</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Distance metric used by the KNN index.</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>) – Document-term matrix or embedding matrix backing the index.</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>) – Trained vectoriser or embedding builder.</p></li>
<li><p><strong>embeds</strong> (<em>Optional</em><em>[</em><em>Any</em><em>]</em>) – Optional Word2Vec feature builder used for inference.</p></li>
<li><p><strong>targets</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionTargets" title="knn.core.opinion_models.OpinionTargets"><em>OpinionTargets</em></a>) – Grouped post/pre opinion targets and participant keys aligned with the corpus.</p></li>
<li><p><strong>neighbors</strong> (<em>NearestNeighbors</em>) – Fitted <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.neighbors.NearestNeighbors</span></code> index.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>)</p></li>
<li><p><strong>metric</strong> (<em>str</em>)</p></li>
<li><p><strong>matrix</strong> (<em>Any</em>)</p></li>
<li><p><strong>vectorizer</strong> (<em>Any</em>)</p></li>
<li><p><strong>embeds</strong> (<em>Any</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>targets</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionTargets" title="knn.core.opinion_models.OpinionTargets"><em>knn.core.opinion_models.OpinionTargets</em></a>)</p></li>
<li><p><strong>neighbors</strong> (<em>sklearn.neighbors.NearestNeighbors</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.embeds">
<span class="sig-name descname"><span class="pre">embeds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.embeds" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.matrix" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.metric" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.neighbors">
<span class="sig-name descname"><span class="pre">neighbors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">sklearn.neighbors.NearestNeighbors</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.neighbors" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.targets">
<span class="sig-name descname"><span class="pre">targets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.opinion_models.OpinionTargets" title="knn.core.opinion_models.OpinionTargets"><span class="pre">knn.core.opinion_models.OpinionTargets</span></a></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.targets" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionIndex.vectorizer">
<span class="sig-name descname"><span class="pre">vectorizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionIndex.vectorizer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionTargets">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">OpinionTargets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">after</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">before</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">participant_keys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#OpinionTargets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.OpinionTargets" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Aligned opinion targets and participant keys used during evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>after</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><strong>before</strong> (<em>numpy.ndarray</em>)</p></li>
<li><p><strong>participant_keys</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionTargets.after">
<span class="sig-name descname"><span class="pre">after</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionTargets.after" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionTargets.before">
<span class="sig-name descname"><span class="pre">before</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionTargets.before" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.OpinionTargets.participant_keys">
<span class="sig-name descname"><span class="pre">participant_keys</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.core.opinion_models.OpinionTargets.participant_keys" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_models.SessionInfo">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_models.</span></span><span class="sig-name descname"><span class="pre">SessionInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_models.html#SessionInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_models.SessionInfo" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optional session context attached to an opinion example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_index</strong> (<em>int</em>)</p></li>
<li><p><strong>session_id</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.SessionInfo.session_id">
<span class="sig-name descname"><span class="pre">session_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_models.SessionInfo.session_id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_models.SessionInfo.step_index">
<span class="sig-name descname"><span class="pre">step_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.core.opinion_models.SessionInfo.step_index" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.core.opinion_data">Dataset helpers for opinion-regression studies.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_data.collect_examples">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_data.</span></span><span class="sig-name descname"><span class="pre">collect_examples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_examples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_data.html#collect_examples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_data.collect_examples" title="Link to this definition">¶</a></dt>
<dd><p>Collapse the dataset split into participant-level opinion rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>datasets.Dataset</em><em> | </em><em>Sequence</em><em>[</em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Dataset split providing raw participant interactions.</p></li>
<li><p><strong>spec</strong> (<a class="reference internal" href="common.html#common.opinion.OpinionSpec" title="common.opinion.OpinionSpec"><em>OpinionSpec</em></a>) – Opinion study specification describing the target columns.</p></li>
<li><p><strong>extra_fields</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Additional prompt columns appended to each document.</p></li>
<li><p><strong>max_examples</strong> (<em>int</em><em> | </em><em>None</em>) – Optional cap on participants retained from the split.</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random seed applied when subsampling participants.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Participant-level examples combining prompts and opinion values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.core.opinion_models.OpinionExample" title="knn.core.opinion_models.OpinionExample"><em>OpinionExample</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_data.find_spec">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_data.</span></span><span class="sig-name descname"><span class="pre">find_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_data.html#find_spec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_data.find_spec" title="Link to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="common.html#common.opinion.OpinionSpec" title="common.opinion.OpinionSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionSpec</span></code></a> matching <code class="docutils literal notranslate"><span class="pre">key</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – Dictionary key identifying the current record.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Matching opinion specification.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="common.html#common.opinion.OpinionSpec" title="common.opinion.OpinionSpec"><em>OpinionSpec</em></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If <code class="docutils literal notranslate"><span class="pre">key</span></code> does not correspond to a known spec.</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_index">Feature-space transformations and neighbour indices for opinion regression.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.core.opinion_index.</span></span><span class="sig-name descname"><span class="pre">OpinionIndexConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_index.html#OpinionIndexConfig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration for building an <a class="reference internal" href="#knn.core.opinion_models.OpinionIndex" title="knn.core.opinion_models.OpinionIndex"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionIndex</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (<code class="docutils literal notranslate"><span class="pre">tfidf</span></code>, <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>,
or <code class="docutils literal notranslate"><span class="pre">sentence_transformer</span></code>).</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Distance metric used for neighbour search (<code class="docutils literal notranslate"><span class="pre">cosine</span></code> or <code class="docutils literal notranslate"><span class="pre">l2</span></code>).</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Pseudo-random seed used by components that rely on randomness.</p></li>
<li><p><strong>word2vec</strong> (<a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><em>knn.core.features.Word2VecConfig</em></a><em> | </em><em>None</em>) – Optional Word2Vec configuration for the <code class="docutils literal notranslate"><span class="pre">word2vec</span></code> feature space.</p></li>
<li><p><strong>sentence_transformer</strong> (<a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><em>common.text.embeddings.SentenceTransformerConfig</em></a><em> | </em><em>None</em>) – Optional sentence-transformer configuration for the
<code class="docutils literal notranslate"><span class="pre">sentence_transformer</span></code> feature space.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig.feature_space_norm">
<span class="sig-name descname"><span class="pre">feature_space_norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_index.html#OpinionIndexConfig.feature_space_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig.feature_space_norm" title="Link to this definition">¶</a></dt>
<dd><p>Return the normalised feature-space token.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig.metric" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig.metric_norm">
<span class="sig-name descname"><span class="pre">metric_norm</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_index.html#OpinionIndexConfig.metric_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig.metric_norm" title="Link to this definition">¶</a></dt>
<dd><p>Return the validated distance metric token (cosine or l2).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig.seed" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig.sentence_transformer">
<span class="sig-name descname"><span class="pre">sentence_transformer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.text.embeddings.SentenceTransformerConfig" title="common.text.embeddings.SentenceTransformerConfig"><span class="pre">common.text.embeddings.SentenceTransformerConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig.sentence_transformer" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.core.opinion_index.OpinionIndexConfig.word2vec">
<span class="sig-name descname"><span class="pre">word2vec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.core.features.Word2VecConfig" title="knn.core.features.Word2VecConfig"><span class="pre">knn.core.features.Word2VecConfig</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.core.opinion_index.OpinionIndexConfig.word2vec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_index.build_index">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_index.</span></span><span class="sig-name descname"><span class="pre">build_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">examples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_index.html#build_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_index.build_index" title="Link to this definition">¶</a></dt>
<dd><p>Vectorise <code class="docutils literal notranslate"><span class="pre">examples</span></code> and construct a neighbour index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>examples</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.core.opinion_models.OpinionExample" title="knn.core.opinion_models.OpinionExample"><em>OpinionExample</em></a><em>]</em>) – Collection of dataset rows used in the evaluation.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig" title="knn.core.opinion_index.OpinionIndexConfig"><em>OpinionIndexConfig</em></a>) – Configuration controlling feature space, metric, and encoders.</p></li>
<li><p><strong>spec</strong> (<a class="reference internal" href="common.html#common.opinion.OpinionSpec" title="common.opinion.OpinionSpec"><em>OpinionSpec</em></a>) – Opinion study specification containing issue metadata.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured KNN index ready for inference.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex" title="knn.core.opinion_models.OpinionIndex">OpinionIndex</a></p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_predictions">Prediction and metric utilities for the KNN opinion pipeline.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.opinion_predictions.predict_post_indices">
<span class="sig-prename descclassname"><span class="pre">knn.core.opinion_predictions.</span></span><span class="sig-name descname"><span class="pre">predict_post_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_examples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/core/opinion_predictions.html#predict_post_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.opinion_predictions.predict_post_indices" title="Link to this definition">¶</a></dt>
<dd><p>Return predictions and aggregate metrics for <code class="docutils literal notranslate"><span class="pre">eval_examples</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<a class="reference internal" href="#knn.core.opinion_models.OpinionIndex" title="knn.core.opinion_models.OpinionIndex"><em>OpinionIndex</em></a>) – KNN index object or registry being manipulated.</p></li>
<li><p><strong>eval_examples</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.core.opinion_models.OpinionExample" title="knn.core.opinion_models.OpinionExample"><em>OpinionExample</em></a><em>]</em>) – Iterable of evaluation examples to score with the index.</p></li>
<li><p><strong>k_values</strong> (<em>Sequence</em><em>[</em><em>int</em><em>]</em>) – Iterable of <code class="docutils literal notranslate"><span class="pre">k</span></code> values to evaluate or report.</p></li>
<li><p><strong>exclude_self</strong> (<em>bool</em>) – Whether to drop the query point when collecting nearest neighbours.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predictions and aggregate metrics keyed by <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.core.opinion_plots">Plotting utilities for KNN opinion evaluations.</p>
<p id="module-knn.core.opinion_outputs">Output helpers for persisting opinion evaluation artefacts.</p>
<p id="module-knn.core.utils">Shim exposing common logging and filesystem helpers to KNN modules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.core.utils.ensure_directory">
<span class="sig-prename descclassname"><span class="pre">knn.core.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#ensure_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.utils.ensure_directory" title="Link to this definition">¶</a></dt>
<dd><p>Create <code class="docutils literal notranslate"><span class="pre">path</span></code> (including parents) when it does not already exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>pathlib.Path</em><em> | </em><em>str</em>) – Target directory to ensure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.core.utils.get_logger">
<span class="sig-prename descclassname"><span class="pre">knn.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.core.utils.get_logger" title="Link to this definition">¶</a></dt>
<dd><p>Return a memoised logger configured with a simple stream handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name registered on the logger.</p></li>
<li><p><strong>level</strong> (<em>int</em>) – Log level applied when initialising the logger.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured logger instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.utils">
<span id="core-utilities"></span><h2>Core Utilities<a class="headerlink" href="#module-knn.utils" title="Link to this heading">¶</a></h2>
<p>Shim exposing common logging and filesystem helpers to KNN modules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.utils.ensure_directory">
<span class="sig-prename descclassname"><span class="pre">knn.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_directory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#ensure_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.utils.ensure_directory" title="Link to this definition">¶</a></dt>
<dd><p>Create <code class="docutils literal notranslate"><span class="pre">path</span></code> (including parents) when it does not already exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>pathlib.Path</em><em> | </em><em>str</em>) – Target directory to ensure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.utils.get_logger">
<span class="sig-prename descclassname"><span class="pre">knn.utils.</span></span><span class="sig-name descname"><span class="pre">get_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/logging/utils.html#get_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.utils.get_logger" title="Link to this definition">¶</a></dt>
<dd><p>Return a memoised logger configured with a simple stream handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name registered on the logger.</p></li>
<li><p><strong>level</strong> (<em>int</em>) – Log level applied when initialising the logger.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured logger instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.pipeline.context">
<span id="pipeline-modules"></span><h2>Pipeline Modules<a class="headerlink" href="#module-knn.pipeline.context" title="Link to this heading">¶</a></h2>
<p>Aggregated context and types for the KNN pipeline.</p>
<p>This module re-exports the public context types used across the pipeline while
keeping implementations split into focused modules (pipeline, evaluation,
config, sweeps, tasks, and report bundles). This avoids duplication and keeps
attribute counts small for linting.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">EvaluationContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_models</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.EvaluationContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared CLI/runtime parameters for final evaluation stages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>)</p></li>
<li><p><strong>outputs</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs" title="knn.pipeline.context.EvaluationOutputs"><em>EvaluationOutputs</em></a>)</p></li>
<li><p><strong>word2vec_models</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths" title="knn.pipeline.context.EvaluationWord2VecPaths"><em>EvaluationWord2VecPaths</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.base_cli">
<span class="sig-name descname"><span class="pre">base_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.base_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.extra_cli">
<span class="sig-name descname"><span class="pre">extra_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.extra_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.from_args">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_video_out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_out_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_video_word2vec_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_word2vec_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">overrides</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_evaluation.html#EvaluationContext.from_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.from_args" title="Link to this definition">¶</a></dt>
<dd><p>Build an <a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluationContext</span></code></a> from legacy or task-specific overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Base CLI arguments used by evaluation commands.</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Additional CLI flags toggled by the caller.</p></li>
<li><p><strong>next_video_out_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Default next-video output directory.</p></li>
<li><p><strong>opinion_out_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Default opinion output directory.</p></li>
<li><p><strong>next_video_word2vec_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Default next-video Word2Vec cache directory.</p></li>
<li><p><strong>opinion_word2vec_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Default opinion Word2Vec cache directory.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Whether to reuse existing artefacts on disk.</p></li>
<li><p><strong>overrides</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Optional keywords to override directory defaults.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fully constructed evaluation context with resolved paths.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext">knn.pipeline.context.EvaluationContext</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.next_video_out_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">next_video_out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.next_video_out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolved next-video output directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.next_video_word2vec_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">next_video_word2vec_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.next_video_word2vec_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolved Word2Vec cache directory for next-video runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.opinion_out_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.opinion_out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolved opinion output directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.opinion_word2vec_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_word2vec_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.opinion_word2vec_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolved Word2Vec cache directory for opinion runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.out_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Shared root output directory used by evaluations.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.outputs">
<span class="sig-name descname"><span class="pre">outputs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs" title="knn.pipeline.context.EvaluationOutputs"><span class="pre">EvaluationOutputs</span></a></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.outputs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.reuse_existing">
<span class="sig-name descname"><span class="pre">reuse_existing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.reuse_existing" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.word2vec_model_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd><p>Shared Word2Vec cache root directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationContext.word2vec_models">
<span class="sig-name descname"><span class="pre">word2vec_models</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths" title="knn.pipeline.context.EvaluationWord2VecPaths"><span class="pre">EvaluationWord2VecPaths</span></a></em><a class="headerlink" href="#knn.pipeline.context.EvaluationContext.word2vec_models" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationOutputs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">EvaluationOutputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">next_video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.EvaluationOutputs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalised directory layout for next-video and opinion evaluation artefacts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>next_video</strong> (<em>Path</em>)</p></li>
<li><p><strong>opinion</strong> (<em>Path</em>)</p></li>
<li><p><strong>shared</strong> (<em>Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationOutputs.from_keywords">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_keywords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_video_out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_out_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_evaluation.html#EvaluationOutputs.from_keywords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.EvaluationOutputs.from_keywords" title="Link to this definition">¶</a></dt>
<dd><p>Materialise outputs while supporting legacy <code class="docutils literal notranslate"><span class="pre">out_dir</span></code> overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Shared root directory used when specific outputs are absent.</p></li>
<li><p><strong>next_video_out_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Explicit directory for next-video evaluation artefacts.</p></li>
<li><p><strong>opinion_out_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Explicit directory for opinion evaluation artefacts.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalised output directory structure for the evaluation run.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs" title="knn.pipeline.context.EvaluationOutputs">knn.pipeline.context.EvaluationOutputs</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationOutputs.next_video">
<span class="sig-name descname"><span class="pre">next_video</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationOutputs.next_video" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationOutputs.opinion">
<span class="sig-name descname"><span class="pre">opinion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationOutputs.opinion" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationOutputs.shared">
<span class="sig-name descname"><span class="pre">shared</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationOutputs.shared" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationWord2VecPaths">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">EvaluationWord2VecPaths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">next_video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shared</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.EvaluationWord2VecPaths" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalised Word2Vec cache layout for next-video and opinion runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>next_video</strong> (<em>Path</em>)</p></li>
<li><p><strong>opinion</strong> (<em>Path</em>)</p></li>
<li><p><strong>shared</strong> (<em>Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationWord2VecPaths.from_keywords">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_keywords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_video_word2vec_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_word2vec_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fallback_parent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_evaluation.html#EvaluationWord2VecPaths.from_keywords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.EvaluationWord2VecPaths.from_keywords" title="Link to this definition">¶</a></dt>
<dd><p>Materialise Word2Vec cache directories while supporting legacy overrides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word2vec_model_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Shared Word2Vec cache root for both tasks.</p></li>
<li><p><strong>next_video_word2vec_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Cache directory for next-video Word2Vec artefacts.</p></li>
<li><p><strong>opinion_word2vec_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Cache directory for opinion Word2Vec artefacts.</p></li>
<li><p><strong>fallback_parent</strong> (<em>pathlib.Path</em>) – Parent used to construct a default cache directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalised Word2Vec cache directory structure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths" title="knn.pipeline.context.EvaluationWord2VecPaths">knn.pipeline.context.EvaluationWord2VecPaths</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationWord2VecPaths.next_video">
<span class="sig-name descname"><span class="pre">next_video</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationWord2VecPaths.next_video" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationWord2VecPaths.opinion">
<span class="sig-name descname"><span class="pre">opinion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationWord2VecPaths.opinion" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.EvaluationWord2VecPaths.shared">
<span class="sig-name descname"><span class="pre">shared</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.EvaluationWord2VecPaths.shared" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">MetricSummary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#MetricSummary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.MetricSummary" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalised slice of slate evaluation metrics used across reports.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accuracy</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Validation accuracy for the selected configuration.</p></li>
<li><p><strong>accuracy_ci</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – 95% confidence interval for <a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy" title="knn.pipeline.context.MetricSummary.accuracy"><code class="xref py py-attr docutils literal notranslate"><span class="pre">accuracy</span></code></a>.</p></li>
<li><p><strong>baseline</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Baseline accuracy from the most-frequent-gold comparator.</p></li>
<li><p><strong>baseline_ci</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – 95% confidence interval for <a class="reference internal" href="#knn.pipeline.context.MetricSummary.baseline" title="knn.pipeline.context.MetricSummary.baseline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">baseline</span></code></a>.</p></li>
<li><p><strong>random_baseline</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Expected accuracy for a random slate selection baseline.</p></li>
<li><p><strong>best_k</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – <code class="docutils literal notranslate"><span class="pre">k</span></code> value delivering the best validation accuracy.</p></li>
<li><p><strong>n_total</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Total number of evaluation rows considered.</p></li>
<li><p><strong>n_eligible</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Number of rows eligible for the final metric.</p></li>
<li><p><strong>accuracy_all_rows</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Accuracy over all rows (eligible and ineligible).</p></li>
<li><p><strong>inputs</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#MetricSummary.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.MetricSummary.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a metric summary from a typed mapping.</p>
<p>Expected keys in <code class="docutils literal notranslate"><span class="pre">inputs</span></code> (all optional):
<code class="docutils literal notranslate"><span class="pre">accuracy</span></code> (float), <code class="docutils literal notranslate"><span class="pre">accuracy_ci</span></code> (tuple[float, float]),
<code class="docutils literal notranslate"><span class="pre">baseline</span></code> (float), <code class="docutils literal notranslate"><span class="pre">baseline_ci</span></code> (tuple[float, float]),
<code class="docutils literal notranslate"><span class="pre">random_baseline</span></code> (float), <code class="docutils literal notranslate"><span class="pre">best_k</span></code> (int),
<code class="docutils literal notranslate"><span class="pre">n_total</span></code> (int), <code class="docutils literal notranslate"><span class="pre">n_eligible</span></code> (int), <code class="docutils literal notranslate"><span class="pre">accuracy_all_rows</span></code> (float).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inputs</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.accuracy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Validation accuracy for the selected configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.accuracy_all_rows">
<span class="sig-name descname"><span class="pre">accuracy_all_rows</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.accuracy_all_rows" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.accuracy_ci">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy_ci</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.accuracy_ci" title="Link to this definition">¶</a></dt>
<dd><p>95% confidence interval for <a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy" title="knn.pipeline.context.MetricSummary.accuracy"><code class="xref py py-attr docutils literal notranslate"><span class="pre">accuracy</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[float, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.baseline">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.baseline" title="Link to this definition">¶</a></dt>
<dd><p>Baseline accuracy from a standard comparator.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.baseline_ci">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">baseline_ci</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.baseline_ci" title="Link to this definition">¶</a></dt>
<dd><p>95% confidence interval for <a class="reference internal" href="#knn.pipeline.context.MetricSummary.baseline" title="knn.pipeline.context.MetricSummary.baseline"><code class="xref py py-attr docutils literal notranslate"><span class="pre">baseline</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[float, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.best_k">
<span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.best_k" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.n_eligible">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_eligible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.n_eligible" title="Link to this definition">¶</a></dt>
<dd><p>Number of rows eligible for the final metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.n_total">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_total</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.n_total" title="Link to this definition">¶</a></dt>
<dd><p>Total number of evaluation rows considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.MetricSummary.random_baseline">
<span class="sig-name descname"><span class="pre">random_baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.MetricSummary.random_baseline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionStudySelection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionStudySelection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.OpinionStudySelection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="common.html#common.pipeline.types.OpinionStudySelection" title="common.pipeline.types.OpinionStudySelection"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.pipeline.types.OpinionStudySelection</span></code></a></p>
<p>Selected configuration for the final opinion evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="common.pipeline.types.StudySpec"><em>common.pipeline.types.StudySpec</em></a>)</p></li>
<li><p><strong>outcome</strong> (<em>OutcomeT</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionStudySelection.best_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionStudySelection.best_k" title="Link to this definition">¶</a></dt>
<dd><p>Return the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> for the study.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionSummary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#OpinionSummary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSummary" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="common.html#common.opinion.models.OpinionCalibrationMetrics" title="common.opinion.models.OpinionCalibrationMetrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.models.OpinionCalibrationMetrics</span></code></a></p>
<p>Normalised view of opinion-regression metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mae</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Mean absolute error for the selected configuration.</p></li>
<li><p><strong>rmse</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Root-mean-square error for the selected configuration.</p></li>
<li><p><strong>r2_score</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Coefficient of determination capturing explained variance.</p></li>
<li><p><strong>mae_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Normalised change in MAE relative to the baseline.</p></li>
<li><p><strong>rmse_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Root-mean-square error on the opinion-change signal.</p></li>
<li><p><strong>baseline_mae</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Baseline MAE measured using pre-study opinions.</p></li>
<li><p><strong>baseline_rmse_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Baseline RMSE on the opinion-change signal.</p></li>
<li><p><strong>mae_delta</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Absolute delta between <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae" title="knn.pipeline.context.OpinionSummary.mae"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mae</span></code></a> and <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.baseline_mae" title="knn.pipeline.context.OpinionSummary.baseline_mae"><code class="xref py py-attr docutils literal notranslate"><span class="pre">baseline_mae</span></code></a>.</p></li>
<li><p><strong>accuracy</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Directional accuracy comparing predicted opinion shifts.</p></li>
<li><p><strong>calibration_slope</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Calibration slope between predicted and actual opinion deltas.</p></li>
<li><p><strong>calibration_intercept</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Calibration intercept between predicted and actual opinion deltas.</p></li>
<li><p><strong>calibration_ece</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Expected calibration error computed over opinion-change bins.</p></li>
<li><p><strong>kl_divergence_change</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – KL divergence between predicted and actual change distributions.</p></li>
<li><p><strong>calibration_bins</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>, </em><em>...</em><em>]</em><em>]</em>) – Optional tuple of bin summaries backing
<a class="reference internal" href="common.html#common.opinion.OpinionCalibrationMetrics.calibration_ece" title="common.opinion.OpinionCalibrationMetrics.calibration_ece"><code class="xref py py-attr docutils literal notranslate"><span class="pre">calibration_ece</span></code></a>.</p></li>
<li><p><strong>best_k</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Neighbourhood size delivering the final metrics.</p></li>
<li><p><strong>participants</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Number of participants included in the evaluation split.</p></li>
<li><p><strong>eligible</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Count of evaluation examples used to compute accuracy metrics.</p></li>
<li><p><strong>dataset</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Name of the dataset used to compute the metrics.</p></li>
<li><p><strong>split</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Dataset split powering the evaluation (e.g. <code class="docutils literal notranslate"><span class="pre">train</span></code>, <code class="docutils literal notranslate"><span class="pre">validation</span></code>).</p></li>
<li><p><strong>inputs</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Inputs" title="knn.pipeline.context.OpinionSummary.Inputs"><em>OpinionSummary.Inputs</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Note<span class="colon">:</span></dt>
<dd class="field-even"><p>Baseline and calibration deltas are documented in
<a class="reference internal" href="common.html#common.opinion.OpinionCalibrationMetrics" title="common.opinion.OpinionCalibrationMetrics"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionCalibrationMetrics</span></code></a>.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.BaselineStats">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BaselineStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">baseline_mae</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mae_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#OpinionSummary.BaselineStats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.BaselineStats" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Baseline opinion regression metrics and deltas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>baseline_mae</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>mae_delta</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.BaselineStats.baseline_mae">
<span class="sig-name descname"><span class="pre">baseline_mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.BaselineStats.baseline_mae" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.BaselineStats.mae_delta">
<span class="sig-name descname"><span class="pre">mae_delta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.BaselineStats.mae_delta" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.ChangeStats">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ChangeStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mae_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmse_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline_rmse_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#OpinionSummary.ChangeStats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.ChangeStats" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Opinion-change signal metrics, including baseline reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mae_change</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>rmse_change</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>baseline_rmse_change</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.ChangeStats.baseline_rmse_change">
<span class="sig-name descname"><span class="pre">baseline_rmse_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.ChangeStats.baseline_rmse_change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.ChangeStats.mae_change">
<span class="sig-name descname"><span class="pre">mae_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.ChangeStats.mae_change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.ChangeStats.rmse_change">
<span class="sig-name descname"><span class="pre">rmse_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.ChangeStats.rmse_change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Inputs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calibration=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regression=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calibration_bins=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#OpinionSummary.Inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Inputs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Grouped construction inputs reducing local variables in __init__.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calibration</strong> (<a class="reference internal" href="common.html#common.opinion.models.OpinionCalibrationMetrics" title="common.opinion.models.OpinionCalibrationMetrics"><em>common.opinion.models.OpinionCalibrationMetrics</em></a>)</p></li>
<li><p><strong>regression</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Regression" title="knn.pipeline.context_summaries.OpinionSummary.Regression"><em>knn.pipeline.context_summaries.OpinionSummary.Regression</em></a>)</p></li>
<li><p><strong>accuracy</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>calibration_bins</strong> (<em>Tuple</em><em>[</em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>float</em><em>]</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Inputs.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Inputs.accuracy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Inputs.calibration">
<span class="sig-name descname"><span class="pre">calibration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.opinion.models.OpinionCalibrationMetrics" title="common.opinion.models.OpinionCalibrationMetrics"><span class="pre">common.opinion.models.OpinionCalibrationMetrics</span></a></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Inputs.calibration" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Inputs.calibration_bins">
<span class="sig-name descname"><span class="pre">calibration_bins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Inputs.calibration_bins" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Inputs.regression">
<span class="sig-name descname"><span class="pre">regression</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Regression" title="knn.pipeline.context_summaries.OpinionSummary.Regression"><span class="pre">knn.pipeline.context_summaries.OpinionSummary.Regression</span></a></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Inputs.regression" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.PrimaryRegression">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PrimaryRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mae</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2_score</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#OpinionSummary.PrimaryRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Primary regression metrics for opinion models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mae</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>rmse</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>r2_score</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.PrimaryRegression.mae">
<span class="sig-name descname"><span class="pre">mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression.mae" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.PrimaryRegression.r2_score">
<span class="sig-name descname"><span class="pre">r2_score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression.r2_score" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.PrimaryRegression.rmse">
<span class="sig-name descname"><span class="pre">rmse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression.rmse" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Regression">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">primary=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_summaries.html#OpinionSummary.Regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Regression" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Grouped opinion-regression metrics, reducing attribute count.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression" title="knn.pipeline.context_summaries.OpinionSummary.PrimaryRegression"><em>knn.pipeline.context_summaries.OpinionSummary.PrimaryRegression</em></a>)</p></li>
<li><p><strong>change</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSummary.ChangeStats" title="knn.pipeline.context_summaries.OpinionSummary.ChangeStats"><em>knn.pipeline.context_summaries.OpinionSummary.ChangeStats</em></a>)</p></li>
<li><p><strong>baseline</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSummary.BaselineStats" title="knn.pipeline.context_summaries.OpinionSummary.BaselineStats"><em>knn.pipeline.context_summaries.OpinionSummary.BaselineStats</em></a>)</p></li>
<li><p><strong>best_k</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Regression.baseline">
<span class="sig-name descname"><span class="pre">baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.BaselineStats" title="knn.pipeline.context_summaries.OpinionSummary.BaselineStats"><span class="pre">knn.pipeline.context_summaries.OpinionSummary.BaselineStats</span></a></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Regression.baseline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Regression.best_k">
<span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Regression.best_k" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Regression.change">
<span class="sig-name descname"><span class="pre">change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.ChangeStats" title="knn.pipeline.context_summaries.OpinionSummary.ChangeStats"><span class="pre">knn.pipeline.context_summaries.OpinionSummary.ChangeStats</span></a></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Regression.change" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.Regression.primary">
<span class="sig-name descname"><span class="pre">primary</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression" title="knn.pipeline.context_summaries.OpinionSummary.PrimaryRegression"><span class="pre">knn.pipeline.context_summaries.OpinionSummary.PrimaryRegression</span></a></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.Regression.primary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.accuracy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Directional accuracy comparing predicted opinion shifts.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.baseline_mae">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">baseline_mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.baseline_mae" title="Link to this definition">¶</a></dt>
<dd><p>Baseline MAE measured with pre-study opinions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.baseline_rmse_change">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">baseline_rmse_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.baseline_rmse_change" title="Link to this definition">¶</a></dt>
<dd><p>Baseline RMSE on the opinion-change signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.best_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.best_k" title="Link to this definition">¶</a></dt>
<dd><p>Neighbourhood size delivering the final metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.calibration_bins">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calibration_bins</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.calibration_bins" title="Link to this definition">¶</a></dt>
<dd><p>Optional underlying calibration bin summaries (ECE provenance).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.mae">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.mae" title="Link to this definition">¶</a></dt>
<dd><p>Mean absolute error of the selected configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.mae_change">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mae_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.mae_change" title="Link to this definition">¶</a></dt>
<dd><p>MAE on the opinion-change signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.mae_delta">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mae_delta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.mae_delta" title="Link to this definition">¶</a></dt>
<dd><p>Delta between <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae" title="knn.pipeline.context.OpinionSummary.mae"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mae</span></code></a> and <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.baseline_mae" title="knn.pipeline.context.OpinionSummary.baseline_mae"><code class="xref py py-attr docutils literal notranslate"><span class="pre">baseline_mae</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.r2_score">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r2_score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.r2_score" title="Link to this definition">¶</a></dt>
<dd><p>Coefficient of determination (R²) for the selected configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.rmse">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rmse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.rmse" title="Link to this definition">¶</a></dt>
<dd><p>Root-mean-square error of the selected configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummary.rmse_change">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rmse_change</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSummary.rmse_change" title="Link to this definition">¶</a></dt>
<dd><p>RMSE on the opinion-change signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[float]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSummaryInputs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionSummaryInputs</span></span><a class="headerlink" href="#knn.pipeline.context.OpinionSummaryInputs" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Inputs" title="knn.pipeline.context_summaries.OpinionSummary.Inputs"><code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context_summaries.OpinionSummary.Inputs</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionSweepOutcome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">legacy_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Opinion regression metrics for a (study, configuration) evaluation.</p>
<p>Composition-based wrapper around
<code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseOpinionSweepOutcome</span></code> enriched with
KNN-specific opinion metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<em>BaseOpinionSweepOutcome</em>) – Base opinion outcome carrying common metrics and artefacts.</p></li>
<li><p><strong>knn</strong> (<em>object</em>) – Extra KNN opinion metrics captured for the run.</p></li>
<li><p><strong>legacy_kwargs</strong> (<em>object</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">legacy_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_sweeps.html#OpinionSweepOutcome.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct an opinion sweep outcome.</p>
<p>Accepts composed <code class="docutils literal notranslate"><span class="pre">base</span></code> + <code class="docutils literal notranslate"><span class="pre">knn</span></code> or legacy flat kwargs used by tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<a class="reference internal" href="common.html#common.opinion.BaseOpinionSweepOutcome" title="common.opinion.BaseOpinionSweepOutcome"><em>BaseOpinionSweepOutcome</em></a><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>knn</strong> (<em>object</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>legacy_kwargs</strong> (<em>object</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.accuracy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Directional accuracy achieved by the configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.accuracy_delta">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy_delta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.accuracy_delta" title="Link to this definition">¶</a></dt>
<dd><p>Improvement over baseline directional accuracy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.artifact">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">artifact</span></span><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.artifact" title="Link to this definition">¶</a></dt>
<dd><p>Return the metrics artefact wrapper for this outcome.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.baseline_accuracy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">baseline_accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.baseline_accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Baseline directional accuracy for comparison.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.baseline_mae">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">baseline_mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.baseline_mae" title="Link to this definition">¶</a></dt>
<dd><p>Return the baseline MAE used for comparison, if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Baseline mean absolute error or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unknown.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.best_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.best_k" title="Link to this definition">¶</a></dt>
<dd><p>Return the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> for the KNN regressor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Best-performing neighbor count.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.config">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><span class="pre">knn.pipeline.context.SweepConfig</span></a></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.config" title="Link to this definition">¶</a></dt>
<dd><p>Return the configuration evaluated for the outcome.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.eligible">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eligible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.eligible" title="Link to this definition">¶</a></dt>
<dd><p>Number of examples contributing to the accuracy figures.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.feature_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.feature_space" title="Link to this definition">¶</a></dt>
<dd><p>Return the feature space label used for opinion evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Feature space identifier (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;word2vec&quot;</span></code>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.mae">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mae</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.mae" title="Link to this definition">¶</a></dt>
<dd><p>Mean absolute error achieved by the configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.mae_delta">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mae_delta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.mae_delta" title="Link to this definition">¶</a></dt>
<dd><p>Return the improvement over baseline MAE (baseline - MAE).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>MAE delta or <code class="docutils literal notranslate"><span class="pre">None</span></code> when baseline is unavailable.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.metrics">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.metrics" title="Link to this definition">¶</a></dt>
<dd><p>Raw metrics payload loaded from disk.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.metrics_path">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.metrics_path" title="Link to this definition">¶</a></dt>
<dd><p>Filesystem path to the persisted metrics JSON.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.order_index">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">order_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.order_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the stable ordering index for this outcome.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.participants">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">participants</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.participants" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of participants included in the study.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Participant count used for the opinion metrics.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.r2_score">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r2_score</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.r2_score" title="Link to this definition">¶</a></dt>
<dd><p>Return the coefficient of determination (R²).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>R² score of the regression.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.rmse">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rmse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.rmse" title="Link to this definition">¶</a></dt>
<dd><p>Root mean squared error achieved by the configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepOutcome.study">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">study</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="common.pipeline.types.StudySpec"><span class="pre">common.pipeline.types.StudySpec</span></a></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepOutcome.study" title="Link to this definition">¶</a></dt>
<dd><p>Return the study metadata associated with the outcome.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">OpinionSweepTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="common.html#common.opinion.BaseOpinionSweepTask" title="common.opinion.BaseOpinionSweepTask"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.BaseOpinionSweepTask</span></code></a>[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context.SweepConfig</span></code></a>]</p>
<p>Extend <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseOpinionSweepTask</span></code> with CLI context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>)</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a>)</p></li>
<li><p><strong>metrics_path</strong> (<em>Path</em>)</p></li>
<li><p><strong>base_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>extra_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>run_root</strong> (<em>Path</em>)</p></li>
<li><p><strong>word2vec_model_dir</strong> (<em>Path</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.base_cli">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.base_cli" title="Link to this definition">¶</a></dt>
<dd><p>Baseline CLI arguments reused across tasks.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.extra_cli">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extra_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.extra_cli" title="Link to this definition">¶</a></dt>
<dd><p>Additional passthrough CLI arguments for the job.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.run_root">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.run_root" title="Link to this definition">¶</a></dt>
<dd><p>Directory where opinion sweep outputs are written.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.OpinionSweepTask.word2vec_model_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.OpinionSweepTask.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd><p>Optional path to cached Word2Vec models used by this task.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">PipelineContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_sweep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workflow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">flat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.PipelineContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalised configuration for a KNN pipeline run.</p>
<p>Provides read-only accessors for most fields, while allowing controlled
updates to sentence-transformer settings so cached artefacts can be reused
across stages (see <code class="docutils literal notranslate"><span class="pre">_align_sentence_transformer_context</span></code>).</p>
<p>Parameters are accepted as keyword-only arguments to mirror the CLI layer
and configuration loaders in the repository.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>str</em>) – Dataset identifier (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;slate&quot;</span></code>).</p></li>
<li><p><strong>out_dir</strong> – Base output directory for all artifacts.</p></li>
<li><p><strong>cache_dir</strong> – External cache directory path or name.</p></li>
<li><p><strong>sweep_dir</strong> – Directory for next-video sweep results.</p></li>
<li><p><strong>word2vec_model_dir</strong> – Directory containing Word2Vec models.</p></li>
<li><p><strong>next_video_dir</strong> – Directory for next-video artifacts.</p></li>
<li><p><strong>opinion_dir</strong> – Directory for opinion artifacts.</p></li>
<li><p><strong>opinion_sweep_dir</strong> – Directory for opinion sweep results.</p></li>
<li><p><strong>opinion_word2vec_dir</strong> – Directory containing opinion Word2Vec models.</p></li>
<li><p><strong>k_sweep</strong> (<em>str</em><em> | </em><em>None</em>) – K-values to sweep over, encoded as a string.</p></li>
<li><p><strong>study_tokens</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>) – Optional study filters limiting evaluation.</p></li>
<li><p><strong>word2vec_epochs</strong> – Default Word2Vec epochs.</p></li>
<li><p><strong>word2vec_workers</strong> – Default Word2Vec workers.</p></li>
<li><p><strong>sentence_model</strong> – SentenceTransformer model identifier.</p></li>
<li><p><strong>sentence_device</strong> – Optional device string for SentenceTransformer.</p></li>
<li><p><strong>sentence_batch_size</strong> – Batch size for SentenceTransformer encoding.</p></li>
<li><p><strong>sentence_normalize</strong> – Whether to L2-normalize sentence embeddings.</p></li>
<li><p><strong>feature_spaces</strong> – Feature spaces to include in runs.</p></li>
<li><p><strong>jobs</strong> – Parallel CPU worker count.</p></li>
<li><p><strong>reuse_sweeps</strong> – Reuse existing sweep outputs when available.</p></li>
<li><p><strong>reuse_final</strong> – Reuse existing final evaluation outputs.</p></li>
<li><p><strong>allow_incomplete</strong> – Allow partially cached runs to be reported.</p></li>
<li><p><strong>run_next_video</strong> – Enable next-video tasks.</p></li>
<li><p><strong>run_opinion</strong> – Enable opinion tasks.</p></li>
<li><p><strong>paths</strong> (<a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths" title="knn.pipeline.context_pipeline._PipelinePaths"><em>_PipelinePaths</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>models</strong> (<a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults" title="knn.pipeline.context_pipeline._ModelDefaults"><em>_ModelDefaults</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>workflow</strong> (<a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow" title="knn.pipeline.context_pipeline._Workflow"><em>_Workflow</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>flat</strong> (<em>object</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Constructed immutable context instance.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_sweep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study_tokens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workflow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">flat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#PipelineContext.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.PipelineContext.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a pipeline context.</p>
<p>Accepts grouped bundles (<code class="docutils literal notranslate"><span class="pre">paths</span></code>, <code class="docutils literal notranslate"><span class="pre">models</span></code>, <code class="docutils literal notranslate"><span class="pre">workflow</span></code>) or a set
of flat keyword arguments for backwards compatibility with existing
tests and call-sites.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>str</em>)</p></li>
<li><p><strong>k_sweep</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>study_tokens</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>paths</strong> (<a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths" title="knn.pipeline.context_pipeline._PipelinePaths"><em>_PipelinePaths</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>models</strong> (<a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults" title="knn.pipeline.context_pipeline._ModelDefaults"><em>_ModelDefaults</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>workflow</strong> (<a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow" title="knn.pipeline.context_pipeline._Workflow"><em>_Workflow</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>flat</strong> (<em>object</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.dataset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.from_mappings">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_mappings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#PipelineContext.from_mappings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.PipelineContext.from_mappings" title="Link to this definition">¶</a></dt>
<dd><p>Factory building a context from resolved dictionaries.</p>
<p>This keeps the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> narrow while preserving the existing CLI
call-sites that assemble simple <code class="docutils literal notranslate"><span class="pre">dict</span></code> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>)</p></li>
<li><p><strong>settings</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext">knn.pipeline.context.PipelineContext</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.k_sweep">
<span class="sig-name descname"><span class="pre">k_sweep</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.k_sweep" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sentence_batch_size">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sentence_batch_size" title="Link to this definition">¶</a></dt>
<dd><p>Batch size for SentenceTransformer encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of examples processed per batch.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sentence_device">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sentence_device" title="Link to this definition">¶</a></dt>
<dd><p>Device string used by SentenceTransformer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Device identifier such as <code class="docutils literal notranslate"><span class="pre">&quot;cuda&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;cpu&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.sentence_normalize">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_normalize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.sentence_normalize" title="Link to this definition">¶</a></dt>
<dd><p>Whether SentenceTransformer embeddings are L2-normalized.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> when normalization is enabled.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.set_sentence_batch_size">
<span class="sig-name descname"><span class="pre">set_sentence_batch_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#PipelineContext.set_sentence_batch_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.PipelineContext.set_sentence_batch_size" title="Link to this definition">¶</a></dt>
<dd><p>Set the SentenceTransformer batch size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>int</em>) – New batch size.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.set_sentence_device">
<span class="sig-name descname"><span class="pre">set_sentence_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#PipelineContext.set_sentence_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.PipelineContext.set_sentence_device" title="Link to this definition">¶</a></dt>
<dd><p>Set the SentenceTransformer device.</p>
<p>This method safely updates the internal model defaults using
<code class="docutils literal notranslate"><span class="pre">object.__setattr__</span></code> via the property’s setter, preserving the
frozen dataclass guarantees for other attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em><em> | </em><em>None</em>) – Device identifier (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;cuda&quot;</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.set_sentence_normalize">
<span class="sig-name descname"><span class="pre">set_sentence_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#PipelineContext.set_sentence_normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.PipelineContext.set_sentence_normalize" title="Link to this definition">¶</a></dt>
<dd><p>Enable or disable L2-normalization for SentenceTransformer embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>bool</em>) – Normalization flag.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PipelineContext.study_tokens">
<span class="sig-name descname"><span class="pre">study_tokens</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.PipelineContext.study_tokens" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PredictionRoots">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">PredictionRoots</span></span><a class="headerlink" href="#knn.pipeline.context.PredictionRoots" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context._PredictionRoots</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.PresentationFlags">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">PresentationFlags</span></span><a class="headerlink" href="#knn.pipeline.context.PresentationFlags" title="Link to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context._PresentationFlags</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">ReportBundle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">presentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">flat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.ReportBundle" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Aggregated artefacts required to render Markdown reports for the pipeline run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>ReportSelections</em>) – Winning selections for slate and opinion tasks.</p></li>
<li><p><strong>outcomes</strong> (<em>ReportOutcomes</em>) – Chronological lists of executed/cached sweep outcomes.</p></li>
<li><p><strong>metrics</strong> (<em>ReportMetrics</em>) – Final and LOSO metrics grouped by feature and study.</p></li>
<li><p><strong>presentation</strong> (<em>ReportPresentation</em>) – Report presentation options and auxiliary paths.</p></li>
<li><p><strong>flat</strong> (<em>object</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.allow_incomplete">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd><p>Whether missing sweeps are tolerated when rendering summaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if report generation may continue with missing artefacts.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.feature_spaces">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.feature_spaces" title="Link to this definition">¶</a></dt>
<dd><p>Ordered set of feature spaces included in the bundle.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of feature space identifiers.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[str, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.include_next_video">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">include_next_video</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.include_next_video" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether slate sections should be generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if slate sections should be generated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.include_opinion">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">include_opinion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.include_opinion" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether opinion sections should be generated.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if opinion sections should be generated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.include_opinion_from_next">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">include_opinion_from_next</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.include_opinion_from_next" title="Link to this definition">¶</a></dt>
<dd><p>Flag for rendering opinion-from-next sections in reports.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if opinion-from-next sections should be generated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.k_sweep">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k_sweep</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.k_sweep" title="Link to this definition">¶</a></dt>
<dd><p>Textual representation of the <code class="docutils literal notranslate"><span class="pre">k</span></code> sweep grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Human-readable summary of the k grid.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.loso_metrics">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">loso_metrics</span></span><a class="headerlink" href="#knn.pipeline.context.ReportBundle.loso_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Leave-one-study-out metrics per feature space (optional).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>LOSO metrics per feature space, if available.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping[str, Mapping[str, Mapping[str, object]]] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.metrics_by_feature">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics_by_feature</span></span><a class="headerlink" href="#knn.pipeline.context.ReportBundle.metrics_by_feature" title="Link to this definition">¶</a></dt>
<dd><p>Per-feature mapping of metrics dictionaries keyed by study.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Metrics snapshots per feature space and study.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping[str, Mapping[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_from_next_metrics">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_from_next_metrics</span></span><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_from_next_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Per-feature mapping of ‘opinion-from-next’ metrics keyed by study.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Opinion-from-next metrics per feature space and study.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping[str, Mapping[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_from_next_predictions_root">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_from_next_predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_from_next_predictions_root" title="Link to this definition">¶</a></dt>
<dd><p>Root directory for opinion-from-next prediction artefacts.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to opinion-from-next predictions or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[pathlib.Path]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_metrics">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_metrics</span></span><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Per-feature mapping of opinion metrics keyed by study.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Opinion metrics per feature space and study.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping[str, Mapping[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_predictions_root">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_predictions_root" title="Link to this definition">¶</a></dt>
<dd><p>Root directory containing opinion prediction artefacts.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to opinion predictions or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[pathlib.Path]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_selections">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_selections</span></span><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_selections" title="Link to this definition">¶</a></dt>
<dd><p>Mapping from feature space to per-study opinion selections.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Nested mapping of opinion selections per feature and study.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping[str, Mapping[str, <a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.opinion_sweep_outcomes">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">opinion_sweep_outcomes</span></span><a class="headerlink" href="#knn.pipeline.context.ReportBundle.opinion_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Sequence of cached and executed opinion sweep outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Opinion outcomes in chronological order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Sequence[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.selections">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">selections</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'common.pipeline.types.StudySelection'</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.selections" title="Link to this definition">¶</a></dt>
<dd><p>Winning slate selections keyed by feature and study.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Nested mapping of selections per feature space and study.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping[str, Mapping[str, <a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.sentence_model">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.sentence_model" title="Link to this definition">¶</a></dt>
<dd><p>SentenceTransformer model name if applicable.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fully qualified model identifier or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Optional[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.studies">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'common.pipeline.types.StudySpec'</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.studies" title="Link to this definition">¶</a></dt>
<dd><p>Study descriptors used when rendering friendly labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Study descriptors used to render friendly labels.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Sequence[<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.ReportBundle.sweep_outcomes">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sweep_outcomes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'SweepOutcome'</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.ReportBundle.sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Chronological list of all slate sweep outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Slate outcomes in chronological order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Sequence[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySelection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">StudySelection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.StudySelection" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="common.html#common.pipeline.types.StudySelection" title="common.pipeline.types.StudySelection"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.pipeline.types.StudySelection</span></code></a>[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><code class="xref py py-class docutils literal notranslate"><span class="pre">knn.pipeline.context.SweepOutcome</span></code></a>]</p>
<p>Selected configuration for a specific study within a feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="common.pipeline.types.StudySpec"><em>common.pipeline.types.StudySpec</em></a>)</p></li>
<li><p><strong>outcome</strong> (<em>OutcomeT</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySelection.accuracy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.StudySelection.accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Return the held-out accuracy achieved by the selection.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.StudySelection.best_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.StudySelection.best_k" title="Link to this definition">¶</a></dt>
<dd><p>Return the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> for the study.</p>
<p>Several reporting and evaluation helpers access <code class="docutils literal notranslate"><span class="pre">selection.best_k</span></code>;
surface it here as a thin proxy to the underlying outcome.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text_fields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_min_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_transformer_normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.SweepConfig" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Describe a single hyper-parameter configuration scheduled for execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_space</strong> (<em>str</em>) – One of ‘tfidf’, ‘word2vec’, or ‘sentence_transformer’.</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – Target metric label used for selection.</p></li>
<li><p><strong>text_fields</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Ordered text fields to include when building feature space.</p></li>
<li><p><strong>word2vec_size</strong> (<em>int</em><em> | </em><em>None</em>) – Word2Vec vector size.</p></li>
<li><p><strong>word2vec_window</strong> (<em>int</em><em> | </em><em>None</em>) – Word2Vec context window.</p></li>
<li><p><strong>word2vec_min_count</strong> (<em>int</em><em> | </em><em>None</em>) – Word2Vec minimum token count.</p></li>
<li><p><strong>word2vec_epochs</strong> (<em>int</em><em> | </em><em>None</em>) – Word2Vec training epochs.</p></li>
<li><p><strong>word2vec_workers</strong> (<em>int</em><em> | </em><em>None</em>) – Word2Vec worker processes.</p></li>
<li><p><strong>sentence_transformer_model</strong> (<em>str</em><em> | </em><em>None</em>) – SentenceTransformer model name.</p></li>
<li><p><strong>sentence_transformer_device</strong> (<em>str</em><em> | </em><em>None</em>) – Device hint for encoding.</p></li>
<li><p><strong>sentence_transformer_batch_size</strong> (<em>int</em><em> | </em><em>None</em>) – Batch size for encoding.</p></li>
<li><p><strong>sentence_transformer_normalize</strong> (<em>bool</em><em> | </em><em>None</em>) – Whether to L2-normalize embeddings.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.cli_args">
<span class="sig-name descname"><span class="pre">cli_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_config.html#SweepConfig.cli_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepConfig.cli_args" title="Link to this definition">¶</a></dt>
<dd><p>Serialise the configuration into CLI flags for knn.cli.main.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>word2vec_model_dir</strong> (<em>object</em><em> | </em><em>None</em>) – Optional directory for Word2Vec caches, forwarded
when the feature space is <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Argument vector encoding this configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.feature_space">
<span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.feature_space" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.label">
<span class="sig-name descname"><span class="pre">label</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_config.html#SweepConfig.label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepConfig.label" title="Link to this definition">¶</a></dt>
<dd><p>Create a filesystem-friendly identifier summarising the configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A compact, safe string encoding of key parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.metric" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_batch_size">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_transformer_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_batch_size" title="Link to this definition">¶</a></dt>
<dd><p>Batch size used for SentenceTransformer encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Batch size override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_device">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_transformer_device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_device" title="Link to this definition">¶</a></dt>
<dd><p>Target device used for SentenceTransformer encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Device override (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;cpu&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;cuda&quot;</span></code>) or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_model">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_transformer_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_model" title="Link to this definition">¶</a></dt>
<dd><p>SentenceTransformer model identifier to use for encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Model name override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.sentence_transformer_normalize">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sentence_transformer_normalize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.sentence_transformer_normalize" title="Link to this definition">¶</a></dt>
<dd><p>Whether to L2-normalize SentenceTransformer embeddings.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalization flag override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.text_fields">
<span class="sig-name descname"><span class="pre">text_fields</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.text_fields" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_epochs">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_epochs" title="Link to this definition">¶</a></dt>
<dd><p>Number of training epochs for Word2Vec.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Epoch count override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_min_count">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_min_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_min_count" title="Link to this definition">¶</a></dt>
<dd><p>Minimum token frequency threshold used by Word2Vec.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Minimum count override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_size">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_size" title="Link to this definition">¶</a></dt>
<dd><p>Word2Vec vector dimensionality for this configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Vector size override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_window">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_window</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_window" title="Link to this definition">¶</a></dt>
<dd><p>Word2Vec context window size for this configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Window size override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepConfig.word2vec_workers">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepConfig.word2vec_workers" title="Link to this definition">¶</a></dt>
<dd><p>Number of worker processes used for Word2Vec training.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Worker count override or <code class="docutils literal notranslate"><span class="pre">None</span></code> if unspecified.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int | None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepOutcome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eligible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.SweepOutcome" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Persisted metrics for evaluating a configuration against a single study.</p>
<p>Composition-based wrapper around
<a class="reference internal" href="common.html#common.pipeline.types.BasePipelineSweepOutcome" title="common.pipeline.types.BasePipelineSweepOutcome"><code class="xref py py-class docutils literal notranslate"><span class="pre">common.pipeline.types.BasePipelineSweepOutcome</span></code></a> enriched with
feature-space metadata and KNN-specific statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<a class="reference internal" href="common.html#common.pipeline.types.BasePipelineSweepOutcome" title="common.pipeline.types.BasePipelineSweepOutcome"><em>BasePipelineSweepOutcome</em></a>) – Base sweep outcome containing common metadata and metrics.</p></li>
<li><p><strong>knn</strong> (<em>object</em>) – Extra KNN-specific metrics captured for the run.</p></li>
<li><p><strong>order_index</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>config</strong> (<em>'SweepConfig'</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>metrics_path</strong> (<em>Path</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>feature_space</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>accuracy</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>best_k</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>eligible</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">knn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eligible</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_sweeps.html#SweepOutcome.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a KNN sweep outcome.</p>
<p>Accepts either a composed <code class="docutils literal notranslate"><span class="pre">base</span></code> + <code class="docutils literal notranslate"><span class="pre">knn</span></code> pair, or a legacy flat set
of keyword arguments (<code class="docutils literal notranslate"><span class="pre">order_index</span></code>, <code class="docutils literal notranslate"><span class="pre">study</span></code>, <code class="docutils literal notranslate"><span class="pre">config</span></code>,
<code class="docutils literal notranslate"><span class="pre">metrics_path</span></code>, <code class="docutils literal notranslate"><span class="pre">metrics</span></code>, <code class="docutils literal notranslate"><span class="pre">feature_space</span></code>, <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>,
<code class="docutils literal notranslate"><span class="pre">best_k</span></code>, <code class="docutils literal notranslate"><span class="pre">eligible</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<a class="reference internal" href="common.html#common.pipeline.types.BasePipelineSweepOutcome" title="common.pipeline.types.BasePipelineSweepOutcome"><em>BasePipelineSweepOutcome</em></a><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>knn</strong> (<em>object</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>order_index</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>config</strong> (<em>'SweepConfig'</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>metrics_path</strong> (<em>Path</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>feature_space</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>accuracy</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>best_k</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>eligible</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.accuracy">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.accuracy" title="Link to this definition">¶</a></dt>
<dd><p>Return the held-out accuracy achieved by the configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Accuracy on the evaluation split.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.best_k">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_k</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.best_k" title="Link to this definition">¶</a></dt>
<dd><p>Return the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> for the KNN model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Best-performing neighbor count.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.config">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><span class="pre">knn.pipeline.context.SweepConfig</span></a></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.config" title="Link to this definition">¶</a></dt>
<dd><p>Return the configuration evaluated for the outcome.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pipeline configuration that produced the metrics.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.eligible">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eligible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.eligible" title="Link to this definition">¶</a></dt>
<dd><p>Return the number of eligible examples considered.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Count of examples included in metric computation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.feature_space">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feature_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.feature_space" title="Link to this definition">¶</a></dt>
<dd><p>Return the feature space label used for this evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Feature space identifier (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;tfidf&quot;</span></code>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.metrics">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.metrics" title="Link to this definition">¶</a></dt>
<dd><p>Return raw metrics payload loaded from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mapping captured by the evaluation stage.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping[str, object]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.metrics_path">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metrics_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.metrics_path" title="Link to this definition">¶</a></dt>
<dd><p>Return filesystem path to the persisted metrics artefact.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path to <code class="docutils literal notranslate"><span class="pre">metrics.json</span></code> for this outcome.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pathlib.Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.order_index">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">order_index</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.order_index" title="Link to this definition">¶</a></dt>
<dd><p>Return the stable ordering index for this outcome.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Zero-based submission order index.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepOutcome.study">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">study</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="common.pipeline.types.StudySpec"><span class="pre">common.pipeline.types.StudySpec</span></a></em><a class="headerlink" href="#knn.pipeline.context.SweepOutcome.study" title="Link to this definition">¶</a></dt>
<dd><p>Return the study metadata associated with the outcome.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Study specification used for the evaluation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="common.pipeline.types.StudySpec"><em>StudySpec</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepTask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue_slug</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_participant_studies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.SweepTask" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_helpers.ExtrasSweepTask</span></code>[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">SweepConfig</span></code></a>]</p>
<p>Extend <code class="xref py py-class docutils literal notranslate"><span class="pre">common.opinion.sweep_types.BaseSweepTask</span></code> with KNN metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>)</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a>)</p></li>
<li><p><strong>base_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>extra_cli</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>run_root</strong> (<em>Path</em>)</p></li>
<li><p><strong>metrics_path</strong> (<em>Path</em>)</p></li>
<li><p><strong>word2vec_model_dir</strong> (<em>Path</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>issue</strong> (<em>str</em>)</p></li>
<li><p><strong>issue_slug</strong> (<em>str</em>)</p></li>
<li><p><strong>train_participant_studies</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask.issue">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">issue</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTask.issue" title="Link to this definition">¶</a></dt>
<dd><p>Target issue identifier associated with the task/study.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask.issue_slug">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">issue_slug</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTask.issue_slug" title="Link to this definition">¶</a></dt>
<dd><p>Filesystem-friendly slug for the task’s target issue.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTask.word2vec_model_dir">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTask.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd><p>Optional path to cached Word2Vec models used by this task.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context.</span></span><span class="sig-name descname"><span class="pre">SweepTaskContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_base</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Shared CLI/runtime parameters required to materialise sweep tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>sweep_dir</strong> (<em>Path</em>)</p></li>
<li><p><strong>word2vec_model_base</strong> (<em>Path</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.base_cli">
<span class="sig-name descname"><span class="pre">base_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.base_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.extra_cli">
<span class="sig-name descname"><span class="pre">extra_cli</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.extra_cli" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.sweep_dir">
<span class="sig-name descname"><span class="pre">sweep_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.sweep_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context.SweepTaskContext.word2vec_model_base">
<span class="sig-name descname"><span class="pre">word2vec_model_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#knn.pipeline.context.SweepTaskContext.word2vec_model_base" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline">Pipeline orchestration for the Grail Simulation KNN baselines.</p>
<p>The module coordinates hyper-parameter sweeps, final evaluations, and
Markdown report generation for the slate-ranking and opinion-regression
KNN workflows used throughout the project.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.main">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.main" title="Link to this definition">¶</a></dt>
<dd><p>Coordinate sweeps, evaluations, and report generation for the KNN pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional argument vector override used when invoking the CLI programmatically.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.__main__">Entry point for <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">knn.pipeline</span></code>.</p>
<p id="module-knn.pipeline.cli">Command-line helpers for the Grail Simulation KNN pipeline.</p>
<p>The functions here construct the CLI parser, resolve default directories,
and translate parsed arguments into sweep configurations consumed by
<code class="docutils literal notranslate"><span class="pre">knn.pipeline</span></code> and its orchestration helpers.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.build_base_cli">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">build_base_cli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extra_cli</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#build_base_cli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.build_base_cli" title="Link to this definition">¶</a></dt>
<dd><p>Construct the CLI argument prefix reused across KNN pipeline invocations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a>) – Pipeline configuration describing dataset paths and sweep options.</p></li>
<li><p><strong>extra_cli</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Argument list containing dataset/cache flags plus other shared options.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.build_pipeline_context">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">build_pipeline_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#build_pipeline_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.build_pipeline_context" title="Link to this definition">¶</a></dt>
<dd><p>Normalise CLI flags and environment overrides into a
<a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineContext</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>argparse.Namespace</em>) – Parsed pipeline arguments that may omit optional values.</p></li>
<li><p><strong>root</strong> (<em>Path</em>) – Repository root, used to derive sensible defaults for directories.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fully-populated context capturing dataset paths, sweep configuration,
Word2Vec parameters, SentenceTransformer settings, and task toggles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.default_cache_dir">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">default_cache_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#default_cache_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.default_cache_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the datasets cache directory used by the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root</strong> (<em>Path</em>) – Repository root from which cache directories are derived.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to <code class="docutils literal notranslate"><span class="pre">.cache/huggingface/knn</span></code> rooted under <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.default_dataset">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">default_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#default_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.default_dataset" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the default dataset location under the repository.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root</strong> (<em>Path</em>) – Repository root from which data directories are derived.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filesystem path pointing to <code class="docutils literal notranslate"><span class="pre">data/cleaned_grail</span></code> beneath <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.default_out_dir">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">default_out_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#default_out_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.default_out_dir" title="Link to this definition">¶</a></dt>
<dd><p>Resolve the default directory for all pipeline outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>root</strong> (<em>Path</em>) – Repository root from which output directories are derived.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Path to <code class="docutils literal notranslate"><span class="pre">models/knn</span></code> rooted under <code class="docutils literal notranslate"><span class="pre">root</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.log_dry_run">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">log_dry_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#log_dry_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.log_dry_run" title="Link to this definition">¶</a></dt>
<dd><p>Log the number of sweep configurations that would have executed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Planned sweep configuration objects assembled during a dry run.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. The function reports the count via <code class="docutils literal notranslate"><span class="pre">logging</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.log_run_configuration">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">log_run_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#log_run_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.log_run_configuration" title="Link to this definition">¶</a></dt>
<dd><p>Emit a concise summary of the resolved pipeline configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Collection of study specifications that will be evaluated.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a>) – Pipeline context describing dataset paths, jobs, and task toggles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. The function writes human-readable configuration details to the logger.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.parse_args">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">parse_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#parse_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.parse_args" title="Link to this definition">¶</a></dt>
<dd><p>Parse high-level pipeline arguments and capture any extra CLI tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>Sequence</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Explicit argument vector used for parsing. When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
the function consumes <code class="xref py py-data docutils literal notranslate"><span class="pre">sys.argv</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pair containing the parsed namespace and a list of passthrough arguments that should
be forwarded to downstream CLI invocations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[argparse.Namespace, List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.cli.repo_root">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.cli.</span></span><span class="sig-name descname"><span class="pre">repo_root</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/cli.html#repo_root"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.cli.repo_root" title="Link to this definition">¶</a></dt>
<dd><p>Compute the repository root by traversing upwards from this module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Absolute path to the project root (three directories above <code class="docutils literal notranslate"><span class="pre">pipeline.cli</span></code>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Path</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.data">Study metadata helpers used by the Grail Simulation KNN pipeline.</p>
<p>Provides canonical participant-study specifications plus helper functions
for interpreting CLI tokens and mapping them onto pipeline studies.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.issue_slug_for_study">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">issue_slug_for_study</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">study</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#issue_slug_for_study"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.issue_slug_for_study" title="Link to this definition">¶</a></dt>
<dd><p>Derive the filesystem slug used for artefacts associated with <code class="docutils literal notranslate"><span class="pre">study</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>) – Study specification providing issue/study slugs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenated issue and study slug (e.g. <code class="docutils literal notranslate"><span class="pre">issue_study</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.resolve_studies">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">resolve_studies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#resolve_studies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.resolve_studies" title="Link to this definition">¶</a></dt>
<dd><p>Return participant studies matching <code class="docutils literal notranslate"><span class="pre">tokens</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tokens</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Iterable of study keys or issue names received from the CLI.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list of study specifications corresponding to the provided tokens.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.study_specs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">study_specs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#study_specs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.study_specs" title="Link to this definition">¶</a></dt>
<dd><p>Return the canonical participant-study specifications bundled with the project.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of opinion-study descriptors used for sweeps and reporting.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>, …]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.data.warn_if_issue_tokens_used">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.data.</span></span><span class="sig-name descname"><span class="pre">warn_if_issue_tokens_used</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/data.html#warn_if_issue_tokens_used"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.data.warn_if_issue_tokens_used" title="Link to this definition">¶</a></dt>
<dd><p>Log a gentle reminder that <code class="docutils literal notranslate"><span class="pre">--issues</span></code> is deprecated for the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>argparse.Namespace</em>) – Parsed CLI namespace to inspect for deprecated <code class="docutils literal notranslate"><span class="pre">--issues</span></code> usage.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.evaluate">Evaluation runners for the Grail Simulation KNN pipeline.</p>
<p>Wraps the KNN CLI so orchestration code can execute final evaluations,
leave-one-study-out checks, and opinion regressions while respecting the
pipeline’s caching semantics.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.load_loso_metrics_from_disk">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">load_loso_metrics_from_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_loso_metrics_from_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.load_loso_metrics_from_disk" title="Link to this definition">¶</a></dt>
<dd><p>Load leave-one-study-out metrics produced by previous pipeline runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>Path</em>) – Directory containing persisted evaluation artefacts.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Feature space configurations to inspect for cached
LOSO runs.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Studies that were treated as hold-outs in the LOSO evaluation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for every cached
LOSO evaluation located.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.run_cross_study_evaluations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_cross_study_evaluations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/evaluate.html#run_cross_study_evaluations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.run_cross_study_evaluations" title="Link to this definition">¶</a></dt>
<dd><p>Run per-study evaluation sweeps grouped by feature space.</p>
<p>Historically this performed leave-one-study-out (LOSO) checks, but training
is now restricted to the holdout study to avoid cross-study mixtures. This
implementation primarily supports reuse of cached metrics (sufficient for tests).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>TypeAliasForwardRef</em><em>(</em><em>'common.pipeline.types.StudySelection'</em><em>)</em><em>]</em><em>]</em>) – Mapping from feature space to per-study selections that
determine which configuration to evaluate.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>TypeAliasForwardRef</em><em>(</em><em>'common.pipeline.types.StudySpec'</em><em>)</em><em>]</em>) – Ordered list of study specifications considered in LOSO checks.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><em>knn.pipeline.context.EvaluationContext</em></a>) – Evaluation context providing filesystem roots and flags.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested mapping <code class="docutils literal notranslate"><span class="pre">{feature_space:</span> <span class="pre">{study_key:</span> <span class="pre">metrics}}</span></code> with any
cached results found (may be empty when unavailable).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[str, <em>Dict</em>[str, <em>Mapping</em>[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.run_final_evaluations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_final_evaluations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/evaluate.html#run_final_evaluations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.run_final_evaluations" title="Link to this definition">¶</a></dt>
<dd><p>Run final slate evaluations and return metrics grouped by feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a><em>]</em><em>]</em>) – Winning sweep selections keyed by feature space and study key.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Ordered list of studies to evaluate.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><em>EvaluationContext</em></a>) – Shared CLI/runtime parameters used for all evaluations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study_key</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for the final evaluations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.run_opinion_evaluations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_opinion_evaluations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/evaluate.html#run_opinion_evaluations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.run_opinion_evaluations" title="Link to this definition">¶</a></dt>
<dd><p>Run opinion regression for each feature space and return metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a><em>]</em><em>]</em>) – Winning opinion selections keyed by feature space and study key.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Ordered list of opinion studies to evaluate.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><em>EvaluationContext</em></a>) – Shared CLI/runtime parameters used for all evaluations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study_key</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for the opinion evaluations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.evaluate.run_opinion_from_next_evaluations">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.evaluate.</span></span><span class="sig-name descname"><span class="pre">run_opinion_from_next_evaluations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/evaluate.html#run_opinion_from_next_evaluations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.evaluate.run_opinion_from_next_evaluations" title="Link to this definition">¶</a></dt>
<dd><p>Score opinion change using the next-video configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a><em>]</em><em>]</em>) – Winning next-video selections keyed by feature space and study key.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Ordered list of opinion studies to evaluate.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.EvaluationContext" title="knn.pipeline.context.EvaluationContext"><em>EvaluationContext</em></a>) – Shared CLI/runtime parameters used for all evaluations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Next-video metrics keyed by <code class="docutils literal notranslate"><span class="pre">feature_space</span></code> then <code class="docutils literal notranslate"><span class="pre">study_key</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.io">Filesystem helpers for the Grail Simulation KNN pipeline.</p>
<p>Encapsulates loading of sweep and evaluation metrics so orchestration code
can rebuild report bundles without re-executing the pipeline stages.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_final_metrics_from_disk">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_final_metrics_from_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_final_metrics_from_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_final_metrics_from_disk" title="Link to this definition">¶</a></dt>
<dd><p>Load slate metrics written by prior runs instead of recomputing them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>Path</em>) – Directory where per-feature-space results are persisted.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Iterable of feature space names to inspect.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Studies to look up within each feature directory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Nested mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for all cached
results found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_loso_metrics_from_disk">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_loso_metrics_from_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_loso_metrics_from_disk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_loso_metrics_from_disk" title="Link to this definition">¶</a></dt>
<dd><p>Load leave-one-study-out metrics produced by previous pipeline runs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>Path</em>) – Directory containing persisted evaluation artefacts.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Feature space configurations to inspect for cached
LOSO runs.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Studies that were treated as hold-outs in the LOSO evaluation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping <code class="docutils literal notranslate"><span class="pre">feature_space</span> <span class="pre">-&gt;</span> <span class="pre">study</span> <span class="pre">-&gt;</span> <span class="pre">metrics</span></code> for every cached
LOSO evaluation located.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">issue_slug</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Load the evaluation metrics JSON for a specific study/issue from <code class="docutils literal notranslate"><span class="pre">run_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>run_dir</strong> (<em>Path</em>) – Directory containing per-issue subdirectories with metrics artefacts.</p></li>
<li><p><strong>issue_slug</strong> (<em>str</em>) – Issue slug used to locate the metrics file on disk.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing the parsed metrics payload and the filesystem path used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[Mapping[str, object], Path]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If the expected metrics file does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.io.load_opinion_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.io.</span></span><span class="sig-name descname"><span class="pre">load_opinion_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/io.html#load_opinion_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.io.load_opinion_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Collect opinion-task metrics for every study under <code class="docutils literal notranslate"><span class="pre">out_dir</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>Path</em>) – Root directory containing opinion evaluation artefacts.</p></li>
<li><p><strong>feature_space</strong> (<em>str</em>) – Feature space identifier (e.g. <code class="docutils literal notranslate"><span class="pre">tfidf</span></code> or <code class="docutils literal notranslate"><span class="pre">word2vec</span></code>)
used to scope the search.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping keyed by study slug with the deserialised metrics dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Mapping[str, object]]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.opinion_sweeps">Opinion sweep orchestration helpers extracted from <code class="docutils literal notranslate"><span class="pre">pipeline_sweeps</span></code>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.build_opinion_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">build_opinion_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#build_opinion_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.build_opinion_task" title="Link to this definition">¶</a></dt>
<dd><p>Expose the opinion sweep task builder for use in tests and external callers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A configured opinion sweep task matching the supplied arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>knn.pipeline.context.SweepConfig</em></a>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="common.pipeline.types.StudySpec"><em>common.pipeline.types.StudySpec</em></a>)</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>knn.pipeline.context.SweepTaskContext</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.execute_opinion_sweep_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">cli_runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#execute_opinion_sweep_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_task" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single opinion sweep task and return the captured metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Individual sweep task describing an execution unit.</p></li>
<li><p><strong>cli_runner</strong> (<em>CliRunner</em>) – Callable used to invoke the CLI for the opinion sweep.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcome produced by executing the given task.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – Raised when a Word2Vec task omits the model directory.</p></li>
<li><p><strong>FileNotFoundError</strong> – Raised if the metrics artefact is missing post-run.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.execute_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cli_runner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#execute_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Run the supplied opinion sweep tasks, optionally in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a><em>]</em>) – Collection of sweep tasks scheduled for execution.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers allowed.</p></li>
<li><p><strong>cli_runner</strong> (<em>CliRunner</em>) – Callable used to invoke the CLI for each task.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcomes generated from the provided tasks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.format_opinion_sweep_task_descriptor">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">format_opinion_sweep_task_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#format_opinion_sweep_task_descriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.format_opinion_sweep_task_descriptor" title="Link to this definition">¶</a></dt>
<dd><p>Return a short descriptor for an opinion sweep task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-readable descriptor combining feature space, study, and label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.merge_opinion_sweep_outcomes">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">merge_opinion_sweep_outcomes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#merge_opinion_sweep_outcomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.merge_opinion_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Combine cached and freshly executed opinion outcomes while preserving order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cached</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Previously computed artefacts available for reuse.</p></li>
<li><p><strong>executed</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Outcomes produced during the current run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list comprising cached results first and overwriting duplicates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.opinion_sweep_outcome_from_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">opinion_sweep_outcome_from_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#opinion_sweep_outcome_from_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.opinion_sweep_outcome_from_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Translate cached opinion metrics into an <code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionSweepOutcome</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Sweep task describing the execution unit that produced the metrics.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
<li><p><strong>metrics_path</strong> (<em>pathlib.Path</em>) – Filesystem path where the metrics JSON artefact resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcome reconstructed from cached metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.prepare_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">prepare_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#prepare_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.prepare_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Return tasks that require execution alongside cached sweep outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Hyper-parameter sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, reuse cached results instead of recomputing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tasks pending execution and outcomes reconstructed from cache.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>],
List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.opinion_sweeps.select_best_opinion_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.opinion_sweeps.</span></span><span class="sig-name descname"><span class="pre">select_best_opinion_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#select_best_opinion_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.opinion_sweeps.select_best_opinion_configs" title="Link to this definition">¶</a></dt>
<dd><p>Select the best configuration per feature space and study for opinion sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Sweep outcomes available for aggregation.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Continue when some sweep data is missing if <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to their selected opinion configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, <a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a>]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when mandatory selections are missing and <code class="docutils literal notranslate"><span class="pre">allow_incomplete</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.sweeps">Sweep orchestration helpers for the Grail Simulation KNN pipeline.</p>
<p>Builds hyper-parameter grids, prepares CLI invocations, executes sweep tasks
for next-video and opinion runs, and merges cached metrics so later stages can
select the best configurations.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.build_opinion_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">build_opinion_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#build_opinion_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.build_opinion_task" title="Link to this definition">¶</a></dt>
<dd><p>Expose the opinion sweep task builder for use in tests and external callers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A configured opinion sweep task matching the supplied arguments.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a></p>
</dd>
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em>)</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>knn.pipeline.context.SweepConfig</em></a>)</p></li>
<li><p><strong>study</strong> (<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="common.pipeline.types.StudySpec"><em>common.pipeline.types.StudySpec</em></a>)</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>knn.pipeline.context.SweepTaskContext</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.build_sweep_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">build_sweep_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#build_sweep_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.build_sweep_configs" title="Link to this definition">¶</a></dt>
<dd><p>Return the grid of configurations evaluated during sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><em>PipelineContext</em></a>) – Pipeline context encapsulating dataset paths and configuration flags.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the grid of configurations evaluated during sweeps</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.emit_combined_sweep_plan">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">emit_combined_sweep_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">slate_tasks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion_tasks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#emit_combined_sweep_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.emit_combined_sweep_plan" title="Link to this definition">¶</a></dt>
<dd><p>Print a combined sweep plan covering next-video and opinion tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slate_tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a><em>]</em>) – Slate sweep tasks prepared for execution.</p></li>
<li><p><strong>opinion_tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a><em>]</em>) – Opinion sweep tasks queued for execution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.emit_sweep_plan">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">emit_sweep_plan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#emit_sweep_plan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.emit_sweep_plan" title="Link to this definition">¶</a></dt>
<dd><p>Print a human-readable sweep plan for next-video tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a><em>]</em>) – Collection of sweep tasks scheduled for execution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_opinion_sweep_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_opinion_sweep_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_opinion_sweep_task" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single opinion sweep task using the shared CLI runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>knn.pipeline.context.OpinionSweepTask</em></a>) – Opinion sweep task describing a single execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Outcome bundle produced by running the CLI for <code class="docutils literal notranslate"><span class="pre">task</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome">knn.pipeline.context.OpinionSweepOutcome</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Run the supplied opinion sweep tasks via the shared CLI runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a><em>]</em>) – Opinion sweep tasks scheduled for execution.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list of opinion sweep outcomes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_sweep_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_sweep_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_sweep_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_sweep_task" title="Link to this definition">¶</a></dt>
<dd><p>Execute a single sweep task and return the captured metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Slate sweep outcome produced by executing the given task.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.execute_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">execute_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#execute_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.execute_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Run the supplied sweep tasks (possibly in parallel).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a><em>]</em>) – Collection of sweep tasks scheduled for execution.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers to schedule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of slate sweep outcomes generated from the provided tasks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.format_opinion_sweep_task_descriptor">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">format_opinion_sweep_task_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#format_opinion_sweep_task_descriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.format_opinion_sweep_task_descriptor" title="Link to this definition">¶</a></dt>
<dd><p>Return a short descriptor for an opinion sweep task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Human-readable descriptor combining feature space, study, and label.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.format_sweep_task_descriptor">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">format_sweep_task_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#format_sweep_task_descriptor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.format_sweep_task_descriptor" title="Link to this definition">¶</a></dt>
<dd><p>Return a short descriptor for a sweep task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>) – Individual sweep task describing an execution unit.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a short descriptor for a sweep task</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.merge_opinion_sweep_outcomes">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">merge_opinion_sweep_outcomes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#merge_opinion_sweep_outcomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.merge_opinion_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Combine cached and freshly executed opinion outcomes while preserving order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cached</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Previously computed artefacts available for reuse.</p></li>
<li><p><strong>executed</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Outcomes produced during the current run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ordered list comprising cached results first and overwriting duplicates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.merge_sweep_outcomes">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">merge_sweep_outcomes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#merge_sweep_outcomes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.merge_sweep_outcomes" title="Link to this definition">¶</a></dt>
<dd><p>Combine cached and freshly executed sweep outcomes preserving order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cached</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a><em>]</em>) – Previously computed artefacts available for reuse.</p></li>
<li><p><strong>executed</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a><em>]</em>) – Iterable of tasks that were actually executed during the run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to merged slate sweep outcomes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.opinion_sweep_outcome_from_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">opinion_sweep_outcome_from_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#opinion_sweep_outcome_from_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.opinion_sweep_outcome_from_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Translate cached opinion metrics into an <code class="xref py py-class docutils literal notranslate"><span class="pre">OpinionSweepOutcome</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>) – Sweep task describing the execution unit that produced the metrics.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
<li><p><strong>metrics_path</strong> (<em>pathlib.Path</em>) – Filesystem path where the metrics JSON artefact resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Opinion sweep outcome reconstructed from cached metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.prepare_opinion_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">prepare_opinion_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#prepare_opinion_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.prepare_opinion_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Return tasks that require execution alongside cached sweep outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Hyper-parameter sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, reuse cached results instead of recomputing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tasks pending execution and outcomes reconstructed from cache.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask" title="knn.pipeline.context.OpinionSweepTask"><em>OpinionSweepTask</em></a>],
List[<a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.prepare_sweep_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">prepare_sweep_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#prepare_sweep_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.prepare_sweep_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Return next-video sweep tasks requiring execution and cached outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Iterable of sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Whether to reuse cached results instead of recomputing them.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>next-video sweep tasks requiring execution and cached outcomes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>], List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.run_knn_cli">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">run_knn_cli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#run_knn_cli"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.run_knn_cli" title="Link to this definition">¶</a></dt>
<dd><p>Execute the KNN CLI entry point with <code class="docutils literal notranslate"><span class="pre">argv</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Optional argument vector override used when invoking the CLI programmatically.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.run_sweeps">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">run_sweeps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#run_sweeps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.run_sweeps" title="Link to this definition">¶</a></dt>
<dd><p>Execute hyper-parameter sweeps and collect per-run metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepConfig" title="knn.pipeline.context.SweepConfig"><em>SweepConfig</em></a><em>]</em>) – Iterable of sweep configurations scheduled for execution.</p></li>
<li><p><strong>context</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTaskContext" title="knn.pipeline.context.SweepTaskContext"><em>SweepTaskContext</em></a>) – Shared CLI/runtime parameters reused across sweep invocations.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Whether to reuse cached results instead of recomputing them.</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Maximum number of parallel workers to schedule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing slate tasks, opinion tasks, and any cached sweep outcomes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.select_best_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">select_best_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#select_best_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.select_best_configs" title="Link to this definition">¶</a></dt>
<dd><p>Select the best configuration per feature space and study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a><em>]</em>) – Iterable of sweep outcomes available for aggregation.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Sequence of study specifications targeted by the workflow.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Whether processing may continue when some sweep data is missing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to their selected slate configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, <a class="reference internal" href="#knn.pipeline.context.StudySelection" title="knn.pipeline.context.StudySelection"><em>StudySelection</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.select_best_opinion_configs">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">select_best_opinion_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/opinion_sweeps.html#select_best_opinion_configs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.select_best_opinion_configs" title="Link to this definition">¶</a></dt>
<dd><p>Select the best configuration per feature space and study for opinion sweeps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outcomes</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome" title="knn.pipeline.context.OpinionSweepOutcome"><em>OpinionSweepOutcome</em></a><em>]</em>) – Sweep outcomes available for aggregation.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Study specifications targeted by the workflow.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Continue when some sweep data is missing if <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mapping of feature spaces to their selected opinion configurations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Dict[str, <a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection" title="knn.pipeline.context.OpinionStudySelection"><em>OpinionStudySelection</em></a>]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised when mandatory selections are missing and <code class="docutils literal notranslate"><span class="pre">allow_incomplete</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.sweeps.sweep_outcome_from_metrics">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.sweeps.</span></span><span class="sig-name descname"><span class="pre">sweep_outcome_from_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/sweeps.html#sweep_outcome_from_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.sweeps.sweep_outcome_from_metrics" title="Link to this definition">¶</a></dt>
<dd><p>Translate cached metrics into a <code class="xref py py-class docutils literal notranslate"><span class="pre">SweepOutcome</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task</strong> (<a class="reference internal" href="#knn.pipeline.context.SweepTask" title="knn.pipeline.context.SweepTask"><em>SweepTask</em></a>) – Individual sweep task describing an execution unit.</p></li>
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Metrics dictionary captured from a previous pipeline stage.</p></li>
<li><p><strong>metrics_path</strong> (<em>Path</em>) – Filesystem path where the metrics JSON artefact resides.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Slate sweep outcome reconstructed from cached metrics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.SweepOutcome" title="knn.pipeline.context.SweepOutcome"><em>SweepOutcome</em></a></p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.utils">Utility helpers shared by the Grail Simulation KNN pipeline stages.</p>
<p>Collects small formatting utilities, filesystem helpers, and conversions
from raw metric payloads into structured summaries used by the reports.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">SelectionValidationOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_descriptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty_descriptor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_selected</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#SelectionValidationOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reusable configuration for selection validation helpers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allow_incomplete</strong> (<em>bool</em>)</p></li>
<li><p><strong>logger</strong> (<em>Any</em>)</p></li>
<li><p><strong>missing_descriptor</strong> (<em>str</em>)</p></li>
<li><p><strong>empty_descriptor</strong> (<em>str</em>)</p></li>
<li><p><strong>require_selected</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.empty_descriptor">
<span class="sig-name descname"><span class="pre">empty_descriptor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.empty_descriptor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.logger" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.missing_descriptor">
<span class="sig-name descname"><span class="pre">missing_descriptor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.missing_descriptor" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.SelectionValidationOptions.require_selected">
<span class="sig-name descname"><span class="pre">require_selected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.utils.SelectionValidationOptions.require_selected" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.utils.TaskCacheStrategy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">TaskCacheStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">load_cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#TaskCacheStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.TaskCacheStrategy" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">knn.pipeline.utils.TaskT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">knn.pipeline.utils.OutcomeT</span></code>]</p>
<p>Bundle describing how cached tasks are discovered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_cached</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em> | </em><em>None</em><em>]</em>)</p></li>
<li><p><strong>cache_path</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>pathlib.Path</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.TaskCacheStrategy.cache_path">
<span class="sig-name descname"><span class="pre">cache_path</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">knn.pipeline.utils.TaskT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.utils.TaskCacheStrategy.cache_path" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.utils.TaskCacheStrategy.load_cached">
<span class="sig-name descname"><span class="pre">load_cached</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">knn.pipeline.utils.TaskT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">knn.pipeline.utils.OutcomeT</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.utils.TaskCacheStrategy.load_cached" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_dir">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_dir" title="Link to this definition">¶</a></dt>
<dd><p>Ensure the given directory exists and return it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>Path</em>) – Directory path that should be created if missing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The original <code class="docutils literal notranslate"><span class="pre">Path</span></code> instance for convenient chaining.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_feature_selections">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_feature_selections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_keys</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_feature_selections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_feature_selections" title="Link to this definition">¶</a></dt>
<dd><p>Validate that <code class="docutils literal notranslate"><span class="pre">selections</span></code> covers all <code class="docutils literal notranslate"><span class="pre">expected_keys</span></code> for each feature space.</p>
<p>Emits a warning when <code class="docutils literal notranslate"><span class="pre">allow_incomplete</span></code> is set and some studies are missing.
Raises <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> when data is missing and incomplete results are not allowed.
If <code class="docutils literal notranslate"><span class="pre">require_selected</span></code> is true and no selections were recorded, a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>
is raised to signal the failure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>expected_keys</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions" title="knn.pipeline.utils.SelectionValidationOptions"><em>knn.pipeline.utils.SelectionValidationOptions</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_opinion_selection_coverage">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_opinion_selection_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_selected</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_opinion_selection_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_opinion_selection_coverage" title="Link to this definition">¶</a></dt>
<dd><p>Validate coverage for opinion sweep selections with custom descriptors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Mapping from feature space to per-study opinion selections.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>TypeAliasForwardRef</em><em>(</em><em>'common.pipeline.types.StudySpec'</em><em>)</em><em>]</em>) – Study specifications providing expected keys.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit warnings instead of raising.</p></li>
<li><p><strong>logger</strong> (<em>Any</em>) – Logger used for warnings/info messages.</p></li>
<li><p><strong>require_selected</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, require at least one selection globally.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_selection_coverage">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_selection_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_selection_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_selection_coverage" title="Link to this definition">¶</a></dt>
<dd><p>Validate selection coverage across feature spaces for the given studies.</p>
<p>Wrapper around <a class="reference internal" href="#knn.pipeline.utils.ensure_feature_selections" title="knn.pipeline.utils.ensure_feature_selections"><code class="xref py py-func docutils literal notranslate"><span class="pre">ensure_feature_selections()</span></code></a> that derives expected study
keys from <code class="docutils literal notranslate"><span class="pre">studies</span></code> to avoid duplicating boilerplate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Mapping from feature space to per-study selections.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>TypeAliasForwardRef</em><em>(</em><em>'common.pipeline.types.StudySpec'</em><em>)</em><em>]</em>) – Study specifications providing the expected keys.</p></li>
<li><p><strong>options</strong> (<a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions" title="knn.pipeline.utils.SelectionValidationOptions"><em>knn.pipeline.utils.SelectionValidationOptions</em></a>) – Validation options controlling logging and error behaviour.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code> (raises on validation failure when configured).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.ensure_sweep_selection_coverage">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">ensure_sweep_selection_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_selected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#ensure_sweep_selection_coverage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.ensure_sweep_selection_coverage" title="Link to this definition">¶</a></dt>
<dd><p>Validate coverage for the core sweep selections produced by the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selections</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em><em>]</em>) – Mapping from feature space to per-study selections.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>TypeAliasForwardRef</em><em>(</em><em>'common.pipeline.types.StudySpec'</em><em>)</em><em>]</em>) – Study specifications providing expected keys.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, emit warnings instead of raising.</p></li>
<li><p><strong>logger</strong> (<em>Any</em>) – Logger used for warnings/info messages.</p></li>
<li><p><strong>require_selected</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, require at least one selection globally.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.extract_metric_summary">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">extract_metric_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#extract_metric_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.extract_metric_summary" title="Link to this definition">¶</a></dt>
<dd><p>Collect reusable next-video metric fields from <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Raw metrics dictionary emitted by the evaluation stage.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalised metric summary for downstream reports.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.MetricSummary" title="knn.pipeline.context.MetricSummary">MetricSummary</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.extract_opinion_summary">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">extract_opinion_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#extract_opinion_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.extract_opinion_summary" title="Link to this definition">¶</a></dt>
<dd><p>Collect opinion regression metrics into a normalised structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Raw metrics dictionary emitted by the opinion pipeline.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalised opinion summary for reporting.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#knn.pipeline.context.OpinionSummary" title="knn.pipeline.context.OpinionSummary"><em>OpinionSummary</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_count">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_count"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_count" title="Link to this definition">¶</a></dt>
<dd><p>Format integer counts with thousands separators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Count to render.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted count or an em dash when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_delta">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_delta" title="Link to this definition">¶</a></dt>
<dd><p>Format a signed improvement metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>delta</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Change relative to a baseline.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Signed string (<code class="docutils literal notranslate"><span class="pre">+0.000</span></code> style) or an em dash when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_float">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_float" title="Link to this definition">¶</a></dt>
<dd><p>Format a floating-point metric with three decimal places.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>float</em>) – Numeric metric to render.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted string (<code class="docutils literal notranslate"><span class="pre">{value:.3f}</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_k">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_k"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_k" title="Link to this definition">¶</a></dt>
<dd><p>Format the selected <code class="docutils literal notranslate"><span class="pre">k</span></code> hyper-parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Neighbourhood size under consideration.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>String representation of <code class="docutils literal notranslate"><span class="pre">k</span></code> or an em dash when unset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_optional_float">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_optional_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_optional_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_optional_float" title="Link to this definition">¶</a></dt>
<dd><p>Format an optional floating-point metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Metric value or <code class="docutils literal notranslate"><span class="pre">None</span></code> when unavailable.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Formatted float or an em dash when <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.format_uncertainty_details">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">format_uncertainty_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#format_uncertainty_details"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.format_uncertainty_details" title="Link to this definition">¶</a></dt>
<dd><p>Format auxiliary uncertainty metadata for reporting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>uncertainty</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>) – Mapping containing extra uncertainty fields.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Parenthesised detail string or an empty string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.handle_cached_task">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">handle_cached_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_cached</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#handle_cached_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.handle_cached_task" title="Link to this definition">¶</a></dt>
<dd><p>Append <code class="docutils literal notranslate"><span class="pre">task</span></code> to the <code class="docutils literal notranslate"><span class="pre">partition</span></code> unless a cached outcome can be reused.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> when a cached outcome was appended and the caller should skip execution.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>task</strong> (<em>knn.pipeline.utils.TaskT</em>)</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>)</p></li>
<li><p><strong>cache_path</strong> (<em>pathlib.Path</em>)</p></li>
<li><p><strong>load_cached</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em> | </em><em>None</em><em>]</em>)</p></li>
<li><p><strong>partition</strong> (<em>knn.pipeline.utils.TaskCachePartition</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.parse_ci">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">parse_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci_value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#parse_ci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.parse_ci" title="Link to this definition">¶</a></dt>
<dd><p>Convert confidence-interval payloads into numeric tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ci_value</strong> (<em>object</em>) – Mapping or sequence describing a confidence interval.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing <code class="docutils literal notranslate"><span class="pre">(low,</span> <span class="pre">high)</span></code> bounds when available.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[float, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.partition_cached_tasks">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">partition_cached_tasks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_cached</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#partition_cached_tasks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.partition_cached_tasks" title="Link to this definition">¶</a></dt>
<dd><p>Split <code class="docutils literal notranslate"><span class="pre">tasks</span></code> into pending work and cached results.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing pending task list and cached outcomes respectively.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tasks</strong> (<em>Iterable</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em>)</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>)</p></li>
<li><p><strong>cache_path</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>pathlib.Path</em><em>]</em>)</p></li>
<li><p><strong>load_cached</strong> (<em>Callable</em><em>[</em><em>[</em><em>knn.pipeline.utils.TaskT</em><em>]</em><em>, </em><em>knn.pipeline.utils.OutcomeT</em><em> | </em><em>None</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[<em>List</em>[knn.pipeline.utils.TaskT], <em>List</em>[knn.pipeline.utils.OutcomeT]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.prepare_task_grid">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">prepare_task_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_existing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#prepare_task_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.prepare_task_grid" title="Link to this definition">¶</a></dt>
<dd><p>Construct sweep task grid and partition cached outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>configs</strong> (<em>Sequence</em><em>[</em><em>Any</em><em>]</em>) – Hyper-parameter configurations included in the sweep.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>Any</em><em>]</em>) – Study specifications evaluated by the sweep.</p></li>
<li><p><strong>reuse_existing</strong> (<em>bool</em>) – Whether cached metrics should be reused.</p></li>
<li><p><strong>build_task</strong> (<em>Callable</em><em>[</em><em>[</em><em>int</em><em>, </em><em>Any</em><em>, </em><em>Any</em><em>]</em><em>, </em><em>TaskT</em><em>]</em>) – Callable that constructs a task for the given index, config, and study.</p></li>
<li><p><strong>cache</strong> (<a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy" title="knn.pipeline.utils.TaskCacheStrategy"><em>TaskCacheStrategy</em></a><em>[</em><em>TaskT</em><em>, </em><em>OutcomeT</em><em>]</em>) – Strategy describing how cached outcomes are located and loaded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pending tasks and cached outcomes separated according to <code class="docutils literal notranslate"><span class="pre">reuse_existing</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[TaskT], List[OutcomeT]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.safe_float">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">safe_float</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/pipeline/formatters.html#safe_float"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.safe_float" title="Link to this definition">¶</a></dt>
<dd><p>Attempt to convert <code class="docutils literal notranslate"><span class="pre">value</span></code> to <code class="docutils literal notranslate"><span class="pre">float</span></code> returning <code class="docutils literal notranslate"><span class="pre">None</span></code> on failure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>object</em>) – Candidate value to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float representation or <code class="docutils literal notranslate"><span class="pre">None</span></code> when conversion fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.safe_int">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">safe_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/common/pipeline/formatters.html#safe_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.safe_int" title="Link to this definition">¶</a></dt>
<dd><p>Best-effort conversion to int.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>object</em>) – Value provided for <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result produced by <code class="docutils literal notranslate"><span class="pre">safe_int</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.utils.snake_to_title">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.utils.</span></span><span class="sig-name descname"><span class="pre">snake_to_title</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/utils.html#snake_to_title"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.utils.snake_to_title" title="Link to this definition">¶</a></dt>
<dd><p>Convert a <code class="docutils literal notranslate"><span class="pre">snake_case</span></code> string into Title Case.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>str</em>) – String containing underscore-separated tokens.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Title-cased string with spaces instead of underscores.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.pipeline.context_pipeline">
<span id="context-internals"></span><h2>Context Internals<a class="headerlink" href="#module-knn.pipeline.context_pipeline" title="Link to this heading">¶</a></h2>
<p>Pipeline runtime context for the KNN baselines.</p>
<p>Split from <code class="docutils literal notranslate"><span class="pre">context.py</span></code> to keep that module focused and concise.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._ModelDefaults">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context_pipeline.</span></span><span class="sig-name descname"><span class="pre">_ModelDefaults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">word2vec_epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_workers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sentence_normalize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#_ModelDefaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context_pipeline._ModelDefaults" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Default model hyper-parameters used by the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>word2vec_epochs</strong> (<em>int</em>) – Default number of Word2Vec training epochs.</p></li>
<li><p><strong>word2vec_workers</strong> (<em>int</em>) – Thread workers for Word2Vec training.</p></li>
<li><p><strong>sentence_model</strong> (<em>str</em>) – SentenceTransformer model identifier.</p></li>
<li><p><strong>sentence_device</strong> (<em>str</em><em> | </em><em>None</em>) – Optional device string (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;cuda&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;cpu&quot;</span></code>).</p></li>
<li><p><strong>sentence_batch_size</strong> (<em>int</em>) – Batch size for SentenceTransformer encoding.</p></li>
<li><p><strong>sentence_normalize</strong> (<em>bool</em>) – Whether to L2-normalize sentence embeddings.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._ModelDefaults.sentence_batch_size">
<span class="sig-name descname"><span class="pre">sentence_batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_batch_size" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._ModelDefaults.sentence_device">
<span class="sig-name descname"><span class="pre">sentence_device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_device" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._ModelDefaults.sentence_model">
<span class="sig-name descname"><span class="pre">sentence_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._ModelDefaults.sentence_normalize">
<span class="sig-name descname"><span class="pre">sentence_normalize</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_normalize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._ModelDefaults.word2vec_epochs">
<span class="sig-name descname"><span class="pre">word2vec_epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._ModelDefaults.word2vec_epochs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._ModelDefaults.word2vec_workers">
<span class="sig-name descname"><span class="pre">word2vec_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._ModelDefaults.word2vec_workers" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._OpinionPaths">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context_pipeline.</span></span><span class="sig-name descname"><span class="pre">_OpinionPaths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#_OpinionPaths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context_pipeline._OpinionPaths" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Grouped opinion-specific directories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir</strong> (<em>pathlib.Path</em>) – Base directory for opinion artifacts.</p></li>
<li><p><strong>sweep_dir</strong> (<em>pathlib.Path</em>) – Directory used for opinion sweep intermediates.</p></li>
<li><p><strong>word2vec_dir</strong> (<em>pathlib.Path</em>) – Directory for opinion Word2Vec models.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._OpinionPaths.dir">
<span class="sig-name descname"><span class="pre">dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._OpinionPaths.dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._OpinionPaths.sweep_dir">
<span class="sig-name descname"><span class="pre">sweep_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._OpinionPaths.sweep_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._OpinionPaths.word2vec_dir">
<span class="sig-name descname"><span class="pre">word2vec_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._OpinionPaths.word2vec_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._PipelinePaths">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context_pipeline.</span></span><span class="sig-name descname"><span class="pre">_PipelinePaths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sweep_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">word2vec_model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_video_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opinion</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#_PipelinePaths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context_pipeline._PipelinePaths" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Filesystem locations used by the pipeline.</p>
<p>Grouping these reduces attribute count on <a class="reference internal" href="#knn.pipeline.context.PipelineContext" title="knn.pipeline.context.PipelineContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">PipelineContext</span></code></a> while
still exposing fine-grained read-only accessors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dir</strong> (<em>pathlib.Path</em>) – Base output directory for the run.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – Cache directory for external datasets or models.</p></li>
<li><p><strong>sweep_dir</strong> (<em>pathlib.Path</em>) – Directory for next-video sweep intermediates.</p></li>
<li><p><strong>word2vec_model_dir</strong> (<em>pathlib.Path</em>) – Directory containing global Word2Vec models.</p></li>
<li><p><strong>next_video_dir</strong> (<em>pathlib.Path</em>) – Base directory for next-video artifacts.</p></li>
<li><p><strong>opinion</strong> (<a class="reference internal" href="#knn.pipeline.context_pipeline._OpinionPaths" title="knn.pipeline.context_pipeline._OpinionPaths"><em>knn.pipeline.context_pipeline._OpinionPaths</em></a>) – Grouped opinion-specific directories.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._PipelinePaths.cache_dir">
<span class="sig-name descname"><span class="pre">cache_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._PipelinePaths.cache_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._PipelinePaths.next_video_dir">
<span class="sig-name descname"><span class="pre">next_video_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._PipelinePaths.next_video_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._PipelinePaths.opinion">
<span class="sig-name descname"><span class="pre">opinion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#knn.pipeline.context_pipeline._OpinionPaths" title="knn.pipeline.context_pipeline._OpinionPaths"><span class="pre">knn.pipeline.context_pipeline._OpinionPaths</span></a></em><a class="headerlink" href="#knn.pipeline.context_pipeline._PipelinePaths.opinion" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._PipelinePaths.out_dir">
<span class="sig-name descname"><span class="pre">out_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._PipelinePaths.out_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._PipelinePaths.sweep_dir">
<span class="sig-name descname"><span class="pre">sweep_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._PipelinePaths.sweep_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._PipelinePaths.word2vec_model_dir">
<span class="sig-name descname"><span class="pre">word2vec_model_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._PipelinePaths.word2vec_model_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.context_pipeline.</span></span><span class="sig-name descname"><span class="pre">_Workflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_sweeps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reuse_final</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_next_video</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_opinion</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/context_pipeline.html#_Workflow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Execution toggles and resource options for the pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_spaces</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – Feature spaces to evaluate (e.g., <code class="docutils literal notranslate"><span class="pre">(&quot;tfidf&quot;,</span> <span class="pre">...)</span></code>).</p></li>
<li><p><strong>jobs</strong> (<em>int</em>) – Parallelism for CPU-bound steps.</p></li>
<li><p><strong>reuse_sweeps</strong> (<em>bool</em>) – Reuse existing sweep outputs if present.</p></li>
<li><p><strong>reuse_final</strong> (<em>bool</em>) – Reuse final evaluation results if present.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Allow partial/cached results in reports.</p></li>
<li><p><strong>run_next_video</strong> (<em>bool</em>) – Whether to run next-video tasks.</p></li>
<li><p><strong>run_opinion</strong> (<em>bool</em>) – Whether to run opinion tasks.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow.feature_spaces">
<span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow.feature_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow.jobs">
<span class="sig-name descname"><span class="pre">jobs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow.jobs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow.reuse_final">
<span class="sig-name descname"><span class="pre">reuse_final</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow.reuse_final" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow.reuse_sweeps">
<span class="sig-name descname"><span class="pre">reuse_sweeps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow.reuse_sweeps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow.run_next_video">
<span class="sig-name descname"><span class="pre">run_next_video</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow.run_next_video" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.context_pipeline._Workflow.run_opinion">
<span class="sig-name descname"><span class="pre">run_opinion</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#knn.pipeline.context_pipeline._Workflow.run_opinion" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline.context_reports">Report bundle structures for the KNN pipeline.</p>
<p>Split out from <code class="docutils literal notranslate"><span class="pre">context.py</span></code> to simplify that module and improve Sphinx
autodoc. These helpers aggregate selections, outcomes, and metrics used
by Markdown report generators.</p>
<p id="module-knn.pipeline.context_sweeps">Sweep outcomes and selections for the KNN pipeline.</p>
<p>Split from <code class="docutils literal notranslate"><span class="pre">context.py</span></code> to simplify that module and improve linting.</p>
<p id="module-knn.pipeline.context_config">Sweep configuration types for the KNN pipeline.</p>
<p>Split from <code class="docutils literal notranslate"><span class="pre">context.py</span></code> to keep that module focused and concise.</p>
</section>
<section id="module-knn.pipeline.reports">
<span id="report-builders"></span><h2>Report Builders<a class="headerlink" href="#module-knn.pipeline.reports" title="Link to this heading">¶</a></h2>
<p>Public entry points for the KNN pipeline report builders.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.generate_reports">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.</span></span><span class="sig-name descname"><span class="pre">generate_reports</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_bundle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports.html#generate_reports"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.generate_reports" title="Link to this definition">¶</a></dt>
<dd><p>Write refreshed Markdown reports under <code class="docutils literal notranslate"><span class="pre">reports/knn</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_root</strong> (<em>Path</em>) – Repository root directory used for path resolution.</p></li>
<li><p><strong>report_bundle</strong> (<a class="reference internal" href="#knn.pipeline.context.ReportBundle" title="knn.pipeline.context.ReportBundle"><em>ReportBundle</em></a>) – Aggregated data structure containing everything needed to emit reports.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.catalog">Catalog README builder for the KNN pipeline reports.</p>
<p id="module-knn.pipeline.reports.features">Report builders summarising the extra text fields used by KNN pipelines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.features.build_feature_report">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.features.</span></span><span class="sig-name descname"><span class="pre">build_feature_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/features.html#build_feature_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.features.build_feature_report" title="Link to this definition">¶</a></dt>
<dd><p>Write the KNN additional-feature markdown report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_root</strong> (<em>pathlib.Path</em>) – Repository root used to locate the <code class="docutils literal notranslate"><span class="pre">reports/</span></code> directory.</p></li>
<li><p><strong>bundle</strong> (<a class="reference internal" href="#knn.pipeline.context.ReportBundle" title="knn.pipeline.context.ReportBundle"><em>knn.pipeline.context.ReportBundle</em></a>) – Report bundle providing sweep/final metrics and inclusion flags.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.hyperparameter">Builders for the KNN hyper-parameter Markdown reports.</p>
<p id="module-knn.pipeline.reports.next_video">Modular next-video report builders used by the KNN reporting pipeline.</p>
<p id="module-knn.pipeline.reports.opinion">Opinion report builders for the modular KNN pipeline.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionReportOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regenerate_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asset_subdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'opinion'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/opinion.html#OpinionReportOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bundle of optional parameters for building the opinion report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, allow placeholder output when metrics are missing.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Markdown title inserted at the top of the report.</p></li>
<li><p><strong>description_lines</strong> (<em>Optional</em><em>[</em><em>Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Optional Markdown description beneath the title.</p></li>
<li><p><strong>metrics_line</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Optional override for the metrics summary bullet.</p></li>
<li><p><strong>predictions_root</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – Root directory containing cached opinion predictions.</p></li>
<li><p><strong>regenerate_plots</strong> (<em>bool</em>) – Rebuild matplotlib artefacts before emitting the report.</p></li>
<li><p><strong>asset_subdir</strong> (<em>str</em>) – Subdirectory name used when storing plot artefacts.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.asset_subdir">
<span class="sig-name descname"><span class="pre">asset_subdir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'opinion'</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.asset_subdir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.description_lines">
<span class="sig-name descname"><span class="pre">description_lines</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.description_lines" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.metrics_line">
<span class="sig-name descname"><span class="pre">metrics_line</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.metrics_line" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.predictions_root">
<span class="sig-name descname"><span class="pre">predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.predictions_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.regenerate_plots">
<span class="sig-name descname"><span class="pre">regenerate_plots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.regenerate_plots" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.opinion.OpinionReportOptions.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></em><a class="headerlink" href="#knn.pipeline.reports.opinion.OpinionReportOptions.title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline.reports.shared">Shared helpers for the modular KNN report generation pipeline.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.shared.parse_k_sweep">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.shared.</span></span><span class="sig-name descname"><span class="pre">parse_k_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/shared.html#parse_k_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.shared.parse_k_sweep" title="Link to this definition">¶</a></dt>
<dd><p>Convert the stored <code class="docutils literal notranslate"><span class="pre">k</span></code> sweep representation into integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k_sweep</strong> (<em>str</em><em> | </em><em>Iterable</em><em>[</em><em>int</em><em>]</em>) – Either a comma- or slash-delimited string of integers or an
iterable of integer-like values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of parsed <code class="docutils literal notranslate"><span class="pre">k</span></code> values with invalid tokens skipped.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[int, …]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-knn.pipeline.reports.next_video.inputs">
<span id="next-video-report-internals"></span><h2>Next-Video Report Internals<a class="headerlink" href="#module-knn.pipeline.reports.next_video.inputs" title="Link to this heading">¶</a></h2>
<p>Structured inputs and helper accumulators for the next-video report.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.inputs.</span></span><span class="sig-name descname"><span class="pre">NextVideoReportInputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loso_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgb_next_video_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#NextVideoReportInputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Input bundle required to render the next-video report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>pathlib.Path</em>) – Destination directory where report artifacts are written.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of per-study metrics keyed by feature space.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>TypeAliasForwardRef</em><em>(</em><em>'common.pipeline.types.StudySpec'</em><em>)</em><em>]</em>) – Ordered study specifications covered by the report.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Feature spaces in the order they should appear in the report.</p></li>
<li><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Optional leave-one-study-out metrics grouped by feature space.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Whether the report may emit placeholders when data is missing.</p></li>
<li><p><strong>xgb_next_video_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Root directory containing XGB comparison metrics, if any.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.feature_spaces">
<span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.feature_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.loso_metrics">
<span class="sig-name descname"><span class="pre">loso_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.loso_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.metrics_by_feature">
<span class="sig-name descname"><span class="pre">metrics_by_feature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.metrics_by_feature" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.output_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.studies">
<span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'common.pipeline.types.StudySpec'</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.xgb_next_video_dir">
<span class="sig-name descname"><span class="pre">xgb_next_video_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.xgb_next_video_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.inputs.</span></span><span class="sig-name descname"><span class="pre">PortfolioAggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">accuracy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eligible</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#PortfolioAggregate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Weighted portfolio metrics for a feature space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>accuracy</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>baseline</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>random</strong> (<em>float</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>eligible</strong> (<em>int</em>)</p></li>
<li><p><strong>studies</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.accuracy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.baseline">
<span class="sig-name descname"><span class="pre">baseline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.baseline" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.eligible">
<span class="sig-name descname"><span class="pre">eligible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.eligible" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.random">
<span class="sig-name descname"><span class="pre">random</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.random" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.inputs.PortfolioAggregate.studies">
<span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline.reports.next_video.sections">Markdown section builders for the next-video report.</p>
<p id="module-knn.pipeline.reports.next_video.curves">Plot generation helpers for next-video learning-curve sections.</p>
<p id="module-knn.pipeline.reports.next_video.comparison">Helpers for comparing next-video KNN metrics against XGB baselines.</p>
<p id="module-knn.pipeline.reports.next_video.loso">Leave-one-study-out reporting helpers for the next-video report.</p>
<p id="module-knn.pipeline.reports.next_video.csv_exports">CSV export helpers for next-video report metrics.</p>
<p id="module-knn.pipeline.reports.next_video.helpers">Shared helper utilities for next-video report submodules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.helpers.accuracy_delta">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.helpers.</span></span><span class="sig-name descname"><span class="pre">accuracy_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summary</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/helpers.html#accuracy_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.helpers.accuracy_delta" title="Link to this definition">¶</a></dt>
<dd><p>Return the accuracy delta vs. baseline for <code class="docutils literal notranslate"><span class="pre">summary</span></code> when available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>summary</strong> (<a class="reference internal" href="#knn.pipeline.context.MetricSummary" title="knn.pipeline.context_summaries.MetricSummary"><em>knn.pipeline.context_summaries.MetricSummary</em></a>) – Metric summary with <code class="docutils literal notranslate"><span class="pre">accuracy</span></code> and <code class="docutils literal notranslate"><span class="pre">baseline</span></code> attributes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Float delta or <code class="docutils literal notranslate"><span class="pre">None</span></code> if either component is missing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline.reports.next_video.helpers.iter_metric_payloads">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline.reports.next_video.helpers.</span></span><span class="sig-name descname"><span class="pre">iter_metric_payloads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/helpers.html#iter_metric_payloads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline.reports.next_video.helpers.iter_metric_payloads" title="Link to this definition">¶</a></dt>
<dd><p>Yield per-study metric summaries alongside their raw payloads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em>) – Mapping of study key to raw metric payloads.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a><em>]</em>) – Ordered sequence of study specifications.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Iterator yielding <code class="docutils literal notranslate"><span class="pre">(study,</span> <span class="pre">summary,</span> <span class="pre">payload)</span></code> tuples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterator[Tuple[<a class="reference internal" href="common.html#common.pipeline.types.StudySpec" title="knn.pipeline.context.StudySpec"><em>StudySpec</em></a>, <a class="reference internal" href="#knn.pipeline.context.MetricSummary" title="knn.pipeline.context.MetricSummary">MetricSummary</a>, Mapping[str, object]]]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline.reports.next_video.report">Orchestration for building next-video KNN reports.</p>
</section>
<section id="module-knn.pipeline_reports">
<span id="legacy-report-shims"></span><h2>Legacy Report Shims<a class="headerlink" href="#module-knn.pipeline_reports" title="Link to this heading">¶</a></h2>
<p>Compatibility package for legacy KNN report imports.</p>
<p>This package preserves the older <code class="docutils literal notranslate"><span class="pre">knn.pipeline_reports</span></code> import path by
forwarding to the modern implementations under <a class="reference internal" href="#module-knn.pipeline.reports" title="knn.pipeline.reports"><code class="xref py py-mod docutils literal notranslate"><span class="pre">knn.pipeline.reports</span></code></a>.</p>
<p>Individual modules (features, hyperparameter, next_video, opinion, shared)
re-export the corresponding builders from the new location.</p>
<p id="module-knn.pipeline_reports.catalog">Compatibility shim exposing the catalog report builder.</p>
<p>Forwards to <a class="reference internal" href="#module-knn.pipeline.reports.catalog" title="knn.pipeline.reports.catalog"><code class="xref py py-mod docutils literal notranslate"><span class="pre">knn.pipeline.reports.catalog</span></code></a>.</p>
<p id="module-knn.pipeline_reports.next_video">Re-export next-video report helpers from <a class="reference internal" href="#module-knn.pipeline.reports" title="knn.pipeline.reports"><code class="xref py py-mod docutils literal notranslate"><span class="pre">knn.pipeline.reports</span></code></a>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.next_video.</span></span><span class="sig-name descname"><span class="pre">NextVideoReportInputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_by_feature</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">studies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_spaces</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loso_metrics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgb_next_video_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/next_video/inputs.html#NextVideoReportInputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Input bundle required to render the next-video report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>pathlib.Path</em>) – Destination directory where report artifacts are written.</p></li>
<li><p><strong>metrics_by_feature</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>]</em>) – Nested mapping of per-study metrics keyed by feature space.</p></li>
<li><p><strong>studies</strong> (<em>Sequence</em><em>[</em><em>TypeAliasForwardRef</em><em>(</em><em>'common.pipeline.types.StudySpec'</em><em>)</em><em>]</em>) – Ordered study specifications covered by the report.</p></li>
<li><p><strong>feature_spaces</strong> (<em>Sequence</em><em>[</em><em>str</em><em>]</em>) – Feature spaces in the order they should appear in the report.</p></li>
<li><p><strong>loso_metrics</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Mapping</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em>) – Optional leave-one-study-out metrics grouped by feature space.</p></li>
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – Whether the report may emit placeholders when data is missing.</p></li>
<li><p><strong>xgb_next_video_dir</strong> (<em>pathlib.Path</em><em> | </em><em>None</em>) – Root directory containing XGB comparison metrics, if any.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.feature_spaces">
<span class="sig-name descname"><span class="pre">feature_spaces</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.feature_spaces" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.loso_metrics">
<span class="sig-name descname"><span class="pre">loso_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.loso_metrics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.metrics_by_feature">
<span class="sig-name descname"><span class="pre">metrics_by_feature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">object</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.metrics_by_feature" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.output_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.studies">
<span class="sig-name descname"><span class="pre">studies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'common.pipeline.types.StudySpec'</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.studies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.next_video.NextVideoReportInputs.xgb_next_video_dir">
<span class="sig-name descname"><span class="pre">xgb_next_video_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.xgb_next_video_dir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<p id="module-knn.pipeline_reports.shared">Expose shared report helpers from <a class="reference internal" href="#module-knn.pipeline.reports.shared" title="knn.pipeline.reports.shared"><code class="xref py py-mod docutils literal notranslate"><span class="pre">knn.pipeline.reports.shared</span></code></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline_reports.shared.parse_k_sweep">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.shared.</span></span><span class="sig-name descname"><span class="pre">parse_k_sweep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_sweep</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/shared.html#parse_k_sweep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.shared.parse_k_sweep" title="Link to this definition">¶</a></dt>
<dd><p>Convert the stored <code class="docutils literal notranslate"><span class="pre">k</span></code> sweep representation into integers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k_sweep</strong> (<em>str</em><em> | </em><em>Iterable</em><em>[</em><em>int</em><em>]</em>) – Either a comma- or slash-delimited string of integers or an
iterable of integer-like values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of parsed <code class="docutils literal notranslate"><span class="pre">k</span></code> values with invalid tokens skipped.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Tuple</em>[int, …]</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline_reports.features">Compatibility wrapper exposing <code class="docutils literal notranslate"><span class="pre">knn.pipeline.reports.features</span></code> helpers.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.pipeline_reports.features.build_feature_report">
<span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.features.</span></span><span class="sig-name descname"><span class="pre">build_feature_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">repo_root</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bundle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/features.html#build_feature_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.features.build_feature_report" title="Link to this definition">¶</a></dt>
<dd><p>Write the KNN additional-feature markdown report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>repo_root</strong> (<em>pathlib.Path</em>) – Repository root used to locate the <code class="docutils literal notranslate"><span class="pre">reports/</span></code> directory.</p></li>
<li><p><strong>bundle</strong> (<a class="reference internal" href="#knn.pipeline.context.ReportBundle" title="knn.pipeline.context.ReportBundle"><em>knn.pipeline.context.ReportBundle</em></a>) – Report bundle providing sweep/final metrics and inclusion flags.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.pipeline_reports.hyperparameter">Compatibility wrapper exposing the hyper-parameter report builder.</p>
<p id="module-knn.pipeline_reports.opinion">Compatibility shim re-exporting opinion report builders.</p>
<dl class="py class">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">knn.pipeline_reports.opinion.</span></span><span class="sig-name descname"><span class="pre">OpinionReportOptions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_line</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regenerate_plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">asset_subdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'opinion'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/pipeline/reports/opinion.html#OpinionReportOptions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Bundle of optional parameters for building the opinion report.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allow_incomplete</strong> (<em>bool</em>) – When <code class="docutils literal notranslate"><span class="pre">True</span></code>, allow placeholder output when metrics are missing.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Markdown title inserted at the top of the report.</p></li>
<li><p><strong>description_lines</strong> (<em>Optional</em><em>[</em><em>Sequence</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Optional Markdown description beneath the title.</p></li>
<li><p><strong>metrics_line</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Optional override for the metrics summary bullet.</p></li>
<li><p><strong>predictions_root</strong> (<em>Optional</em><em>[</em><em>Path</em><em>]</em>) – Root directory containing cached opinion predictions.</p></li>
<li><p><strong>regenerate_plots</strong> (<em>bool</em>) – Rebuild matplotlib artefacts before emitting the report.</p></li>
<li><p><strong>asset_subdir</strong> (<em>str</em>) – Subdirectory name used when storing plot artefacts.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.allow_incomplete">
<span class="sig-name descname"><span class="pre">allow_incomplete</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.allow_incomplete" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.asset_subdir">
<span class="sig-name descname"><span class="pre">asset_subdir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'opinion'</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.asset_subdir" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.description_lines">
<span class="sig-name descname"><span class="pre">description_lines</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.description_lines" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.metrics_line">
<span class="sig-name descname"><span class="pre">metrics_line</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.metrics_line" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.predictions_root">
<span class="sig-name descname"><span class="pre">predictions_root</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.predictions_root" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.regenerate_plots">
<span class="sig-name descname"><span class="pre">regenerate_plots</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.regenerate_plots" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="knn.pipeline_reports.opinion.OpinionReportOptions.title">
<span class="sig-name descname"><span class="pre">title</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'#</span> <span class="pre">KNN</span> <span class="pre">Opinion</span> <span class="pre">Shift</span> <span class="pre">Study'</span></em><a class="headerlink" href="#knn.pipeline_reports.opinion.OpinionReportOptions.title" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-knn.scripts">
<span id="scripts"></span><h2>Scripts<a class="headerlink" href="#module-knn.scripts" title="Link to this heading">¶</a></h2>
<p>Executable helpers shipped with the KNN package.</p>
<p id="module-knn.scripts.baseline">Legacy CLI shim maintained for backwards compatibility.</p>
<p>Backward-compatible entry point for the refactored KNN baseline.</p>
</section>
<section id="module-knn.cli.__main__">
<span id="cli-internals"></span><h2>CLI Internals<a class="headerlink" href="#module-knn.cli.__main__" title="Link to this heading">¶</a></h2>
<p>Entry point for <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">knn.cli</span></code>.</p>
<p id="module-knn.cli.main">Command-line interface for the Grail Simulation KNN baselines.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.main.build_parser">
<span class="sig-prename descclassname"><span class="pre">knn.cli.main.</span></span><span class="sig-name descname"><span class="pre">build_parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli/main.html#build_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.main.build_parser" title="Link to this definition">¶</a></dt>
<dd><p>Build the command-line parser that drives the refactored KNN workflows.</p>
<p>The parser exposes switches for both slate (next-video) and opinion
prediction flows, including feature-space selection, pre-computed index
reuse, bootstrap configuration, and Word2Vec/SentenceTransformer tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parser pre-populated with all supported CLI arguments for the KNN baseline.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>argparse.ArgumentParser</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.main.main">
<span class="sig-prename descclassname"><span class="pre">knn.cli.main.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">argv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli/main.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.main.main" title="Link to this definition">¶</a></dt>
<dd><p>Dispatch execution for the CLI by parsing arguments and invoking the correct runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>argv</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>None</em>) – Optional argument vector supplied for testing. When <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="xref py py-data docutils literal notranslate"><span class="pre">sys.argv</span></code> is used verbatim.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. The function delegates work to the slate or opinion pipeline.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">--task</span></code> is neither <code class="docutils literal notranslate"><span class="pre">slate</span></code> nor <code class="docutils literal notranslate"><span class="pre">opinion</span></code>.</p>
</dd>
</dl>
</dd></dl>

<p id="module-knn.cli.utils">CLI utility helpers shared by the KNN baseline entry points.</p>
<dl class="py function">
<dt class="sig sig-object py" id="knn.cli.utils.add_sentence_transformer_normalize_flags">
<span class="sig-prename descclassname"><span class="pre">knn.cli.utils.</span></span><span class="sig-name descname"><span class="pre">add_sentence_transformer_normalize_flags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/knn/cli/utils.html#add_sentence_transformer_normalize_flags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#knn.cli.utils.add_sentence_transformer_normalize_flags" title="Link to this definition">¶</a></dt>
<dd><p>Attach normalisation toggle flags for sentence-transformer embeddings to a parser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parser</strong> (<em>argparse.ArgumentParser</em>) – Argument parser receiving the flags that control embedding normalisation.</p></li>
<li><p><strong>legacy_aliases</strong> (<em>bool</em>) – Register underscore-separated aliases to maintain compatibility with
pre-refactor invocations.</p></li>
<li><p><strong>help_prefix</strong> (<em>str</em>) – Optional text prepended to the generated help strings to provide context.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code>. Flags are added to <code class="docutils literal notranslate"><span class="pre">parser</span></code> in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="xgb.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">XGBoost Baseline API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="clean_data.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Clean Data Pipeline</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, GRAIL Simulation Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">KNN Baseline API</a><ul>
<li><a class="reference internal" href="#feature-spaces">Feature Spaces</a></li>
<li><a class="reference internal" href="#elbow-curve-metrics">Elbow &amp; Curve Metrics</a></li>
<li><a class="reference internal" href="#module-knn">Package Overview</a><ul>
<li><a class="reference internal" href="#knn.data.filter_dataset_for_issue"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.filter_dataset_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.filter_split_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_split_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.issues_in_dataset"><code class="docutils literal notranslate"><span class="pre">issues_in_dataset()</span></code></a></li>
<li><a class="reference internal" href="#knn.data.load_dataset_source"><code class="docutils literal notranslate"><span class="pre">load_dataset_source()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder</span></code></a><ul>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.encode"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.encode()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.load"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.load()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.save"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.save()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.train"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.train()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.Word2VecFeatureBuilder.transform"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.transform()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.features.assemble_document"><code class="docutils literal notranslate"><span class="pre">assemble_document()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.candidate_feature_tokens"><code class="docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.collect_candidate_metadata"><code class="docutils literal notranslate"><span class="pre">collect_candidate_metadata()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.extract_now_watching"><code class="docutils literal notranslate"><span class="pre">extract_now_watching()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.extract_slate_items"><code class="docutils literal notranslate"><span class="pre">extract_slate_items()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prepare_prompt_documents"><code class="docutils literal notranslate"><span class="pre">prepare_prompt_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prepare_training_documents"><code class="docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.prompt_from_builder"><code class="docutils literal notranslate"><span class="pre">prompt_from_builder()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.selection_feature_tokens"><code class="docutils literal notranslate"><span class="pre">selection_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.title_for"><code class="docutils literal notranslate"><span class="pre">title_for()</span></code></a></li>
<li><a class="reference internal" href="#knn.features.viewer_profile_sentence"><code class="docutils literal notranslate"><span class="pre">viewer_profile_sentence()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">build_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_tfidf_index"><code class="docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.build_word2vec_index"><code class="docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.knn_predict_among_slate_multi"><code class="docutils literal notranslate"><span class="pre">knn_predict_among_slate_multi()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">load_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_tfidf_index"><code class="docutils literal notranslate"><span class="pre">load_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.load_word2vec_index"><code class="docutils literal notranslate"><span class="pre">load_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_tfidf_index"><code class="docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.index.save_word2vec_index"><code class="docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.bin_nopts"><code class="docutils literal notranslate"><span class="pre">bin_nopts()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.bucket_from_pos"><code class="docutils literal notranslate"><span class="pre">bucket_from_pos()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.canon"><code class="docutils literal notranslate"><span class="pre">canon()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.compute_auc_from_curve"><code class="docutils literal notranslate"><span class="pre">compute_auc_from_curve()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.evaluate_issue"><code class="docutils literal notranslate"><span class="pre">evaluate_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.parse_k_values"><code class="docutils literal notranslate"><span class="pre">parse_k_values()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.plot_elbow"><code class="docutils literal notranslate"><span class="pre">plot_elbow()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.resolve_reports_dir"><code class="docutils literal notranslate"><span class="pre">resolve_reports_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.run_eval"><code class="docutils literal notranslate"><span class="pre">run_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.evaluate.select_best_k"><code class="docutils literal notranslate"><span class="pre">select_best_k()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.core.data">Core (Canonical Paths)</a><ul>
<li><a class="reference internal" href="#knn.core.data.filter_dataset_for_issue"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.filter_dataset_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_dataset_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.filter_split_for_participant_studies"><code class="docutils literal notranslate"><span class="pre">filter_split_for_participant_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.issues_in_dataset"><code class="docutils literal notranslate"><span class="pre">issues_in_dataset()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.data.load_dataset_source"><code class="docutils literal notranslate"><span class="pre">load_dataset_source()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.channel_id"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.channel_id</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.channel_title"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.channel_title</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.slot"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.slot</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.title"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.title</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.CandidateMetadata.video_id"><code class="docutils literal notranslate"><span class="pre">CandidateMetadata.video_id</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.epochs"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.epochs</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.min_count"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.min_count</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.model_dir"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.model_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.seed"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.seed</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.vector_size"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.vector_size</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.window"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.window</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecConfig.workers"><code class="docutils literal notranslate"><span class="pre">Word2VecConfig.workers</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.__init__"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.encode"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.encode()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.load"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.load()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.save"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.save()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.train"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.train()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.Word2VecFeatureBuilder.transform"><code class="docutils literal notranslate"><span class="pre">Word2VecFeatureBuilder.transform()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.features.assemble_document"><code class="docutils literal notranslate"><span class="pre">assemble_document()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.candidate_feature_tokens"><code class="docutils literal notranslate"><span class="pre">candidate_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.collect_candidate_metadata"><code class="docutils literal notranslate"><span class="pre">collect_candidate_metadata()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.extract_now_watching"><code class="docutils literal notranslate"><span class="pre">extract_now_watching()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.extract_slate_items"><code class="docutils literal notranslate"><span class="pre">extract_slate_items()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.prepare_prompt_documents"><code class="docutils literal notranslate"><span class="pre">prepare_prompt_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.prepare_training_documents"><code class="docutils literal notranslate"><span class="pre">prepare_training_documents()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.prompt_from_builder"><code class="docutils literal notranslate"><span class="pre">prompt_from_builder()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.selection_feature_tokens"><code class="docutils literal notranslate"><span class="pre">selection_feature_tokens()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.title_for"><code class="docutils literal notranslate"><span class="pre">title_for()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.features.viewer_profile_sentence"><code class="docutils literal notranslate"><span class="pre">viewer_profile_sentence()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.build_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">build_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.build_tfidf_index"><code class="docutils literal notranslate"><span class="pre">build_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.build_word2vec_index"><code class="docutils literal notranslate"><span class="pre">build_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.knn_predict_among_slate_multi"><code class="docutils literal notranslate"><span class="pre">knn_predict_among_slate_multi()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.load_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">load_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.load_tfidf_index"><code class="docutils literal notranslate"><span class="pre">load_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.load_word2vec_index"><code class="docutils literal notranslate"><span class="pre">load_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.save_sentence_transformer_index"><code class="docutils literal notranslate"><span class="pre">save_sentence_transformer_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.save_tfidf_index"><code class="docutils literal notranslate"><span class="pre">save_tfidf_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.index.save_word2vec_index"><code class="docutils literal notranslate"><span class="pre">save_word2vec_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.bin_nopts"><code class="docutils literal notranslate"><span class="pre">bin_nopts()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.bucket_from_pos"><code class="docutils literal notranslate"><span class="pre">bucket_from_pos()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.canon"><code class="docutils literal notranslate"><span class="pre">canon()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.compute_auc_from_curve"><code class="docutils literal notranslate"><span class="pre">compute_auc_from_curve()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.evaluate_issue"><code class="docutils literal notranslate"><span class="pre">evaluate_issue()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.parse_k_values"><code class="docutils literal notranslate"><span class="pre">parse_k_values()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.plot_elbow"><code class="docutils literal notranslate"><span class="pre">plot_elbow()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.resolve_reports_dir"><code class="docutils literal notranslate"><span class="pre">resolve_reports_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.run_eval"><code class="docutils literal notranslate"><span class="pre">run_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.evaluate.select_best_k"><code class="docutils literal notranslate"><span class="pre">select_best_k()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion.run_opinion_eval"><code class="docutils literal notranslate"><span class="pre">run_opinion_eval()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs"><code class="docutils literal notranslate"><span class="pre">OpinionEmbeddingConfigs</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.sentence_transformer"><code class="docutils literal notranslate"><span class="pre">OpinionEmbeddingConfigs.sentence_transformer</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEmbeddingConfigs.word2vec"><code class="docutils literal notranslate"><span class="pre">OpinionEmbeddingConfigs.word2vec</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.args"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.args</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.dataset"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.dataset</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.embedding_configs"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.embedding_configs</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.extra_fields"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.extra_fields</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.feature_space"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.k_values"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.k_values</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionEvaluationContext.outputs_root"><code class="docutils literal notranslate"><span class="pre">OpinionEvaluationContext.outputs_root</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample"><code class="docutils literal notranslate"><span class="pre">OpinionExample</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.after"><code class="docutils literal notranslate"><span class="pre">OpinionExample.after</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.before"><code class="docutils literal notranslate"><span class="pre">OpinionExample.before</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.document"><code class="docutils literal notranslate"><span class="pre">OpinionExample.document</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.issue"><code class="docutils literal notranslate"><span class="pre">OpinionExample.issue</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.participant_id"><code class="docutils literal notranslate"><span class="pre">OpinionExample.participant_id</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.participant_study"><code class="docutils literal notranslate"><span class="pre">OpinionExample.participant_study</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.session"><code class="docutils literal notranslate"><span class="pre">OpinionExample.session</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.session_id"><code class="docutils literal notranslate"><span class="pre">OpinionExample.session_id</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionExample.step_index"><code class="docutils literal notranslate"><span class="pre">OpinionExample.step_index</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex"><code class="docutils literal notranslate"><span class="pre">OpinionIndex</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.embeds"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.embeds</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.feature_space"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.matrix"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.matrix</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.metric"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.metric</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.neighbors"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.neighbors</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.targets"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.targets</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionIndex.vectorizer"><code class="docutils literal notranslate"><span class="pre">OpinionIndex.vectorizer</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionTargets"><code class="docutils literal notranslate"><span class="pre">OpinionTargets</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionTargets.after"><code class="docutils literal notranslate"><span class="pre">OpinionTargets.after</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionTargets.before"><code class="docutils literal notranslate"><span class="pre">OpinionTargets.before</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.OpinionTargets.participant_keys"><code class="docutils literal notranslate"><span class="pre">OpinionTargets.participant_keys</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_models.SessionInfo"><code class="docutils literal notranslate"><span class="pre">SessionInfo</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_models.SessionInfo.session_id"><code class="docutils literal notranslate"><span class="pre">SessionInfo.session_id</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_models.SessionInfo.step_index"><code class="docutils literal notranslate"><span class="pre">SessionInfo.step_index</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_data.collect_examples"><code class="docutils literal notranslate"><span class="pre">collect_examples()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_data.find_spec"><code class="docutils literal notranslate"><span class="pre">find_spec()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig</span></code></a><ul>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig.feature_space"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig.feature_space_norm"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig.feature_space_norm()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig.metric"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig.metric</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig.metric_norm"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig.metric_norm()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig.seed"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig.seed</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig.sentence_transformer"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig.sentence_transformer</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_index.OpinionIndexConfig.word2vec"><code class="docutils literal notranslate"><span class="pre">OpinionIndexConfig.word2vec</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.core.opinion_index.build_index"><code class="docutils literal notranslate"><span class="pre">build_index()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.opinion_predictions.predict_post_indices"><code class="docutils literal notranslate"><span class="pre">predict_post_indices()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.utils.ensure_directory"><code class="docutils literal notranslate"><span class="pre">ensure_directory()</span></code></a></li>
<li><a class="reference internal" href="#knn.core.utils.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.utils">Core Utilities</a><ul>
<li><a class="reference internal" href="#knn.utils.ensure_directory"><code class="docutils literal notranslate"><span class="pre">ensure_directory()</span></code></a></li>
<li><a class="reference internal" href="#knn.utils.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline.context">Pipeline Modules</a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext"><code class="docutils literal notranslate"><span class="pre">EvaluationContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.base_cli"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.base_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.extra_cli"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.extra_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.from_args"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.from_args()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.next_video_out_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.next_video_out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.next_video_word2vec_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.next_video_word2vec_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.opinion_out_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.opinion_out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.opinion_word2vec_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.opinion_word2vec_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.out_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.outputs"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.outputs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.reuse_existing"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.reuse_existing</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.word2vec_model_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationContext.word2vec_models"><code class="docutils literal notranslate"><span class="pre">EvaluationContext.word2vec_models</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs"><code class="docutils literal notranslate"><span class="pre">EvaluationOutputs</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs.from_keywords"><code class="docutils literal notranslate"><span class="pre">EvaluationOutputs.from_keywords()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs.next_video"><code class="docutils literal notranslate"><span class="pre">EvaluationOutputs.next_video</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs.opinion"><code class="docutils literal notranslate"><span class="pre">EvaluationOutputs.opinion</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationOutputs.shared"><code class="docutils literal notranslate"><span class="pre">EvaluationOutputs.shared</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths"><code class="docutils literal notranslate"><span class="pre">EvaluationWord2VecPaths</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths.from_keywords"><code class="docutils literal notranslate"><span class="pre">EvaluationWord2VecPaths.from_keywords()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths.next_video"><code class="docutils literal notranslate"><span class="pre">EvaluationWord2VecPaths.next_video</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths.opinion"><code class="docutils literal notranslate"><span class="pre">EvaluationWord2VecPaths.opinion</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.EvaluationWord2VecPaths.shared"><code class="docutils literal notranslate"><span class="pre">EvaluationWord2VecPaths.shared</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary"><code class="docutils literal notranslate"><span class="pre">MetricSummary</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.__init__"><code class="docutils literal notranslate"><span class="pre">MetricSummary.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy"><code class="docutils literal notranslate"><span class="pre">MetricSummary.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy_all_rows"><code class="docutils literal notranslate"><span class="pre">MetricSummary.accuracy_all_rows</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.accuracy_ci"><code class="docutils literal notranslate"><span class="pre">MetricSummary.accuracy_ci</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.baseline"><code class="docutils literal notranslate"><span class="pre">MetricSummary.baseline</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.baseline_ci"><code class="docutils literal notranslate"><span class="pre">MetricSummary.baseline_ci</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.best_k"><code class="docutils literal notranslate"><span class="pre">MetricSummary.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.n_eligible"><code class="docutils literal notranslate"><span class="pre">MetricSummary.n_eligible</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.n_total"><code class="docutils literal notranslate"><span class="pre">MetricSummary.n_total</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.MetricSummary.random_baseline"><code class="docutils literal notranslate"><span class="pre">MetricSummary.random_baseline</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection"><code class="docutils literal notranslate"><span class="pre">OpinionStudySelection</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionStudySelection.best_k"><code class="docutils literal notranslate"><span class="pre">OpinionStudySelection.best_k</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary"><code class="docutils literal notranslate"><span class="pre">OpinionSummary</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.BaselineStats"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.BaselineStats</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.BaselineStats.baseline_mae"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.BaselineStats.baseline_mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.BaselineStats.mae_delta"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.BaselineStats.mae_delta</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.ChangeStats"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.ChangeStats</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.ChangeStats.baseline_rmse_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.ChangeStats.baseline_rmse_change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.ChangeStats.mae_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.ChangeStats.mae_change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.ChangeStats.rmse_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.ChangeStats.rmse_change</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Inputs"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Inputs</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Inputs.accuracy"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Inputs.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Inputs.calibration"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Inputs.calibration</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Inputs.calibration_bins"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Inputs.calibration_bins</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Inputs.regression"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Inputs.regression</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.PrimaryRegression</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression.mae"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.PrimaryRegression.mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression.r2_score"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.PrimaryRegression.r2_score</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.PrimaryRegression.rmse"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.PrimaryRegression.rmse</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Regression"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Regression</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Regression.baseline"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Regression.baseline</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Regression.best_k"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Regression.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Regression.change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Regression.change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.Regression.primary"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.Regression.primary</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.accuracy"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.baseline_mae"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.baseline_mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.baseline_rmse_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.baseline_rmse_change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.best_k"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.calibration_bins"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.calibration_bins</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.mae_change</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.mae_delta"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.mae_delta</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.r2_score"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.r2_score</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.rmse"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.rmse</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummary.rmse_change"><code class="docutils literal notranslate"><span class="pre">OpinionSummary.rmse_change</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSummaryInputs"><code class="docutils literal notranslate"><span class="pre">OpinionSummaryInputs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.__init__"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.accuracy"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.accuracy_delta"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.accuracy_delta</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.artifact"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.artifact</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.baseline_accuracy"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.baseline_accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.baseline_mae"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.baseline_mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.best_k"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.config"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.config</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.eligible"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.eligible</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.feature_space"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.mae"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.mae</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.mae_delta"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.mae_delta</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.metrics"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.metrics_path"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.metrics_path</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.order_index"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.order_index</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.participants"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.participants</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.r2_score"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.r2_score</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.rmse"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.rmse</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepOutcome.study"><code class="docutils literal notranslate"><span class="pre">OpinionSweepOutcome.study</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.base_cli"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.base_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.extra_cli"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.extra_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.run_root"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.run_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.OpinionSweepTask.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">OpinionSweepTask.word2vec_model_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext"><code class="docutils literal notranslate"><span class="pre">PipelineContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.__init__"><code class="docutils literal notranslate"><span class="pre">PipelineContext.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.dataset"><code class="docutils literal notranslate"><span class="pre">PipelineContext.dataset</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.from_mappings"><code class="docutils literal notranslate"><span class="pre">PipelineContext.from_mappings()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.k_sweep"><code class="docutils literal notranslate"><span class="pre">PipelineContext.k_sweep</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sentence_batch_size"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sentence_batch_size</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sentence_device"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sentence_device</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.sentence_normalize"><code class="docutils literal notranslate"><span class="pre">PipelineContext.sentence_normalize</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.set_sentence_batch_size"><code class="docutils literal notranslate"><span class="pre">PipelineContext.set_sentence_batch_size()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.set_sentence_device"><code class="docutils literal notranslate"><span class="pre">PipelineContext.set_sentence_device()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.set_sentence_normalize"><code class="docutils literal notranslate"><span class="pre">PipelineContext.set_sentence_normalize()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PipelineContext.study_tokens"><code class="docutils literal notranslate"><span class="pre">PipelineContext.study_tokens</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.PredictionRoots"><code class="docutils literal notranslate"><span class="pre">PredictionRoots</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.PresentationFlags"><code class="docutils literal notranslate"><span class="pre">PresentationFlags</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle"><code class="docutils literal notranslate"><span class="pre">ReportBundle</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">ReportBundle.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.feature_spaces"><code class="docutils literal notranslate"><span class="pre">ReportBundle.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.include_next_video"><code class="docutils literal notranslate"><span class="pre">ReportBundle.include_next_video</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.include_opinion"><code class="docutils literal notranslate"><span class="pre">ReportBundle.include_opinion</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.include_opinion_from_next"><code class="docutils literal notranslate"><span class="pre">ReportBundle.include_opinion_from_next</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.k_sweep"><code class="docutils literal notranslate"><span class="pre">ReportBundle.k_sweep</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.loso_metrics"><code class="docutils literal notranslate"><span class="pre">ReportBundle.loso_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.metrics_by_feature"><code class="docutils literal notranslate"><span class="pre">ReportBundle.metrics_by_feature</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_from_next_metrics"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_from_next_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_from_next_predictions_root"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_from_next_predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_metrics"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_predictions_root"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_selections"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_selections</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.opinion_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">ReportBundle.opinion_sweep_outcomes</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.selections"><code class="docutils literal notranslate"><span class="pre">ReportBundle.selections</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.sentence_model"><code class="docutils literal notranslate"><span class="pre">ReportBundle.sentence_model</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.studies"><code class="docutils literal notranslate"><span class="pre">ReportBundle.studies</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.ReportBundle.sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">ReportBundle.sweep_outcomes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySelection"><code class="docutils literal notranslate"><span class="pre">StudySelection</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.StudySelection.accuracy"><code class="docutils literal notranslate"><span class="pre">StudySelection.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.StudySelection.best_k"><code class="docutils literal notranslate"><span class="pre">StudySelection.best_k</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig"><code class="docutils literal notranslate"><span class="pre">SweepConfig</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.cli_args"><code class="docutils literal notranslate"><span class="pre">SweepConfig.cli_args()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.feature_space"><code class="docutils literal notranslate"><span class="pre">SweepConfig.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.label"><code class="docutils literal notranslate"><span class="pre">SweepConfig.label()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.metric"><code class="docutils literal notranslate"><span class="pre">SweepConfig.metric</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_batch_size"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_batch_size</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_device"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_device</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_model"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_model</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.sentence_transformer_normalize"><code class="docutils literal notranslate"><span class="pre">SweepConfig.sentence_transformer_normalize</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.text_fields"><code class="docutils literal notranslate"><span class="pre">SweepConfig.text_fields</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_epochs"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_epochs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_min_count"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_min_count</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_size"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_size</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_window"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_window</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepConfig.word2vec_workers"><code class="docutils literal notranslate"><span class="pre">SweepConfig.word2vec_workers</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome"><code class="docutils literal notranslate"><span class="pre">SweepOutcome</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.__init__"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.__init__()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.accuracy"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.best_k"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.best_k</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.config"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.config</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.eligible"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.eligible</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.feature_space"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.feature_space</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.metrics"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.metrics_path"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.metrics_path</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.order_index"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.order_index</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepOutcome.study"><code class="docutils literal notranslate"><span class="pre">SweepOutcome.study</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask"><code class="docutils literal notranslate"><span class="pre">SweepTask</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask.issue"><code class="docutils literal notranslate"><span class="pre">SweepTask.issue</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask.issue_slug"><code class="docutils literal notranslate"><span class="pre">SweepTask.issue_slug</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTask.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">SweepTask.word2vec_model_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.base_cli"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.base_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.extra_cli"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.extra_cli</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.sweep_dir"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.sweep_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context.SweepTaskContext.word2vec_model_base"><code class="docutils literal notranslate"><span class="pre">SweepTaskContext.word2vec_model_base</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.build_base_cli"><code class="docutils literal notranslate"><span class="pre">build_base_cli()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.build_pipeline_context"><code class="docutils literal notranslate"><span class="pre">build_pipeline_context()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.default_cache_dir"><code class="docutils literal notranslate"><span class="pre">default_cache_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.default_dataset"><code class="docutils literal notranslate"><span class="pre">default_dataset()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.default_out_dir"><code class="docutils literal notranslate"><span class="pre">default_out_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.log_dry_run"><code class="docutils literal notranslate"><span class="pre">log_dry_run()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.log_run_configuration"><code class="docutils literal notranslate"><span class="pre">log_run_configuration()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.parse_args"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.cli.repo_root"><code class="docutils literal notranslate"><span class="pre">repo_root()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.data.issue_slug_for_study"><code class="docutils literal notranslate"><span class="pre">issue_slug_for_study()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.data.resolve_studies"><code class="docutils literal notranslate"><span class="pre">resolve_studies()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.data.study_specs"><code class="docutils literal notranslate"><span class="pre">study_specs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.data.warn_if_issue_tokens_used"><code class="docutils literal notranslate"><span class="pre">warn_if_issue_tokens_used()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.load_loso_metrics_from_disk"><code class="docutils literal notranslate"><span class="pre">load_loso_metrics_from_disk()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.run_cross_study_evaluations"><code class="docutils literal notranslate"><span class="pre">run_cross_study_evaluations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.run_final_evaluations"><code class="docutils literal notranslate"><span class="pre">run_final_evaluations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.run_opinion_evaluations"><code class="docutils literal notranslate"><span class="pre">run_opinion_evaluations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.evaluate.run_opinion_from_next_evaluations"><code class="docutils literal notranslate"><span class="pre">run_opinion_from_next_evaluations()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_final_metrics_from_disk"><code class="docutils literal notranslate"><span class="pre">load_final_metrics_from_disk()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_loso_metrics_from_disk"><code class="docutils literal notranslate"><span class="pre">load_loso_metrics_from_disk()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_metrics"><code class="docutils literal notranslate"><span class="pre">load_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.io.load_opinion_metrics"><code class="docutils literal notranslate"><span class="pre">load_opinion_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.build_opinion_task"><code class="docutils literal notranslate"><span class="pre">build_opinion_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_task"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.execute_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.format_opinion_sweep_task_descriptor"><code class="docutils literal notranslate"><span class="pre">format_opinion_sweep_task_descriptor()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.merge_opinion_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">merge_opinion_sweep_outcomes()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.opinion_sweep_outcome_from_metrics"><code class="docutils literal notranslate"><span class="pre">opinion_sweep_outcome_from_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.prepare_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">prepare_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.opinion_sweeps.select_best_opinion_configs"><code class="docutils literal notranslate"><span class="pre">select_best_opinion_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.build_opinion_task"><code class="docutils literal notranslate"><span class="pre">build_opinion_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.build_sweep_configs"><code class="docutils literal notranslate"><span class="pre">build_sweep_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.emit_combined_sweep_plan"><code class="docutils literal notranslate"><span class="pre">emit_combined_sweep_plan()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.emit_sweep_plan"><code class="docutils literal notranslate"><span class="pre">emit_sweep_plan()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_opinion_sweep_task"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">execute_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_sweep_task"><code class="docutils literal notranslate"><span class="pre">execute_sweep_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.execute_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">execute_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.format_opinion_sweep_task_descriptor"><code class="docutils literal notranslate"><span class="pre">format_opinion_sweep_task_descriptor()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.format_sweep_task_descriptor"><code class="docutils literal notranslate"><span class="pre">format_sweep_task_descriptor()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.merge_opinion_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">merge_opinion_sweep_outcomes()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.merge_sweep_outcomes"><code class="docutils literal notranslate"><span class="pre">merge_sweep_outcomes()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.opinion_sweep_outcome_from_metrics"><code class="docutils literal notranslate"><span class="pre">opinion_sweep_outcome_from_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.prepare_opinion_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">prepare_opinion_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.prepare_sweep_tasks"><code class="docutils literal notranslate"><span class="pre">prepare_sweep_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.run_knn_cli"><code class="docutils literal notranslate"><span class="pre">run_knn_cli()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.run_sweeps"><code class="docutils literal notranslate"><span class="pre">run_sweeps()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.select_best_configs"><code class="docutils literal notranslate"><span class="pre">select_best_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.select_best_opinion_configs"><code class="docutils literal notranslate"><span class="pre">select_best_opinion_configs()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.sweeps.sweep_outcome_from_metrics"><code class="docutils literal notranslate"><span class="pre">sweep_outcome_from_metrics()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.empty_descriptor"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.empty_descriptor</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.logger"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.logger</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.missing_descriptor"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.missing_descriptor</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.SelectionValidationOptions.require_selected"><code class="docutils literal notranslate"><span class="pre">SelectionValidationOptions.require_selected</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy"><code class="docutils literal notranslate"><span class="pre">TaskCacheStrategy</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy.cache_path"><code class="docutils literal notranslate"><span class="pre">TaskCacheStrategy.cache_path</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.TaskCacheStrategy.load_cached"><code class="docutils literal notranslate"><span class="pre">TaskCacheStrategy.load_cached</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_dir"><code class="docutils literal notranslate"><span class="pre">ensure_dir()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_feature_selections"><code class="docutils literal notranslate"><span class="pre">ensure_feature_selections()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_opinion_selection_coverage"><code class="docutils literal notranslate"><span class="pre">ensure_opinion_selection_coverage()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_selection_coverage"><code class="docutils literal notranslate"><span class="pre">ensure_selection_coverage()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.ensure_sweep_selection_coverage"><code class="docutils literal notranslate"><span class="pre">ensure_sweep_selection_coverage()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.extract_metric_summary"><code class="docutils literal notranslate"><span class="pre">extract_metric_summary()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.extract_opinion_summary"><code class="docutils literal notranslate"><span class="pre">extract_opinion_summary()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_count"><code class="docutils literal notranslate"><span class="pre">format_count()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_delta"><code class="docutils literal notranslate"><span class="pre">format_delta()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_float"><code class="docutils literal notranslate"><span class="pre">format_float()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_k"><code class="docutils literal notranslate"><span class="pre">format_k()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_optional_float"><code class="docutils literal notranslate"><span class="pre">format_optional_float()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.format_uncertainty_details"><code class="docutils literal notranslate"><span class="pre">format_uncertainty_details()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.handle_cached_task"><code class="docutils literal notranslate"><span class="pre">handle_cached_task()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.parse_ci"><code class="docutils literal notranslate"><span class="pre">parse_ci()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.partition_cached_tasks"><code class="docutils literal notranslate"><span class="pre">partition_cached_tasks()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.prepare_task_grid"><code class="docutils literal notranslate"><span class="pre">prepare_task_grid()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.safe_float"><code class="docutils literal notranslate"><span class="pre">safe_float()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.safe_int"><code class="docutils literal notranslate"><span class="pre">safe_int()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.utils.snake_to_title"><code class="docutils literal notranslate"><span class="pre">snake_to_title()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline.context_pipeline">Context Internals</a><ul>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults"><code class="docutils literal notranslate"><span class="pre">_ModelDefaults</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_batch_size"><code class="docutils literal notranslate"><span class="pre">_ModelDefaults.sentence_batch_size</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_device"><code class="docutils literal notranslate"><span class="pre">_ModelDefaults.sentence_device</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_model"><code class="docutils literal notranslate"><span class="pre">_ModelDefaults.sentence_model</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults.sentence_normalize"><code class="docutils literal notranslate"><span class="pre">_ModelDefaults.sentence_normalize</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults.word2vec_epochs"><code class="docutils literal notranslate"><span class="pre">_ModelDefaults.word2vec_epochs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._ModelDefaults.word2vec_workers"><code class="docutils literal notranslate"><span class="pre">_ModelDefaults.word2vec_workers</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._OpinionPaths"><code class="docutils literal notranslate"><span class="pre">_OpinionPaths</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._OpinionPaths.dir"><code class="docutils literal notranslate"><span class="pre">_OpinionPaths.dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._OpinionPaths.sweep_dir"><code class="docutils literal notranslate"><span class="pre">_OpinionPaths.sweep_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._OpinionPaths.word2vec_dir"><code class="docutils literal notranslate"><span class="pre">_OpinionPaths.word2vec_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths"><code class="docutils literal notranslate"><span class="pre">_PipelinePaths</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths.cache_dir"><code class="docutils literal notranslate"><span class="pre">_PipelinePaths.cache_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths.next_video_dir"><code class="docutils literal notranslate"><span class="pre">_PipelinePaths.next_video_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths.opinion"><code class="docutils literal notranslate"><span class="pre">_PipelinePaths.opinion</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths.out_dir"><code class="docutils literal notranslate"><span class="pre">_PipelinePaths.out_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths.sweep_dir"><code class="docutils literal notranslate"><span class="pre">_PipelinePaths.sweep_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._PipelinePaths.word2vec_model_dir"><code class="docutils literal notranslate"><span class="pre">_PipelinePaths.word2vec_model_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow"><code class="docutils literal notranslate"><span class="pre">_Workflow</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">_Workflow.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow.feature_spaces"><code class="docutils literal notranslate"><span class="pre">_Workflow.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow.jobs"><code class="docutils literal notranslate"><span class="pre">_Workflow.jobs</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow.reuse_final"><code class="docutils literal notranslate"><span class="pre">_Workflow.reuse_final</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow.reuse_sweeps"><code class="docutils literal notranslate"><span class="pre">_Workflow.reuse_sweeps</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow.run_next_video"><code class="docutils literal notranslate"><span class="pre">_Workflow.run_next_video</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.context_pipeline._Workflow.run_opinion"><code class="docutils literal notranslate"><span class="pre">_Workflow.run_opinion</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline.reports">Report Builders</a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.generate_reports"><code class="docutils literal notranslate"><span class="pre">generate_reports()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.features.build_feature_report"><code class="docutils literal notranslate"><span class="pre">build_feature_report()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.asset_subdir"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.asset_subdir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.description_lines"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.description_lines</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.metrics_line"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.metrics_line</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.predictions_root"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.regenerate_plots"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.regenerate_plots</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.opinion.OpinionReportOptions.title"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.title</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.shared.parse_k_sweep"><code class="docutils literal notranslate"><span class="pre">parse_k_sweep()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline.reports.next_video.inputs">Next-Video Report Internals</a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.feature_spaces"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.loso_metrics"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.loso_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.metrics_by_feature"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.metrics_by_feature</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.output_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.output_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.studies"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.studies</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.NextVideoReportInputs.xgb_next_video_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.xgb_next_video_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.accuracy"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.accuracy</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.baseline"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.baseline</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.eligible"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.eligible</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.random"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.random</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.inputs.PortfolioAggregate.studies"><code class="docutils literal notranslate"><span class="pre">PortfolioAggregate.studies</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.helpers.accuracy_delta"><code class="docutils literal notranslate"><span class="pre">accuracy_delta()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline.reports.next_video.helpers.iter_metric_payloads"><code class="docutils literal notranslate"><span class="pre">iter_metric_payloads()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.pipeline_reports">Legacy Report Shims</a><ul>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.feature_spaces"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.feature_spaces</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.loso_metrics"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.loso_metrics</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.metrics_by_feature"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.metrics_by_feature</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.output_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.output_dir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.studies"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.studies</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.next_video.NextVideoReportInputs.xgb_next_video_dir"><code class="docutils literal notranslate"><span class="pre">NextVideoReportInputs.xgb_next_video_dir</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#knn.pipeline_reports.shared.parse_k_sweep"><code class="docutils literal notranslate"><span class="pre">parse_k_sweep()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.features.build_feature_report"><code class="docutils literal notranslate"><span class="pre">build_feature_report()</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions</span></code></a><ul>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.allow_incomplete"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.allow_incomplete</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.asset_subdir"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.asset_subdir</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.description_lines"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.description_lines</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.metrics_line"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.metrics_line</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.predictions_root"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.predictions_root</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.regenerate_plots"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.regenerate_plots</span></code></a></li>
<li><a class="reference internal" href="#knn.pipeline_reports.opinion.OpinionReportOptions.title"><code class="docutils literal notranslate"><span class="pre">OpinionReportOptions.title</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-knn.scripts">Scripts</a></li>
<li><a class="reference internal" href="#module-knn.cli.__main__">CLI Internals</a><ul>
<li><a class="reference internal" href="#knn.cli.main.build_parser"><code class="docutils literal notranslate"><span class="pre">build_parser()</span></code></a></li>
<li><a class="reference internal" href="#knn.cli.main.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li><a class="reference internal" href="#knn.cli.utils.add_sentence_transformer_normalize_flags"><code class="docutils literal notranslate"><span class="pre">add_sentence_transformer_normalize_flags()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>